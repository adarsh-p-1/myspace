(()=>{var e=document.currentScript;define("c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0",["@microsoft/sp-diagnostics","@microsoft/sp-loader","react","react-dom","@msinternal/odsp-core-bundle","@microsoft/sp-core-library","@msinternal/sp-component-utilities","@microsoft/sp-http","@microsoft/sp-page-context","@msinternal/odsp-utilities-bundle","@microsoft/sp-http-base","@ms/office-ui-fabric-react-bundle","@msinternal/sp-telemetry","@microsoft/load-themed-styles","@microsoft/sp-webpart-base","@microsoft/sp-property-pane","@msinternal/sp-fluentui-migration-reactdom-render-bundle","@msinternal/swc-helpers-bundle","@msinternal/sp-fluentui-migration-spinner-bundle","@msinternal/sp-fluentui-v9-react-button-bundle","@msinternal/sp-fluentui-v9-utilities-bundle","@msinternal/sp-fluentui-migration-label-bundle","@msinternal/sp-fluentui-migration-tooltip-bundle","@msinternal/sp-fluentui-migration-button-bundle","@msinternal/sp-fluentui-migration-textfield-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C)=>(()=>{"use strict";var O={424:e=>{e.exports=m},676:e=>{e.exports=o},207:e=>{e.exports=t},909:e=>{e.exports=c},737:e=>{e.exports=u},414:e=>{e.exports=n},408:e=>{e.exports=d},877:e=>{e.exports=h},642:e=>{e.exports=_},141:e=>{e.exports=f},277:e=>{e.exports=r},810:e=>{e.exports=l},718:e=>{e.exports=s},575:e=>{e.exports=x},485:e=>{e.exports=D},907:e=>{e.exports=b},464:e=>{e.exports=v},944:e=>{e.exports=C},94:e=>{e.exports=I},526:e=>{e.exports=y},606:e=>{e.exports=S},519:e=>{e.exports=p},592:e=>{e.exports=g},959:e=>{e.exports=a},398:e=>{e.exports=i}},w={};function E(e){var t=w[e];if(void 0!==t)return t.exports;var n=w[e]={exports:{}};return O[e](n,n.exports,E),n.exports}E.m=O;var A,L,k,M={"112":"ys9lD1qDw/8+XMBMkbA9vx0IJPSxi9QrWXVoM9FwsXw=","220":"HqY+C9S09DDhplM4aHo0eEeJicIxoLVcGxEIJHz7EOo=","716":"gJy5sXFQfrbybVblsiR1exakpKfNQYRRPdmpWxo+XJM=","769":"4UETU69gR4ZyaweM9/VNnwPvjFbA5wsjiD+szGv6zvE="};E.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return E.d(t,{a:t}),t},E.d=(e,t)=>{for(var n in t)E.o(t,n)&&!E.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},E.f={},E.e=e=>Promise.all(Object.keys(E.f).reduce((t,n)=>(E.f[n](e,t),t),[])),E.u=e=>"chunk."+{112:"adaptive-card-extension-supported-icon-map",220:"MoveCopyDataSource",716:"dialog-utility",769:"webpack-shared-editmode-fabric-dialog"}[e]+"_"+({716:1}[e]?"en-us":"none")+"_"+{112:"6279ebc8f0f1469d505f",220:"9e78b396c1fc9c8172db",716:"bea660a94549dbe0dcc4",769:"01f5130d8c98ff6a5293"}[e]+".js",E.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),A={},L="c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0:",E.l=(e,t,n,a)=>{if(A[e])A[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==L+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,E.nc&&i.setAttribute("nonce",E.nc),i.setAttribute("data-webpack",L+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(M[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}A[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(u);var a=A[e];if(delete A[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},E.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},k=e?e.src:"",E.p=k.slice(0,k.lastIndexOf("/")+1),E.f.compat=(e,t)=>{for(var n=function(e){return{716:[{i:"b9fc293f-811a-4b1c-a851-a1fbcb7851bf",v:"0.1.0",m:966},{i:"05ed6956-59ad-4aa6-9e4e-b832c96ae87b",v:"0.9.27",m:392},{i:"a7e40b4f-0b7b-4c35-a1b7-94d7b4548907",v:"0.1.0",m:671},{i:"35a0dc31-0b17-406a-9137-043d67d0850d",v:"0.0.1",m:816},{i:"c6e9b8a2-5f7d-4e0b-8b9b-1e3c7a9d3f4f",v:"0.1.0",m:930}],769:[{i:"01c4df03-e775-48cb-aa14-171ee5199a15",v:"2.3.1",m:280},{i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.3.65",m:825}]}[e]||[]}(e),a=0;a<n.length;a++)E.m[n[a].m]||(e=>{t.push(P.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{E.m[e.m]=e=>e.exports=t}))})(n[a])};var P=E(414);(()=>{var e={530:0};E.f.j=(t,n)=>{var a=E.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=E.p+E.u(t),o=new Error;E.l(r,n=>{if(E.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)E.o(o,a)&&(E.m[a]=o[a]);s&&s(E)}for(t&&t(n);c<r.length;c++)i=r[c],E.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0"]=self["webpackJsonp_c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var T={};return(()=>{E.r(T),E.d(T,{CardMotionWebPartId:()=>Te,DeferredDialog:()=>ee,DeferredDialogContent:()=>ie,DeferredDialogFooter:()=>ne,DocLibraryContext:()=>Z,FilePickerLoader:()=>n,LazyDialog:()=>$,LazyDialogContent:()=>ae,LazyDialogFooter:()=>te,LinkTextBox:()=>He,LocalFilePreview:()=>X,OpenSPFilePickerHost:()=>_,PropertyPaneAudienceToggle:()=>Pe,SPFileHandler:()=>W,SPFileHandlerError:()=>C,SPFilePickerHostLoader:()=>m,ThumbnailSourceType:()=>_e,ThumbnailType:()=>me.ThumbnailType,calculateExifOrientation:()=>g,convertDataUriToArrayBuffer:()=>v,encodeQuerySegment:()=>k,ensureOrientation:()=>b,ensureURLEncoded:()=>N,getDefaultHeaders:()=>j,getFallbackSharingLinkRequestBody:()=>V,getIconUrl:()=>Ee,getPropertyPaneThumbnail:()=>Oe,getSharePointImageUrl:()=>H,handleFileUploadError:()=>L,isExternalSharePointAsset:()=>F,isGettyStockOptInKSActivated:()=>d,isODBFilePickerEnabled:()=>z,isUrlEncoded:()=>R,isValidGuid:()=>B,mapServerResponseToUploadResult:()=>M,replaceSpecialCharacters:()=>P,rotatedExifOrientation:()=>h,supportedIcons:()=>we});var e=E(207),t=E(414);class n{static load(n,a){return t.SPComponentLoader.loadComponentById("a81a5cf6-c9ad-4a0a-85aa-68c03d2d22a2").then(t=>{const i=new t.FilePicker(n);return i.initialize(a),i.fetchData().catch(t=>e._TraceLogger.logError(e._LogSource.create("FilePickerLoader"),t,"fetchData")),i})}}var a=E(959),i=E(398),r=E.n(i),o=E(277),s=E(676);function c(){return s._SPKillSwitch.isActivated("42f427de-65a5-49c9-9e71-1c1c6a677c11")}function d(){return s._SPKillSwitch.isActivated("28f8ac5e-4636-4a6a-9958-5738ab2036a6")}function l(){return s._SPKillSwitch.isActivated("3f9bf326-f86b-4992-b5fe-87eae7ab8390")}function u(){return s._SPKillSwitch.isActivated("215d1cd5-38da-4f1f-8da8-d3ff1cfe4cd0")}function f(){return s._SPKillSwitch.isActivated("b53378d6-f31e-4c45-a1da-80d2933dc8db")}const p=a.lazy(()=>{const n=s._SPKillSwitch.isActivated("fd54e993-3a17-4eb5-b54f-1a91af0401d0")?void 0:new e._QosMonitor("SPFilePickerHost.LoadComponentById");return t.SPComponentLoader.loadComponentById("bc9242cf-c4f7-4ff8-a1f4-93ae4da35b7f").then(e=>(n?.writeSuccess(),{default:e.SPFilePickerHost})).catch(e=>{throw n?.writeUnexpectedFailure("ModuleLoadFailure",new o.CustomError({message:(0,o.markPrivacyData)(e.message,"safe")})),e})});function m(e){const t=a.useRef(e.show);return e.show&&!t.current&&(t.current=!0),t.current?a.createElement(a.Suspense,{fallback:!1},a.createElement(p,e)):a.createElement(a.Fragment,null)}function _(e,t){r().render(a.createElement(m,e),t)}const h=[5,6,7,8];function b(t,n){if(!t||!t.src)return;const a=s._BrowserDetection.getBrowserInformation();a.browser===s._Browser.Firefox||(a.browser===s._Browser.Chrome||a.browser===s._Browser.EdgeChromium)&&a.browserVersion&&a.browserVersion.greaterThan(s.Version.parse("81.0.0.0"))?t.style.visibility="visible":v(t.src).then(e=>g(e)).then(e=>{if(void 0===e||isNaN(e)||1===e)return t.style.transform=void 0,void(t.style.visibility="visible");let a;switch(-1!==[5,6,7,8].indexOf(e)&&n&&n(),e){case 2:a="-1, 0, 0, 1, 0, 0";break;case 3:a="-1, 0, 0, -1, 0, 0";break;case 4:a="1, 0, 0, -1, 0, 0";break;case 5:a="0, 1, 1, 0, 0, 0";break;case 6:a="0, 1, -1, 0, 0, 0";break;case 7:a="0, -1, -1, 0, 0, 0";break;case 8:a="0, -1, 1, 0, 0, 0"}t.style.transform=`matrix(${a})`,t.style.visibility="visible"}).catch(t=>e._TraceLogger.logError(e._LogSource.create("ensureOrientation"),t,"convertDataUriToArrayBuffer"))}function g(e){if(!e)return Promise.resolve(void 0);const t=new DataView(e);if(65496!==t.getUint16(0,!1))return Promise.resolve(void 0);const n=t.byteLength;let a=2;for(;a<n;){const e=t.getUint16(a,!1);if(a+=2,65505===e){if(1165519206!==t.getUint32(a+=2,!1))return Promise.resolve(void 0);const e=18761===t.getUint16(a+=6,!1);a+=t.getUint32(a+4,e);const n=t.getUint16(a,e);a+=2;for(let i=0;i<n;i++)if(274===t.getUint16(a+12*i,e)){const n=t.getUint16(a+12*i+8,e);return Promise.resolve(n)}}else{if(65280!=(65280&e))break;a+=t.getUint16(a,!1)}}return Promise.resolve(void 0)}function v(e){return fetch(e).then(e=>e.arrayBuffer()).catch(e=>{})}var y=E(718),S=E(909),D=E(408),I=E(810),x=E(737);class C extends Error{constructor(e,t){super(e),this.__proto__=C.prototype,this.errorCode=t}}const O=JSON.parse('{"Y$":"The security validation for this page has timed out. Refresh the page or use the back button in your browser to try again.","JL":"The file or folder {0} contains invalid characters such as # % * : < > ? / | and cannot be selected.","ze":"Access denied. You do not have permission to perform this action or access this resource.","wk":"Can\\u0027t upload this item. Please refresh the page.","Ah":"Can\\u0027t upload this item due to error on client.","EM":"The sharing link couldn\\u0027t be created","HN":"The video was added to the page, but people might not be able to view it if they don\\u0027t already have access.","BY":"Close"}');var w,A;function L(e,t,n,a,i){const r={odataErrorCode:e.code,odataErrorMessage:e.message&&e.message.value,correlationId:n?n.toString():void 0,statusCode:i};throw U(e,"-2130575252")?(t.writeExpectedFailure("SecurityValidationTimeOut",void 0,r),new C(O.Y$,e.code)):U(e,"-2130575245")?(t.writeExpectedFailure("InvalidCharacters",void 0,r),new C(s.Text.format(O.JL,a),e.code)):U(e,"-2147024891")?(t.writeExpectedFailure("NoPermission",void 0,r),new C(O.ze,e.code)):U(e,"-2130575257")||U(e,"-2130575342")?(t.writeExpectedFailure("FileFolderAlreadyExists",void 0,r),new C(O.ze,e.code)):(!f()&&i&&(0,y.isExpectedClientError)(i)?t.writeExpectedFailure("FileUploadError",new Error(e?.message?.value),r):t.writeUnexpectedFailure("UncategorizedError",void 0,r),new C(O.wk,e.code))}function k(e,t,n){return`${e}=%27${I.UriEncoding.encodeRestUriStringToken(t,n)}%27`}function M(e){return{listId:e.ListId,uniqueId:e.UniqueId,serverRelativeUrl:e.ServerRelativeUrl,title:e.Title}}function P(e){const t=u()?new RegExp("[&/\\# ,+()$~'\":*?<>{}|]|%2.","g"):new RegExp("[&/\\\\# ,+()$~'\":*?<>{}|\\s\\u00A0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\u200B]|%2.","g");return e?e.replace(t,"-"):""}function U(e,t){return!!e.code&&String(e.code).indexOf(t)>-1}function F(e,t){return Boolean(s._SPFlight.isEnabled(61766)&&t?.SiteId&&t?.WebId&&t?.ListId&&t?.UniqueId&&(e.site.id.toString()!==s.Guid.parse(t.SiteId).toString()||e.web.id.toString()!==s.Guid.parse(t.WebId).toString()))}function H(e){const t=e.ServerAbsoluteUrl||e.Link,n=new I.Uri(t),a=n.getAuthority()===window.location.host?n.getPath():t;return u()?a:N(a)||a}function R(e){const t=decodeURI(e);return e===encodeURI(t)}function N(e){if(e)return!s._SPKillSwitch.isActivated("495ffbd0-0ab2-4a5d-aa93-9d2f2f9a3458")&&R(e)?e:I.UriEncoding.encodeURIComponent(e,!0)}function B(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),s.Guid.isValid(e)&&"00000000-0000-0000-0000-000000000000"!==e}function j(){const e=new Headers;return e.append("accept","application/json; odata=nometadata"),e.append("OData-version","3.0"),e}function V(){return JSON.stringify({request:{createLink:!0,settings:{allowAnonymousAccess:!1,linkKind:w.organizationView,nav:"",password:"",restrictShareMembership:!1,role:A.view,scope:1,updatePassword:!1}}})}function z(){return!s._SPKillSwitch.isActivated("fd54e993-3a17-4eb5-b54f-1a91af0401d0")&&s._SPFlight.isEnabled(1342)}function G(){return s._SPFlight.isEnabled(62406)}function K(){return!s._SPKillSwitch.isActivated("b10afe46-4928-4f93-827c-bde0a05c5a03")&&s._SPFlight.isEnabled(61281)}!function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(w||(w={})),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.limitedView=4]="limitedView",e[e.limitedEdit=5]="limitedEdit",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(A||(A={}));class W{static get pagePathName(){return-1!==window.location.pathname.toUpperCase().indexOf("/NEWPAGE.ASPX")&&e._TraceLogger.logError(W._logSource,new Error("Page media upload before page titled.")),window.location.pathname}static getFileNameFromUrl(e){const t=new RegExp("^(?:[a-z]+:)?//","i"),n=e.replace(/\/$/,"");let a="";if(a=t.test(n)?new URL(n).pathname.split("/").pop():n.split("/").pop(),!a)throw new Error(`Could not parse file name from url: ${e}`);return a}static replaceSpecialCharacters(e){return P(e)}static validateFileType(e,t){const n=e?.name||e,a=n.lastIndexOf(".");let i;return-1!==a&&(i=n.substring(a+1,n.length),(s._SPKillSwitch.isActivated("fb474cdf-c222-42a6-b546-8485d7841215")?t:t.map(e=>e.startsWith(".")?e.slice(1):e)).indexOf(i.toLowerCase())>-1)}static _isPageAssetFolderBindingEnabled(){return!s._SPKillSwitch.isActivated("5b8b049b-2476-4c92-8599-2e0a94837a43")&&s._SPFlight.isEnabled(60296)&&!this._isDisableSitePagesStrongBinding}readFile(t){return this._reader||(this._reader=new FileReader),new Promise((n,a)=>{t||(e._TraceLogger.logVerbose(W._logSource,"File is undefined"),a(new RangeError("FileUndefined"))),this._reader.onloadend=()=>n(this._reader.result),this._reader.onerror=()=>{e._TraceLogger.logVerbose(W._logSource,"Error occurred when reading the file"),a(this._reader.error)},this._reader.readAsDataURL(t)})}uploadLocalFile(e,t,n,a=!1,i,r=!1,o){return W._isPageAssetFolderBindingEnabled()?this._pageService.getItemUpdateQueue().then(s=>s.executeActionAsync(()=>this._uploadLocalFile(e,t,n,a,i,r,o))):this._uploadLocalFile(e,t,n,a,i,r,o)}async moveCopyExternalFileToSiteAssets(t,n=!1,a=!1){const i=decodeURI(t.ServerAbsoluteUrl||t.Link),r=this._getUniqueCopyFileName(i,t.UniqueId,t.FileName,a),o=new e._QosMonitor(`${this._qosPrefix}.moveCopyExternalFileToSiteAssets`),s=await this._ensureMoveCopyDataSource(),c={isFolder:!1,itemFullUrl:decodeURI(i),sharepointId:t.SiteId,listItemUniqueId:t.UniqueId,displayName:r},d={webAbsoluteUrl:await this.getSitePagesAssetFolderUrl(),folderPath:""};try{let e={};const a=t=>{const n=t.get(c.itemFullUrl)||t.get(c.sharepointId);if(n&&n.jobFinishedResult){const t=n.jobFinishedResult;e={listId:t.listId,serverRelativeUrl:`${"/"!==this._pageContext.web.serverRelativeUrl?this._pageContext.web.serverRelativeUrl:""}/${t.siteRelativeUrl}`,title:r,uniqueId:t.uniqueId}}if(n&&n.error){const e=n.error;throw o.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new C(O.wk)}};return await s.moveCopyItems({items:[c],destinationItem:d,isMove:n,customizedFileName:[r],sourceWebAbsoluteUrl:t.SiteUrl||this._pageContext.web.absoluteUrl,onMoveCopyProgress:a}),o.writeSuccess(),e}catch(e){throw o.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new C(O.wk)}}uploadExternalFile(e,t,n){return u()&&!z()||(t=W.replaceSpecialCharacters(t)),W._isPageAssetFolderBindingEnabled()?this._pageService.getItemUpdateQueue().then(a=>a.executeActionAsync(()=>this._uploadExternalFile(e,t,n))):this._uploadExternalFile(e,t)}validateMimeType(e,t){if(e.type){const n=e.type.slice(e.type.lastIndexOf("/")+1);if(n)return t.indexOf(n.toLowerCase())>-1}return!1}getSitePagesAssetFolderUrl(){const t=new e._QosMonitor(`${this._qosPrefix}.getOrCreateAssetFolderApi`),n=this._getOrCreateAssetFolderApiPostUrl(),a=j();return this._httpClient.post(n,S.SPHttpClient.configurations.v1,{headers:a,body:void 0}).then(e=>e.json()).then(e=>{if(""===e.value)throw t.writeUnexpectedFailure("EmptyResponse",void 0),new C(O.wk);return t.writeSuccess(),I.Uri.concatenate(new I.Uri(this._pageContext.web.absoluteUrl).getLeftPart(I.UriPartial.authority),e.value)}).catch(e=>{throw t.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new C(O.wk)})}getPageName(t=""){t=t.trim();const n=this.removeExtension(t);let a=W.replaceSpecialCharacters(n);const i=new e._QosMonitor("FilePicker.UploadItem.GetPageName");if(a)i.writeSuccess();else{const e=this._pageContext.listItem&&this._pageContext.listItem.id||"fastPageCreation";i.writeUnexpectedFailure("EmptyPageName",void 0,{pathNameTrimmedLen:t.length,isPathNameEndWithSlash:("/"===t[t.length-1]).toString(),isPageTitleEmpty:(!n.trim()).toString(),pageId:e.toString()}),a=e.toString()}return a}removeExtension(e){const t=e.lastIndexOf("/"),n=-1===t?e:e.substring(t+1),a=n.lastIndexOf(".");return-1===a?n:n.substring(0,a)}getFallbackSharingLink(t,n){const a=new e._QosMonitor(`${this._qosPrefix}.GetFallbackSharingLink`),i=this._pageContext?.web?.absoluteUrl;if(void 0===i)return Promise.resolve(void 0);const r=i+`/_api/web/Lists(@a1)/GetItemByUniqueId(@a2)/ShareLink?@a1='${t}'&@a2='${n}'`,o=j();o.append("Prefer","DirectUrlWithShareToken"),t&&B(t.slice(1,-1))&&o.append("X-SP-REQUESTRESOURCES",`WEBPROPERTIES, list=${t.slice(1,-1)}`);const c=V();return this._httpClient.post(r,S.SPHttpClient.configurations.v1,{headers:o,body:c}).then(e=>e.json()).then(e=>{if(e&&e.sharingLinkInfo)return a.writeSuccess(),e.sharingLinkInfo.Url??void 0;{const t=e["odata.error"];if(t){const e={odataErrorCode:t.code,odataErrorMessage:t.message?.value||""};s._SPKillSwitch.isActivated("2cffa4af-4d43-4d94-9e3e-560d399b9528")?a.writeUnexpectedFailure("ErrorResponse",void 0,e):!0===String(t.code).startsWith("-4,")?a.writeUnexpectedFailure("InvalidOperation",void 0,e):!0===String(t.code).startsWith("-2147024891,")?a.writeExpectedFailure("UnauthorizedAccess",void 0,e):a.writeUnexpectedFailure("ErrorResponse",void 0,e)}else a.writeUnexpectedFailure("EmptyResponse");return}}).catch(e=>{a.writeUnexpectedFailure("RuntimeError")})}_uploadCore(e,t){const n=this._pageContext&&this._pageContext.web&&this._pageContext.web.absoluteUrl||"",a=j(),i=I.Uri.concatenate(n,e);return this._uploadCoreWithRetry(i,a,t,0)}_uploadCoreWithRetry(t,n,a,i){return this._httpClient.post(t,S.SPHttpClient.configurations.v1,{headers:n,body:a}).catch(r=>{if(s._SPKillSwitch.isActivated("556c57d4-5db7-434e-ba21-1c984f1af04a"))throw r;if(i<2){const o=i+1;return e._TraceLogger.logVerbose(W._logSource,`Upload failed on attempt ${o}, retrying in 100ms. Error: ${r?.message||r}`),new Promise((e,i)=>{setTimeout(()=>{this._uploadCoreWithRetry(t,n,a,o).then(e).catch(i)},100)})}throw e._TraceLogger.logError(W._logSource,r,"Upload failed after 3 attempts"),r})}_uploadLocalFile(t,n,a,i=!1,r,o=!1,c){const d=t instanceof File?u()?t.name:W.replaceSpecialCharacters(t.name):void 0,l=u()?n||d:W.replaceSpecialCharacters(n||d),p=!s._SPKillSwitch.isActivated("24ae812f-4669-4754-920f-322c88338efb")&&t instanceof File?t.size:void 0,m=new e._QosMonitor(`${this._qosPrefix}.UploadLocalFile`);let _;W._isPageAssetFolderBindingEnabled()&&!i&&(_=r||this._pageContext.listItem?.id);const h=this._getEndPoint(l,_,void 0,a,p,void 0,c);let b,g,v;return this._uploadCore(h,t).then(e=>(b=e.correlationId,g=f()?void 0:e.status,e.json())).then(t=>{if(v=t["odata.error"],!v){const n=M(t);return G()&&o?this.getFallbackSharingLink(n.listId,n.uniqueId).then(t=>(s._SPKillSwitch.isActivated("e297bb41-04b5-4bc8-b0f1-a3bd2928eecd")||t||E.e(716).then(E.bind(E,734)).then(({DialogUtility:e})=>e).then(e=>{e.showCommonError({title:O.EM,subText:O.HN,actionType:"CLOSE_ACTION",confirmActionLabel:O.BY})}).catch(t=>{e._TraceLogger.logError(W._logSource,t,"GetFallbackSharingLinkErrorDialog")}),n.fallbackShareLink=t,m.writeSuccess(),n)):(m.writeSuccess(),n)}L(v,m,b,l,g)}).catch(e=>{throw!f()&&v||m.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new C(O.wk)})}_uploadExternalFile(t,n,a){const i=this._getEndPoint(n,W._isPageAssetFolderBindingEnabled()?this._pageContext.listItem?.id:void 0,t,void 0,void 0,a),r=new e._QosMonitor(`${this._qosPrefix}.UploadExternalFile`);let o,s,c;return this._uploadCore(i,void 0).then(e=>(o=e.correlationId,s=f()?void 0:e.status,e.json())).then(e=>{const t=e["odata.error"];if(t)throw c={odataErrorCode:t.code,odataErrorMessage:t.message&&t.message.value,correlationId:o?o.toString():void 0,statusCode:s},f()&&r.writeUnexpectedFailure("UncategorizedError",void 0,c),new C(O.wk,t.code);return r.writeSuccess(),M(e)}).catch(e=>{if(f())r.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e),statusCode:s});else if(c){if(s&&(0,y.isExpectedClientError)(s))throw r.writeExpectedFailure("UploadExternalFileError",e,c),new C(O.Ah,s);r.writeUnexpectedFailure("UncategorizedError",void 0,c)}else r.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)});throw new C(O.wk)})}_getEndPoint(e,t,n,a,i,r,o){e=encodeURIComponent(e);const c="$select=ListId,ServerRelativeUrl,Title,UniqueId",d=W._isPageAssetFolderBindingEnabled()&&void 0!==t?`&pageId=${t}`:"",l=i?`&fileSize=${i}`:"",u=!s._SPKillSwitch.isActivated("2c13258a-b9a6-4704-9781-6ccbc4a8d830")&&!s._SPKillSwitch.isActivated("6b3c97ae-c33a-4c1e-9b88-5dc1e87ab20f")&&s._SPFlight.isEnabled(62479)&&o?`&${k("gettyId",encodeURIComponent(o))}`:"";if(this._containerUrl){const t=encodeURIComponent(this._containerUrl);return"/_api/web/GetFolderByServerRelativeUrl("+s.UrlUtilities.convertToODataStringLiteral(t)+")/Files/Add(url="+s.UrlUtilities.convertToODataStringLiteral(e)+`, overwrite=false)?${c}`}return n?"/_api/sitepages/AddImageFromExternalUrl?"+this._createSitePageEndpoint(e,a,r)+"&"+k("externalUrl",n,r)+`${d}&${c}`:"/_api/sitepages/AddImage?"+this._createSitePageEndpoint(e,a)+`${d}${l}${u}&${c}`}_getOrCreateAssetFolderApiPostUrl(){const e=this.getPageName(W.pagePathName),t=W._isPageAssetFolderBindingEnabled()?this._pageContext.listItem?.id:void 0,n=W._isPageAssetFolderBindingEnabled()&&void 0!==t?`&pageId=${t}`:"",a="/_api/sitepages/GetOrCreateAssetFolder?"+k("pageName",e)+n+"&createFolderIfNeeded=true",i=this._pageContext&&this._pageContext.web&&this._pageContext.web.absoluteUrl||"";return I.Uri.concatenate(i,a)}_createSitePageEndpoint(e,t,n){const a=t||this.getPageName(W.pagePathName);return k("imageFileName",e)+"&"+k("pageName",a,n)}_getUniqueCopyFileName(e,t,n,a){let i;try{i=n&&n.length>0?n:W.getFileNameFromUrl(e)}catch(e){i=t}G()&&a&&W.validateFileType(e,y.spConstants.videoExtensions)||(i=`copy-(1)-${i}`);const r=Math.floor(1e5+9e5*Math.random()),o=y.ExtensionHelper.getExtension(i);return i=i.replace(RegExp(`.${o}`,"i"),`-${r}.${o}`),i}constructor(e){this._ensureMoveCopyDataSource=()=>(this._moveCopyDataSource||(this._moveCopyDataSource=Promise.all([E.e(220).then(E.bind(E,281))]).then(([e])=>new e.MoveCopyAsyncDataSource({},{dataRequestor:new o.DataRequestor({qosName:"SPFileMoveCopyAsync"},{pageContext:this._pageContext.legacyPageContext,tokenProvider:this._getMoveDataSourceTokenProvider()})}))),this._moveCopyDataSource),this._getMoveDataSourceTokenProvider=()=>({getAuthToken:e=>x._AadTokenProviders.configurable._getTokenInternal(new I.Uri(e.url).getLeftPart(I.UriPartial.authority),x._AadTokenProviders.preAuthorizedConfiguration).then(e=>({authToken:e}))}),e.serviceScope.whenFinished(()=>{this._httpClient=e.serviceScope.consume(S.SPHttpClient.serviceKey),this._pageContext=e.serviceScope.consume(D.PageContext.serviceKey),this._pageService=e.serviceScope.consume((0,y.getPageServiceServiceKey)())}),this._qosPrefix=e.qosPrefix,this._containerUrl=e.containerUrl,W._isDisableSitePagesStrongBinding=e.isDisableSitePagesStrongBinding}}W._logSource=e._LogSource.create("PublishingWebPartSPFileHandler");var q=E(141),Q=E(519),Y=E(424);Y.loadStyles('.l_avLp1_0Bfl_{background-position:50%;background-repeat:no-repeat;background-size:cover;height:100%;margin:0 auto;width:100%;z-index:0}.l_avLp1_0Bfl_:before{background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]";bottom:0;content:"";display:block;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.l_avLp1_0Bfl_ .u_6uRlC_0Bfl_{color:#fff;padding:10px;position:absolute;text-align:center;top:50%;transform:translate(-50%,-50%)}[dir=ltr] .l_avLp1_0Bfl_ .u_6uRlC_0Bfl_{left:50%}[dir=rtl] .l_avLp1_0Bfl_ .u_6uRlC_0Bfl_{right:50%}.l_avLp1_0Bfl_ .u_6uRlC_0Bfl_ .u_yCpwh_0Bfl_{animation:s_oDC_X_0Bfl_ 2s linear infinite;display:block;font-size:48px;margin:8px 0}@keyframes s_oDC_X_0Bfl_{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.l_avLp1_0Bfl_ .i_Zb_gN_0Bfl_{max-height:100%;max-width:100%;opacity:.5;position:relative;visibility:hidden}.l_avLp1_0Bfl_ .u_bqLjO_0Bfl_{color:"[theme:white, default: #ffffff]";font-size:21px;font-weight:100;font-weight:300}.l_avLp1_0Bfl_ img{display:block;margin:0 auto;max-width:100%}.l_avLp1_0Bfl_ img:not([src]){display:none}',!0);const J=JSON.parse('{"zV":"We\\u0027re still uploading your image. It may get lost if you leave this page.","l":"Preview image that shows while an image is uploading.","Hg":"This doesn\\u0027t seem like a supported image file. Please select a different image."}');class X extends q.BaseComponent{UNSAFE_componentWillMount(){const{externalFile:e,imageUrl:t,localFile:n,pageContext:a}=this.props;e?this._startUpload(e):t&&y.UrlUtility.isValidURL(t)&&!y.UrlUtility.isVanityUrl(t,a)?this._startUploadFromExternalUrl(t):n&&this._startUpload(n)}componentDidMount(){this._setStateForLocalFile()}componentWillUnmount(){this._rejectPromise&&(this._rejectPromise(),this._rejectPromise=void 0)}render(){const e=a.createElement("img",{className:"i_Zb_gN_0Bfl_",alt:J.l,src:this.state.imageDataString,ref:this._resolveRef("_imagePreview"),onLoad:this._handleImageLoad});return a.createElement("div",{className:"l_avLp1_0Bfl_",ref:this._resolveRef("_root"),"data-automation-id":"localFilePreview"},this.state.imageDataString&&e,a.createElement("div",{className:"u_6uRlC_0Bfl_"},a.createElement(q.Icon,{iconName:"Sync",className:"u_yCpwh_0Bfl_"}),a.createElement("span",{className:"u_bqLjO_0Bfl_","aria-live":"assertive","aria-atomic":!0},this.props.uploadingMessage)))}_setStateForLocalFile(){this.props.localFile?new Promise((e,t)=>{this._rejectPromise=t,e(this._spFileHandler.readFile(this.props.localFile))}).then(e=>{this.setState({imageDataString:e})}).catch(t=>{e._TraceLogger.logError(e._LogSource.create("LocalFilePreview"),t,"ReadLocalFile")}):this.props.externalFile&&this.setState({imageDataString:this.props.externalFile.src})}_promptUploadingWarning(e){const t=J.zV;return e.returnValue=t,t}constructor(e){super(e),this._isImageFlipped=!1,this._handleImageLoad=e=>{b(e.target,()=>{this._isImageFlipped=!0})},this._startUpload=e=>{const t=new Q._QosMonitor(this.props.QosTag);try{let n="";const a=this._getPrefix(),i="src"in e;if(e instanceof File&&W.validateFileType(e,y.spConstants.imageExtensions))n=`${a}-${W.replaceSpecialCharacters(e.name)}`;else if(e instanceof Blob&&this._spFileHandler.validateMimeType(e,y.spConstants.imageExtensions))n=`${a}.${e.type.split("/").pop()}`;else{if(!i||!W.validateFileType(e.src,y.spConstants.imageExtensions))return this._onUploadError(new Error(J.Hg)),void t.writeExpectedFailure("InvalidFileType");e=e,n=`${a}-${W.replaceSpecialCharacters(e.name)}`}window.addEventListener("beforeunload",this._promptUploadingWarning),(e instanceof File||e instanceof Blob?this._spFileHandler.uploadLocalFile(e,n):this._spFileHandler.uploadExternalFile(e.src,n)).then(n=>{this._onUploadComplete(n,e instanceof File?e.name:void 0),t.writeSuccess()}).catch(e=>{t.writeUnexpectedFailure("UploadPromise",e),this._onUploadError(e)})}catch(e){t.writeUnexpectedFailure("CatchAll",e),this._onUploadError(e)}},this._startUploadFromExternalUrl=e=>{const t=new Q._QosMonitor(this.props.QosTag);try{const n=e.lastIndexOf("/"),a=e.substring(n+1),i=this._getPrefix()+W.replaceSpecialCharacters(a);window.addEventListener("beforeunload",this._promptUploadingWarning),this._spFileHandler.uploadExternalFile(e,i).then(e=>{this._onUploadComplete(e,i),t.writeSuccess()}).catch(e=>{this.props.localFile?this._startUpload(this.props.localFile):(t.writeUnexpectedFailure("UploadPromise",e),this._onUploadError(e))})}catch(e){t.writeUnexpectedFailure("CatchAll",e),this._onUploadError(e)}},this._onUploadComplete=(e,t)=>{if(window.removeEventListener("beforeunload",this._promptUploadingWarning),this._imagePreview&&this._imagePreview.naturalHeight&&this._imagePreview.naturalWidth){const n=this._isImageFlipped?this._imagePreview.naturalHeight:this._imagePreview.naturalWidth,a=this._isImageFlipped?this._imagePreview.naturalWidth:this._imagePreview.naturalHeight;this.props.onUploadComplete(e,t,n,a)}else this.props.onUploadComplete(e,t)},this._onUploadError=e=>{window.removeEventListener("beforeunload",this._promptUploadingWarning),this.props.onUploadError&&this.props.onUploadError(e,this.props.externalFile?this.props.externalFile.src:void 0)},this._getPrefix=()=>Math.floor(4294967296*Math.random()).toString(),this._spFileHandler=new W({serviceScope:e.serviceScope,qosPrefix:e.QosTag}),this.state={imageDataString:void 0}}}class Z{get defaultDocumentLibrary(){const e=I.Uri.concatenate(this._webAbsoluteUrl,"_api/web/DefaultDocumentLibrary?$expand=RootFolder");return this._spHttpClient.get(e,S.SPHttpClient.configurations.v1).then(e=>e.json())}get siteContext(){return this._siteContext?Promise.resolve(this._siteContext):this._getContainingFolderSiteContext().then(e=>(this._siteContext=e,e))}_getContainingFolderSiteContext(){const e={webAbsoluteUrl:this._webAbsoluteUrl,libraryName:"",defaultLibraryId:"",pickerDomain:window.location.protocol+"//"+window.location.hostname,siteId:this._siteId,webId:this._webId},t=new Q._QosMonitor("GetWebDefaultLibrary");return this.defaultDocumentLibrary.then(n=>{if(n.error)throw new Error(n.error.code);return e.libraryName=n.RootFolder.Name,e.defaultLibraryId=n.Id,t.writeSuccess(),e}).catch(n=>{if(n.message.indexOf("-2146232832")>=0?t.writeExpectedFailure("ListDeleted"):t.writeUnexpectedFailure(void 0,n),this._errorCallback)return this._errorCallback(e),e;throw n})}constructor(e,t,n){let a;e.whenFinished(()=>{this._spHttpClient=e.consume(S.SPHttpClient.serviceKey),a=e.consume(D.PageContext.serviceKey)}),!s._SPKillSwitch.isActivated("2097ba85-7386-407a-b0e8-a92e4f1f4053")&&n?(this._webAbsoluteUrl=n.webAbsoluteUrl||"",this._webId=n.webId,this._siteId=n.siteId):(a?.web?(this._webAbsoluteUrl=a.web.absoluteUrl,this._webId=a.web.id&&a.web.id.toString()||""):this._webAbsoluteUrl=this._webId="",this._siteId=a?.site?.id?.toString()||""),this._errorCallback=t}}const $=a.lazy(()=>E.e(769).then(E.bind(E,159)).then(({Dialog:e})=>({default:e})));function ee({fallback:e=a.createElement(a.Fragment,null),...t}){return a.createElement(a.Suspense,{fallback:e},a.createElement($,t))}const te=a.lazy(()=>E.e(769).then(E.bind(E,159)).then(({DialogFooter:e})=>({default:e})));function ne({fallback:e=a.createElement(a.Fragment,null),...t}){return a.createElement(a.Suspense,{fallback:e},a.createElement(te,t))}const ae=a.lazy(()=>E.e(769).then(E.bind(E,159)).then(({DialogContent:e})=>({default:e})));function ie({fallback:e=a.createElement(a.Fragment,null),...t}){return a.createElement(a.Suspense,{fallback:e},a.createElement(ae,t))}var re=E(907),oe=E(526);const se=a.createContext(void 0),ce={};se.Provider;var de=E(606);const le=(0,de.__styles)({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in",ycbfsm:"fg4l7m0"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);transform:scaleX(-1);}"],t:["@media (forced-colors: active){.fg4l7m0{forced-color-adjust:auto;}}"]}),ue=(e,t)=>{const{title:n,primaryFill:i="currentColor",...r}=e,o={...r,title:void 0,fill:i},s=le(),c=a.useContext(se)?a.useContext(se):ce;return o.className=(0,de.mergeClasses)(s.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==c?void 0:c.textDirection)&&s.rtl,o.className),n&&(o["aria-label"]=n),o["aria-label"]||o["aria-labelledby"]?o.role="img":o["aria-hidden"]=!0,o},fe=((e,t,n,i)=>{const r=a.forwardRef((e,i)=>{const r={...ue(e,{flipInRtl:void 0}),ref:i,width:t,height:t,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};return"string"==typeof n?a.createElement("svg",{...r,dangerouslySetInnerHTML:{__html:n}}):a.createElement("svg",r,...n.map(e=>a.createElement("path",{d:e,fill:r.fill})))});return r.displayName="AddCircle24Regular",r})(0,"24",["M12 2a10 10 0 1 1 0 20 10 10 0 0 1 0-20Zm0 1.5a8.5 8.5 0 1 0 0 17 8.5 8.5 0 0 0 0-17ZM12 7c.41 0 .75.34.75.75v3.5h3.5a.75.75 0 0 1 0 1.5h-3.5v3.5a.75.75 0 0 1-1.5 0v-3.5h-3.5a.75.75 0 0 1 0-1.5h3.5v-3.5c0-.41.34-.75.75-.75Z"]);var pe=E(642),me=E(877);const _e={Image:1,FabricReactIcon:2,AutoSelect:3},he=JSON.parse('{"eu":"Alternate text field for thumbnail image","rZ":"Thumbnail","Wi":"Auto-selected","dt":"Custom image","uH":"Library","N6":"Uploading...","X4":"0||1||2-","O_":"{0} characters||{0} character||{0} characters","Mg":"{0} limit - exceeded by {1}","Wk":"{0} limit - {1} left","TS":"{0} character","J_":"Add icon"}');class be extends a.PureComponent{static getTextFieldGroup(e,t){return(0,pe.PropertyPaneCustomField)({key:e,isInternal:!0,onRender:(n,i,r)=>{const o=a.createElement(be,{key:e,onChange:r,...t});re.render(o,n)},onDispose:e=>{i.unmountComponentAtNode(e)}})}static _getLocalizedCount(e){return I.StringHelper.formatWithLocalizedCountValue(he.O_,he.X4,e)}render(){return a.createElement(y.LimitedLengthTextField,{label:this.props.label,multiline:this.props.multiline,value:this.state.value,defaultValue:this.state.value,onChanged:this._onValidChange,maxLength:this.props.maxCharacters,getLimitedLengthMessage:this._getLimitedLengthMessage})}constructor(e){super(e),this._onValidChange=e=>{this._handleGetErrorMessage(e||"")||(s._SPKillSwitch.isActivated("3ffa6b5d-b309-4f16-a93d-86d9e47d73cb")?this.props.onChange?.(e):this.props.onChange?.(this.props.label,e),this.props.onValidChange&&this.props.onValidChange(e||""))},this._handleGetErrorMessage=e=>{if(!e||e.length<=this.props.maxCharacters)return"";{const t=be._getLocalizedCount(this.props.maxCharacters),n=be._getLocalizedCount(e.length-this.props.maxCharacters);return I.StringHelper.format(he.Mg,t,n)}},this._getLimitedLengthMessage=e=>e>=0?I.StringHelper.format(he.Wk,I.StringHelper.format(he.TS,this.props.maxCharacters),be._getLocalizedCount(e)):"",this.state={value:e.initialValue||""}}}var ge=E(464),ve=E(592);class ye extends a.PureComponent{render(){const e=this._content;let t;return!s._SPKillSwitch.isActivated("d3e7d14b-3886-4b5c-9b1b-d1ba5675074d")&&this.props.thumbnail?.type===me.ThumbnailType.FabricReactIcon&&this.props.thumbnail?.iconColor&&(t=this.props.thumbnail?.iconColor),!!e&&a.createElement("div",{role:"img",className:this.props.className,"aria-label":this.props.thumbnail?.altText,style:t?{fill:t}:void 0},e)}get _content(){if(this.props.onRenderThumbnail)return this.props.onRenderThumbnail();const t=this.props.thumbnail;if(t)switch(t.type){case me.ThumbnailType.FabricReactIcon:return a.createElement(q.Icon,{iconName:t.iconName,style:t.iconColor?{color:t.iconColor}:void 0,role:"presentation",className:this.props.iconClassName});case me.ThumbnailType.IconSizeImage:const n={className:this.props.iconClassName,imageFit:q.ImageFit.cover,src:t.iconUrl,role:"presentation",alt:t.altText};return a.createElement(q.Icon,{iconType:q.IconType.image,style:t.iconColor?{color:t.iconColor}:void 0,imageProps:n,className:this.props.iconClassName});case me.ThumbnailType.Image:const i={imageFit:void 0!==t.imageFit?t.imageFit:q.ImageFit.cover,src:this.state.isRenderBackup&&t.backupImageUrl?t.backupImageUrl:t.imageUrl,alt:t.altText,title:t.altText?t.altText:void 0,role:t.altText?void 0:"presentation",className:this.props.iconClassName,onLoadingStateChange:this._handleImageLoadingStateChange};return i.styles={image:{width:"100%",height:"100%",...!s._SPKillSwitch.isActivated("4b38f545-e45d-4349-b675-a4857fea13d6")&&(0,y.shouldDisableImageContextMenu)(t.contentProvider)?{pointerEvents:"none"}:{}}},c()||(this._imageMonitor=new e._QosMonitor(`${this.props.qosPrefix}.ImageLoad`)),a.createElement(q.Icon,{iconType:q.IconType.image,imageProps:i,className:this.props.iconClassName});default:return}}_handleImageLoadingStateChange(e){!c()&&this._imageMonitor&&(e===q.ImageLoadState.loaded?this._imageMonitor.writeSuccess():e===q.ImageLoadState.error&&this._imageMonitor.writeUnexpectedFailure("ImageLoadError",void 0,{isRenderBackup:this.state.isRenderBackup})),this.setState(t=>{if(e===q.ImageLoadState.error&&!t.isRenderBackup)return{isRenderBackup:!0}})}constructor(e){super(e),this.state={isRenderBackup:!1}}}(0,ve._ts_decorate)([q.autobind],ye.prototype,"_handleImageLoadingStateChange",null),Y.loadStyles('.t_0SXmv_0Bfl_{position:relative}.t_0SXmv_0Bfl_.s_GoqL-_0Bfl_{background-color:"[theme:neutralLight, default: #edebe9]"}.f_dX8no_0Bfl_{padding-bottom:56.25%;width:100%}.s_8cg_5_0Bfl_{height:100px;width:100px}.t_BoMJ__0Bfl_{align-items:center;bottom:0;display:flex;justify-content:center;left:0;overflow:hidden;position:absolute;right:0;top:0}.t_BoMJ__0Bfl_.t_KSbPj_0Bfl_{font-size:64px;line-height:100%;text-align:center}.t_BoMJ__0Bfl_.t_YJ-r0_0Bfl_ .i_gsLLm_0Bfl_{height:100%;width:100%}.t_BoMJ__0Bfl_.t_PM1V4_0Bfl_ .i_gsLLm_0Bfl_{height:64px;width:64px}.s_vqc3q_0Bfl_{left:50%;margin:0;position:absolute;top:50%;transform:translate(-50%,-50%)}',!0);class Se extends a.PureComponent{render(){const e=(0,q.css)(this.props.wrapperClassName,"t_0SXmv_0Bfl_",this.props.previewFullWidth?"f_dX8no_0Bfl_":"s_8cg_5_0Bfl_",{"s_GoqL-_0Bfl_":this.props.previewGrayBackground}),t=(0,q.css)("t_BoMJ__0Bfl_",{t_KSbPj_0Bfl_:this.props.thumbnail?.type===me.ThumbnailType.FabricReactIcon,t_PM1V4_0Bfl_:this.props.thumbnail?.type===me.ThumbnailType.IconSizeImage,"t_YJ-r0_0Bfl_":this.props.thumbnail?.type===me.ThumbnailType.Image});return this.props.showLoading?a.createElement("div",{className:e},a.createElement(ge.Spinner,{className:"s_vqc3q_0Bfl_",type:q.SpinnerType.large,label:he.N6})):a.createElement("div",{className:e},a.createElement(ye,{thumbnail:this.props.thumbnail,className:t,iconClassName:(0,q.css)(this.props.iconClassName,"i_gsLLm_0Bfl_"),qosPrefix:this.props.qosPrefix,onRenderThumbnail:this.props.onRenderThumbnail}))}}class De extends a.PureComponent{render(){return s._SPKillSwitch.isActivated("31582809-6161-4521-87df-a8eb72575445")||!this.props.thumbnail||this.props.thumbnail.altText||(this.props.thumbnail.altText=this.props.customSelectedIconName?this.props.customSelectedIconName.split("_").join(" "):"Custom Selected Thumbnail"),this._shouldShowThumbnailRenderer()?a.createElement(Se,{thumbnail:this.props.thumbnail,previewFullWidth:this.props.previewFullWidth,previewGrayBackground:this.props.previewGrayBackground,wrapperClassName:this.props.thumbnailRendererWrapperClassName,iconClassName:this.props.thumbnailRendererIconClassName,qosPrefix:this.props.qosPrefix,onRenderThumbnail:this._isCustomIconPresent?this._renderCustomIcon:void 0}):null}get _isCustomIconPresent(){return Boolean(this.props.customIconSet&&this.props.customSelectedIconName)}constructor(...e){super(...e),this._shouldShowThumbnailRenderer=()=>s._SPKillSwitch.isActivated("e8f99b98-01b3-40b3-93ba-3e3cf9070b88")?Boolean(this.props.thumbnail&&(this.props.thumbnail.iconName||this.props.thumbnail.imageUrl||this.props.thumbnail.backupImageUrl)):Boolean(this.props.thumbnail&&(this.props.thumbnail.iconName||this.props.thumbnail.imageUrl||this.props.thumbnail.backupImageUrl))||this._isCustomIconPresent,this._renderCustomIcon=()=>this.props.customIconSet.get(this.props.customSelectedIconName)}}function Ie(e,t,n){return be.getTextFieldGroup(n,{label:he.eu,initialValue:t,multiline:!1,maxCharacters:255,onValidChange:e})}function xe(e){const{iconChangedCallback:t}=e,n=a.useCallback(()=>{t?.("Globe")},[t]);return a.createElement(oe.Button,{"data-automation-id":"AddIconPropertyPaneButton",onClick:n,icon:a.createElement(fe,null),style:{width:"100%"}},he.J_)}function Ce(e,t){return(0,me.PropertyPaneLabel)(e,{text:t?.pickerLabelOverride||he.rZ})}function Oe(e,t,n,r,o,c,d,u,f){const p=[],m=[];if(o.autoSelectOptions.enabled&&m.push({key:_e.AutoSelect,disabled:o.disabled&&!l(),text:o.autoSelectOptions.optionLabel||he.Wi,checked:r===_e.AutoSelect}),o.imageOptions.enabled&&m.push({key:_e.Image,disabled:o.disabled&&!l(),text:o.imageOptions.optionLabel||he.dt,checked:r===_e.Image}),o.iconOptions.enabled&&m.push({key:_e.FabricReactIcon,disabled:o.disabled&&!l(),text:o.iconOptions.optionLabel||he.uH,checked:r===_e.FabricReactIcon}),K()&&!s._SPKillSwitch.isActivated("05ce492b-57d1-465c-a135-90206eb4c5a1")&&f&&!function(e,t){return e===_e.FabricReactIcon&&!!t.iconOptions.thumbnailInfo?.iconName}(r,o))p.push(Ce(t,d)),p.push(function(e){const t=a.createElement(xe,{iconChangedCallback:e});return(0,me.PropertyPaneCustomField)({key:"addIconButton",isInternal:!0,onRender:e=>{re.render(t,e)},onDispose:e=>{i.unmountComponentAtNode(e)}})}(o.iconChangeCallback));else switch(p.push(!K()||s._SPKillSwitch.isActivated("644abf6e-1c40-467b-ab0c-e79f003b039d")||m.length>1?(0,pe.PropertyPaneChoiceGroup)(t,{options:m,label:d?.pickerLabelOverride||he.rZ}):Ce(t,d)),r){case _e.Image:p.push(function(e,t,n,a,i,r,o,s){return(0,me.PropertyPaneThumbnailPicker)("imagePicker",{serviceScope:t,onItemChanged:a,thumbnail:n.thumbnailInfo,callerName:e,previewFullWidth:i?.previewFullWidth,previewGrayBackground:i?.previewGrayBackground,thumbnailRendererWrapperClassName:i?.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:i?.thumbnailRendererIconClassName,onItemDeleted:n.itemDeleteCallback,forceFullUrl:r,disabled:o,enableGettyStockAssets:s})}(e,n,o.imageOptions,o.imageChangeCallback,d,o.ensureImageFullUrl,o.disabled,o.enableGettyStockAssets)),c&&p.push(Ie(c.altTextChangeCallback,c.currentAltText,c.altTextFieldKey));break;case _e.AutoSelect:p.push(function(e,t,n,r,o){const c={thumbnail:e,previewFullWidth:t?.previewFullWidth,previewGrayBackground:t?.previewGrayBackground,thumbnailRendererWrapperClassName:t?.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:t?.thumbnailRendererIconClassName,qosPrefix:n,customIconSet:r,customSelectedIconName:o},d=a.createElement(De,c);return(0,me.PropertyPaneCustomField)({key:"imagePicker",isInternal:!0,onRender:e=>{re.render(d,e)},...K()&&!s._SPKillSwitch.isActivated("6f414a1d-7b7a-421d-9264-97c939232dae")&&{onDispose:e=>{i.unmountComponentAtNode(e)}}})}(o.autoSelectOptions.thumbnailInfo,d,e,o.customIconSet,o.customSelectedIconName)),c&&p.push(Ie(c.altTextChangeCallback,c.currentAltText,c.altTextFieldKey));break;case _e.FabricReactIcon:p.push(function(e,t,n,a,i,r,o,s){return(0,me.PropertyPaneIconPicker)("iconPicker",{thumbnail:t.thumbnailInfo,onItemChanged:e,previewFullWidth:n?.previewFullWidth,previewGrayBackground:n?.previewGrayBackground,thumbnailRendererWrapperClassName:n?.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:n?.thumbnailRendererIconClassName,callerName:a,customIconSet:i,customSelectedIconName:r,onItemDeleted:t.itemDeleteCallback,_extendedIcons:o,disabled:s})}(o.iconChangeCallback,o.iconOptions,d,e,o.customIconSet,o.customSelectedIconName,o.extendedIcons,o.disabled))}return p}const we=["airplane_take_off","alert","alert_urgent","approvals_app","apps","apps_add_in","archive","attach","backpack","balloon","beach","bed","block","board","bookmark","bug","building","building_bank","building_shop","building_skyscraper","calendar_checkmark","calendar_clock","calendar_edit","calendar_question_mark","calendar_reply","calendar_sync","calendar_work_week","call","camera","cart","channel","channel_add","channel_alert","channel_share","chat","city","clipboard","clipboard_paste","clock","cloud_download","comment_mention","comment_multiple","communication","compass_northwest","compose","conference_room","contact_card_group","copy","cube","currency_dollar_euro","dentist","desktop","desktop_mac","doctor","document","document_add","document_catch_up","document_question_mark","drafts","drink_beer","drink_coffee","dumbbell","emoji","emoji_add","error_circle","filter","flag","flag_off","flash","flash_checkmark","glasses","globe","grid","guest","hat_graduation","headset","heart","highlight","home","home_checkmark","image","image_edit","important","info","inking_tool","inprivate_account","key","laptop","leaf_two","library","lightbulb","link","location","location_off","lock_closed","mail","mail_inbox","map_drive","math_formula","meet_now","megaphone","mic_off","mic_on","mic_prohibited","money","movies_and_tv","music_note_2","my_location","options","page_fit","paint_brush","paint_bucket","payment","people","people_add","people_call","people_community","people_search","people_team","person","person_add","person_available","person_call","person_clock","person_mail","person_prohibited","person_question_mark","person_support","premium","reading_list","record","remote","reward","ribbon","rocket","ruler","run","savings","search","send","settings","shield","shifts","slide_text","snooze","speaker_0","speaker_1","sport","star","stop","store_microsoft","sync_off","table","table_simple","tab","tag","target","tasks","tent","tetris_app","thumb_like","timer","trophy","tv","vault","vehicle_bicycle","vehicle_bus","vehicle_cab","vehicle_car","vehicle_subway","video","video_person","voicemail","warning","weather_moon","weather_moon_off"];function Ee(e){return E.e(112).then(E.bind(E,26)).then(t=>t.supportedIconMap.get(e))}var Ae=E(485),Le=E(94),ke=E(575);Y.loadStyles(".c_5mgSV_0Bfl_{display:inline-flex}",!0);const Me=JSON.parse('{"Gy":"Enable audience targeting","kl":"Enable audience targeting to promote content to specific audiences across the site.","Hi":"Enable audience targeting to show or hide content within this webpart. To show or hide the entire web part, go to the audience targeting section.","_A":"Press enter to learn more.","$$":"{0} {1}","s1":"On","KX":"Off","dX":"Enabled audience targeting.","IF":"Disabled audience targeting."}');function Pe(e,t){const n=class{static isWebPartAudienceTargetingEnabled(){return s._SPFlight.isEnabled(60668)}}.isWebPartAudienceTargetingEnabled()?Me.Hi:Me.kl,i=I.StringHelper.format(Me.$$,n,Me._A),r=t.labelText||Me.Gy,o=a.createElement("div",{className:"c_5mgSV_0Bfl_"},a.createElement(Ae.Label,{"aria-label":r},r),a.createElement(Le.TooltipHost,{content:n},a.createElement(ke.IconButton,{"aria-label":i,iconProps:{iconName:"info"},href:t.infoLink,target:"_blank"}))),c=s._SPKillSwitch.isActivated("f8859d52-a5fb-46d1-94be-0babc89a0c19");return(0,me.PropertyPaneToggle)(e,{key:e,_label:o,onText:Me.s1,offText:Me.KX,ariaLabel:c?void 0:r,onAriaLabel:c?Me.dX:void 0,offAriaLabel:c?Me.IF:void 0,dataAutomationId:t.dataAutomationId})}var Te;!function(e){e.PeopleWebpart="PeopleWebpart",e.EditorialCardWebpart="EditorialCardWebpart",e.QuickLinksWebpart="QuickLinksWebpart",e.EventsWebpart="EventsWebpart",e.ContentRollupWebpart="ContentRollupWebpart"}(Te||(Te={}));var Ue=E(944);const Fe=JSON.parse('{"k":"Link"}');class He extends a.PureComponent{render(){return a.createElement(Ue.TextField,{value:this.state.textValue,placeholder:this.props.prefix?"":"https://",onChange:this._onChange,label:this.props.label||Fe.k,prefix:this.props.prefix,disabled:this.props.disabled})}constructor(e){super(e),this._onChange=(e,t)=>{if(this.props.enforceHttps){const e=this._ensureProtocol(t)??"https://";this.setState({textValue:e}),this.props.onUrlUpdated(e)}else this.props.disableProtocolCheck?(this.props.onUrlUpdated(t),this.setState({textValue:t})):(this._ensureProtocolDebounced(t),this.setState({textValue:t}))},this._ensureProtocol=e=>{if(e){if(this.props.enforceHttps)return y.UrlUtility.ensureSchema(e,["https"]);{const t=new I.Uri(e).getScheme()?e:this.props.prefix?`${e}`:`https://${e}`;this.props.onUrlUpdated(t),this.setState({textValue:t})}}},this._ensureProtocolDebounced=(new q.Async).debounce(this._ensureProtocol,1e3),this.state={textValue:e.initialUrl}}}})(),T})())})();