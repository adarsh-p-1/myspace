(()=>{var e=document.currentScript;define(["react","react-dom","@microsoft/sp-component-base","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@microsoft/sp-webpart-base","@msinternal/sp-component-utilities","@msinternal/sp-telemetry","@microsoft/sp-image-helper","@msinternal/odsp-utilities-bundle","@msinternal/sp-rich-image","@msinternal/swc-helpers-bundle","@msinternal/sp-image-shared","@msinternal/sp-a11y-checker-util","@msinternal/sp-renderable-components-base","@msinternal/odsp-core-bundle","@ms/office-ui-fabric-react-bundle","@microsoft/sp-http-base","@microsoft/load-themed-styles","@microsoft/sp-page-context","@msinternal/sp-fluentui-migration-reactdom-render-bundle","@msinternal/sp-fluentui-v9-utilities-bundle","@msinternal/sp-fluentui-migration-link-bundle","@microsoft/sp-http","@microsoft/sp-lodash-subset","@microsoft/sp-loader","@msinternal/sp-webpart-shared-editmode","@msinternal/sp-fluent-theme-bundle","@msinternal/sharepoint-ui-tokens-bundle","@msinternal/sp-fluentui-migration-button-bundle","@msinternal/sp-pages-core","@msinternal/sp-heading-level","@msinternal/sp-topic-sdk","@msinternal/sp-webpart-shared","@msinternal/uifabric-styling-bundle","@microsoft/sp-top-actions"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F)=>(()=>{var H={3552:(e,t,n)=>{"use strict";var a;n.d(t,{f:()=>a}),function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(a||(a={}))}
,9950:(e,t,n)=>{"use strict";n.d(t,{A4:()=>f,uF:()=>m});var a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],i=e=>{let t=0;for(let n=0;n<e.length;n++){let i=e[n];t=83*t+a.indexOf(i)}return t},r=(e,t)=>{var n="";for(let i=1;i<=t;i++){let r=Math.floor(e)/Math.pow(83,t-i)%83;n+=a[Math.floor(r)]}return n},o=e=>{let t=e/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)},s=e=>{let t=Math.max(0,Math.min(1,e));return t<=.0031308?Math.trunc(12.92*t*255+.5):Math.trunc(255*(1.055*Math.pow(t,.4166666666666667)-.055)+.5)},c=(e,t)=>(e=>e<0?-1:1)(e)*Math.pow(Math.abs(e),t),d=class extends Error{constructor(e){super(e),this.name="ValidationError",this.message=e}},l=e=>{let t=e>>8&255,n=255&e;return[o(e>>16),o(t),o(n)]},u=(e,t)=>{let n=Math.floor(e/361),a=Math.floor(e/19)%19,i=e%19;return[c((n-9)/9,2)*t,c((a-9)/9,2)*t,c((i-9)/9,2)*t]},f=(e,t,n,a)=>{(e=>{if(!e||e.length<6)throw new d("The blurhash string must be at least 6 characters");let t=i(e[0]),n=Math.floor(t/9)+1,a=t%9+1;if(e.length!==4+2*a*n)throw new d(`blurhash length mismatch: length is ${e.length} but it should be ${4+2*a*n}`)})(e),a|=1;let r=i(e[0]),o=Math.floor(r/9)+1,c=r%9+1,f=(i(e[1])+1)/166,p=new Array(c*o);for(let t=0;t<p.length;t++)if(0===t){let n=i(e.substring(2,6));p[t]=l(n)}else{let n=i(e.substring(4+2*t,6+2*t));p[t]=u(n,f*a)}let m=4*t,_=new Uint8ClampedArray(m*n);for(let e=0;e<n;e++)for(let a=0;a<t;a++){let i=0,r=0,d=0;for(let s=0;s<o;s++)for(let o=0;o<c;o++){let l=Math.cos(Math.PI*a*o/t)*Math.cos(Math.PI*e*s/n),u=p[o+s*c];i+=u[0]*l,r+=u[1]*l,d+=u[2]*l}let l=s(i),u=s(r),f=s(d);_[4*a+0+e*m]=l,_[4*a+1+e*m]=u,_[4*a+2+e*m]=f,_[4*a+3+e*m]=255}return _},p=(e,t,n,a)=>{let i=0,r=0,s=0,c=4*t;for(let d=0;d<t;d++){let t=4*d;for(let l=0;l<n;l++){let n=t+l*c,u=a(d,l);i+=u*o(e[n]),r+=u*o(e[n+1]),s+=u*o(e[n+2])}}let d=1/(t*n);return[i*d,r*d,s*d]},m=(e,t,n,a,i)=>{if(a<1||a>9||i<1||i>9)throw new d("BlurHash must have between 1 and 9 components");if(t*n*4!==e.length)throw new d("Width and height must match the pixels array");let o=[];for(let r=0;r<i;r++)for(let i=0;i<a;i++){let a=0==i&&0==r?1:2,s=p(e,t,n,(e,o)=>a*Math.cos(Math.PI*i*e/t)*Math.cos(Math.PI*r*o/n));o.push(s)}let l,u=o[0],f=o.slice(1),m="";if(m+=r(a-1+9*(i-1),1),f.length>0){let e=Math.max(...f.map(e=>Math.max(...e))),t=Math.floor(Math.max(0,Math.min(82,Math.floor(166*e-.5))));l=(t+1)/166,m+=r(t,1)}else l=1,m+=r(0,1);return m+=r((e=>(s(e[0])<<16)+(s(e[1])<<8)+s(e[2]))(u),4),f.forEach(e=>{m+=r(((e,t)=>19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*c(e[0]/t,.5)+9.5))))*19+19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*c(e[1]/t,.5)+9.5))))+Math.floor(Math.max(0,Math.min(18,Math.floor(9*c(e[2]/t,.5)+9.5)))))(e,l),2)}),m}}
,304:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}}
,7224:(e,t,n)=>{"use strict";var a,i,r,o,s;!function(e){e[e.none=0]="none",e[e.standard=1]="standard",e[e.compact=2]="compact",e[e.minimal=3]="minimal",e[e.extended=4]="extended"}(a||(a={})),function(e){e[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right"}(i||(i={})),function(e){e[e.right=0]="right",e[e.middle=1]="middle",e[e.left=2]="left"}(r||(r={})),function(e){e[e.unknown=-1]="unknown",e[e.white=0]="white",e[e.black=1]="black",e[e.lightGradient=2]="lightGradient",e[e.darkGradient=3]="darkGradient"}(o||(o={})),function(e){e[e.topToBottom=0]="topToBottom",e[e.bottomToTop=1]="bottomToTop",e[e.leftToRight=2]="leftToRight",e[e.rightToLeft=3]="rightToLeft"}(s||(s={}))}
,7567:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});var a=n(6277);function i(e,t,n){if(n?.killSwitch&&a.KillSwitch.isActivated(n.killSwitch))return!1;const i=n?.flightEnabledOverride?n.flightEnabledOverride(e):a.FeatureOverrides.isFeatureEnabled(e,t.ExpFeatures);if(!n?.experimentFlightId)return n?.logTag&&console.log(n.logTag,e,t),i;const r=1===(0,a.getVariantAndLogExposure)(n.experimentFlightId,t);return n?.logTag&&console.log(n.logTag,e,t,i,r),i||r}}
,5105:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});const a={ReadAfterOtherContent:1,ReadImmediately:2}}
,5260:(e,t,n)=>{"use strict";(0,n(8424).loadStyles)([{rawString:".ms-odsp-screenReaderAlert{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])}
,9545:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(5959),i=n(5105);n(5260);class r extends a.PureComponent{static read(e,t){if(e){const n=document.createTextNode(e);r._getDedicatedDomNode(t||i.W.ReadAfterOtherContent).appendChild(n)}}static _getDedicatedDomNode(e){r._alertNode&&document.body.removeChild(r._alertNode);const t=document.createElement("div");switch(t.setAttribute("data-automation-id","screen-reader-alert-static"),t.classList.add("ms-odsp-screenReaderAlert"),e){case i.W.ReadAfterOtherContent:t.setAttribute("aria-live","polite");break;case i.W.ReadImmediately:t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive")}return document.body.appendChild(t),r._alertNode=t,r._alertNode}componentDidMount(){r.read(this.props.message,this.props.readingMode)}componentDidUpdate(e){e.message===this.props.message&&e.indicator===this.props.indicator||r.read(this.props.message,this.props.readingMode)}render(){return!1}}}
,5618:(e,t,n)=>{"use strict";n.d(t,{QC:()=>a.A,QY:()=>i.W});var a=n(9545),i=n(5105)}
,2616:(e,t,n)=>{"use strict";n.d(t,{S0:()=>o,s3:()=>r});var a=n(9676),i=n(1027);function r(){return a._SPFlight.isEnabled(62414)&&!(0,i.ZN)()}function o(){return!(0,i.vZ)()&&a._SPFlight.isEnabled(62479)}}
,1027:(e,t,n)=>{"use strict";n.d(t,{Je:()=>r,ZN:()=>o,vZ:()=>i});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("6b3c97ae-c33a-4c1e-9b88-5dc1e87ab20f")}function r(){return a._SPKillSwitch.isActivated("d189d05b-4d13-4ee0-9e7a-4244a0aa489f")}function o(){return a._SPKillSwitch.isActivated("7db3df25-50bd-418c-b722-d6f57dbf8ede")}}
,4314:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});var a=n(8810);function i(e,t){return a.SPAlternativeUrls.getUserPhotoUrl(decodeURIComponent(e),t)}}
,4766:(e,t,n)=>{"use strict";n.d(t,{cj:()=>i});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("12b79e17-be6f-484d-aaf0-2b97b6b6a465")}}
,8417:(e,t,n)=>{"use strict";function a(e){return e||{x:50,y:50}}n.d(t,{c:()=>a})}
,1716:(e,t,n)=>{"use strict";function a(){if("undefined"==typeof window||void 0===window.location)return;const e=new URLSearchParams(window.location.search).get("changeLQIPQuality");if(null===e||""===e)return;const t=parseInt(e,10);return isNaN(t)||t<1||t>10?void 0:t}n.d(t,{Z:()=>a})}
,3030:(e,t,n)=>{"use strict";n.d(t,{Jt:()=>d,rW:()=>u,wn:()=>l});var a=n(2207),i=n(9950),r=n(1716),o=n(4766);const s="LowQualityImagePlaceholder",c="Unknown",d=a._LogSource.create(s);function l(e,t=100,n){return new Promise((d,l)=>{const u=new a._QosMonitor(s+".GenerateBlurHash"),f=new Image;f.crossOrigin="Anonymous",f.onload=()=>{try{const e=Math.min(1,t/Math.max(f.width,f.height)),a=(0,o.cj)()?Math.floor(f.width*e):Math.max(1,Math.floor(f.width*e)),s=(0,o.cj)()?Math.floor(f.height*e):Math.max(1,Math.floor(f.height*e)),p=document.createElement("canvas");p.width=a,p.height=s;const m=p.getContext("2d");if(!m){const e=new Error("Failed to get canvas context");return u.writeUnexpectedFailure("CanvasContextFailed",e,{webPartName:n||c}),void l(e)}m.drawImage(f,0,0,a,s);const _=m.getImageData(0,0,a,s),h=(0,r.Z)(),b=h||a>s?3:2,g=h||a>s?2:3,v=(0,i.uF)(_.data,a,s,b,g);u.writeSuccess({webPartName:n||c,originalWidth:f.width.toString(),originalHeight:f.height.toString(),scaledWidth:a.toString(),scaledHeight:s.toString(),blurHashLength:v.length.toString()}),d(v)}catch(e){u.writeUnexpectedFailure("EncodingFailed",e instanceof Error?e:new Error("Unknown error"),{webPartName:n||c}),l(new Error("Low Quality Image Placeholder failed to generate image: "+e))}},f.onerror=e=>{u.writeUnexpectedFailure("ImageLoadFailed",new Error("Failed to load image"),{webPartName:n||c,error:e instanceof Error?e.message:"Error decoding image"}),l(new Error("Low Quality Image Placeholder failed to generate image: "+e))},f.src=e,a._EngagementLogger.logEventWithLogEntry(new a._LogEntry("LowQualityImagePlaceHolder","GenerateBlurHash",a._LogType.Event,{webPartName:n||c}))})}function u(e,t,n,r=1,o){const d=new a._QosMonitor(s+".CreateImageFromBlurHash");try{const s=document.createElement("canvas");s.width=t,s.height=n;const l=s.getContext("2d");if(!l)throw new Error("Unable to get canvas 2D context");const u=(0,i.A4)(e,t,n,r),f=l.createImageData(t,n);f.data.set(u),l.putImageData(f,0,0);const p=s.toDataURL();return d.writeSuccess({webPartName:o||c,outputWidth:t.toString(),outputHeight:n.toString(),dataUrlLength:p.length.toString()}),a._EngagementLogger.logEventWithLogEntry(new a._LogEntry("LowQualityImagePlaceHolder","CreateImageFromBlurHash",a._LogType.Event,{operation:"CreateImageFromBlurHash",blurHashLength:e.length.toString(),width:t.toString(),height:n.toString(),webPartName:o||c})),p}catch(e){throw d.writeUnexpectedFailure("DecodingFailed",e instanceof Error?e:new Error("Unknown error"),{webPartName:o||c}),new Error("Low Quality Image Placeholder failed to decode blur hash: "+(e instanceof Error?e.message:"Unknown error"))}}}
,3338:(e,t,n)=>{"use strict";function a(){if(KeyboardEvent instanceof Function)return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,which:13});const e=document.createEvent("KeyboardEvent");return e.initKeyboardEvent("keydown",!0,!0,window,"Enter","Enter",0,"",!1),e}function i(){if(MouseEvent instanceof Function)return new MouseEvent("mousemove",{bubbles:!0,cancelable:!0});const e=document.createEvent("MouseEvent");return e.initEvent("mousemove",!0,!0),e}function r(){if(MouseEvent instanceof Function)return new MouseEvent("click",{bubbles:!0,cancelable:!0});const e=document.createEvent("MouseEvent");return e.initEvent("click",!0,!0),e}n.d(t,{HB:()=>a,s_:()=>r,xT:()=>i})}
,1491:(e,t,n)=>{"use strict";n.d(t,{Up:()=>i,XA:()=>r,Yg:()=>c,aM:()=>s,jF:()=>o});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("f3b11671-f43f-4e6d-8d17-b66bc86f4838")}function r(){return a._SPKillSwitch.isActivated("b0861b96-5b5e-484d-9bca-5f32b00504ac")}function o(){return a._SPKillSwitch.isActivated("f6d97b40-3ab5-40c6-8152-aaeff09f013c")}function s(){return a._SPKillSwitch.isActivated("02ab39f0-d76a-4d20-b601-86d70e2fb8b3")}function c(){return a._SPKillSwitch.isActivated("62be4d8d-22b6-4f17-a78c-7dc8c6c234b4")}}
,6625:(e,t,n)=>{"use strict";n.d(t,{y:()=>a});const a={DefaultImage:"DefaultImage",SharePointImage:"SharePointImage",LocalImage:"LocalImage",ExternalImage:"ExternalImage"}}
,1657:(e,t,n)=>{"use strict";n.d(t,{l:()=>o});var a=n(2141),i=n(5959);n(8424).loadStyles('.o_43jkm_Wr9CO{align-items:center;background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]";color:#fff;display:flex;flex-direction:column;height:100%;justify-content:center;width:100%}.h_YAckp_Wr9CO .o_43jkm_Wr9CO{display:none}.s_JT1H1_Wr9CO .o_43jkm_Wr9CO{display:flex!important}@keyframes s_0y-3I_Wr9CO{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.s_6rKQH_Wr9CO{animation:s_0y-3I_Wr9CO 2s linear infinite;font-size:48px;margin:8px}.m_qd2JQ_Wr9CO{font-size:21px;font-weight:100;font-weight:300}.n_Lk1aT_Wr9CO .m_qd2JQ_Wr9CO{display:none}',!0);const r=JSON.parse('{"k":"Uploading..."}');function o(){return i.createElement("div",{className:"o_43jkm_Wr9CO"},i.createElement(a.Icon,{className:"s_6rKQH_Wr9CO",iconName:"Sync"}),i.createElement("span",{className:"m_qd2JQ_Wr9CO","aria-live":"assertive","aria-atomic":!0},r.k))}!function(e){e.hideClassName="h_YAckp_Wr9CO",e.showClassName="s_JT1H1_Wr9CO",e.noSpinnerMessageClassName="n_Lk1aT_Wr9CO"}(o||(o={}))}
,5038:(e,t,n)=>{"use strict";n.d(t,{M:()=>h,i:()=>o});var a=n(4949),i=n(8810),r=n(718);function o({pageContext:e,url:t,siteId:n,webId:o,uniqueId:s,callerId:c,originalWidth:d,originalHeight:l}){if(!t)return;if(0===t.indexOf("/_LAYOUTS/IMAGES/"))return;const u=new a._SPResourcePath(t),f=a._PreviewUtility.getFileExtension(u)||"";if(!r.PreviewHelper.hasThumbnailOrFileTypeSupportsPreview(f,void 0)&&"gif"!==f)return;let p;const m=a._ThumbnailUrlGenerator.getThumbnailProvider(t);switch(m){case a._ThumbnailProviderType.SPOLayoutsImage:p=t;break;case a._ThumbnailProviderType.PrivateCDN:case a._ThumbnailProviderType.AFDPrivateCDN:case a._ThumbnailProviderType.MeTA:case a._ThumbnailProviderType.Stock:case a._ThumbnailProviderType.VROOMMeTACache:return;case a._ThumbnailProviderType.HubbleStockThumbnail:case a._ThumbnailProviderType.HubbleStock:p=t;break;case a._ThumbnailProviderType.PublicCDN:case a._ThumbnailProviderType.AFDPublicCDN:case a._ThumbnailProviderType.MediaCDNHubble:p=a._ThumbnailUrlGenerator.updateThumbnailWidth(t,400)}if(p?.length<=255)return p;const _=e&&e.web.absoluteUrl||window.location.href;let h,b=new i.Uri(_).getLeftPart(1),g=!!(n&&o&&s);const v=!(e&&e.web&&e.web.serverRelativeUrl&&t)||-1===t.toUpperCase().indexOf(e.web.serverRelativeUrl.toUpperCase());return t&&(m===a._ThumbnailProviderType.SharePointHost||m===a._ThumbnailProviderType.MySite||u.isInternalResource(e))&&(g=!0,u.format===a._SPResourcePathFormat.absolute?(b=u.authority,h=u.path):h=t),g&&(p=r.PreviewHelper.getPreviewImageUrl(f,void 0,b,h,n,o,s,void 0,!0,c,d,l),p&&p.length<=255)?p:(p=function(e,t,n,a){const r=a&&a.web.absoluteUrl,o=""!==new i.Uri(e).getHost(),s=n?t:r,c=n?e:e.substr(a.web.serverRelativeUrl.length);return o?e:i.Uri.concatenate(s,c)}(t,b,v,e),p.length<=255?p:void 0)}var s=n(5592),c=n(5959),d=n(9676),l=n(2207),u=n(8122);const f=new Set(["03590920bdfd864322cf7e8cca891bb4","0381c1bcfc0b809623b805e322dd9fa1","03d374b16722d252588fa2d58a3e828d","0540187fe91e3b78e3b5d06999eebf80","083313c7a8083e625c0def330dbd7cdd","0974242efa7f7b9bb52240ee615b931b","0bbb13911b2ce26da17bbdf2ea3404b6","0d827eba349aa0591be57331540fc4f4","0e47add0cdf9530b9e30ddef0c489a40","0f78c3aa1a3da070d8f62bb9a2ee76ae","0fe8fe2f5220263be4cbd5f61d9cf23c","178a70df6ddfa637e3d4f0ea9a80fbdd","1a960363e8daa165d3b82144b0d68c03","1e033e719ef573ec796c38bf8ac41dfc","1f420b466365299439abf6fe2f8bff6a","20f0b5fb7de21fa889b002714ec58f20","2149d6090d915f849f5c33c07545fb03","23d161d98611bae938697c4d0af3bfd4","241b2579d59d10255b2e405fbcbb9117","26736ef07954f237039d261c357f06e5","279ec9ccb88c02985b4e1f645b755faf","2d523e15f73a2b345887c8b8299c8d3c","2fce211aefcaec7742455aa616edfa32","2f73a4291c58a29acc783b73fa88c282","3178a5744ef0cd2b61757583d7b7ccf1","319f83a0e835d32ce2660a4de654a7c0","3a9c8d1a8fae79004ed36c0147bdd71b","3fa3e0b2e84cb77f00799dca10f1a03e","4a48f26592f4e1498d7a478a4c48609c","41ebba55d20ff0a87734a09d88dc8f27","4312d1e9ec65cb2412e83a64f50fcdd1","44f2e736a8f04d1b47a1151eb37e0a64","48e8c755618be2d66c67976910bac81f","49fe29d48bd08304cb7a9be0a4256b8a","5b60516651aebbbc796eafdee967ef2c","613c9c11d6bfdec3dd2a568412b79762","62fe9bb236110e4553483b02e1989986","68df1aaa4d4d20f6749dcf0cbcbfd182","6c06b3944a82b194dd56b848d5c1e53f","6fe016add870f202c0a30c70ee943c73","7024c1dc5ed913c848ac81adadfedee4","7ad602295f8386b7615b582d87bcc294","7f25de15c2e701c901252f81c1911af2","8193ab3946149e9175a3c3d44219e9e1","8a2bceaca7e84b8f4da535d772625c6f","8a430e2d85dc31b60c0c6f68d7cc4c20","8b02cb6c9f9d7a7e895970d94317e20a","8ddba906d9614422695d3c9756afee7f","8f296bb8aac7be4f08409d8dbbbc8714","9029ea4d3ee7796fe043710dfff1d218","90ac8c284c2ac3a6f6b7e6518dbb6227","965331b9e159f7e263f86866902241e8","98f88501895b89e844d24793dadc8a9f","9a85f4ab720503d37748e2d854a238dc","9aae9266066558e0e42223ed4d82b1f8","a284f85a5a3096a5e90f670316993365","a3f3c88a874da09d43c8f88deb9246b6","ab08afa407a9c009513a07525fadf367","ba3cc3f8be4b187472e2f5f7d5376bb9","b3b9212834745aa4457f459f12e56653","b8a930a9d063513ea9bba50a34aaaba5","b8f6d5994ef9e9a96180ea43dbb00ed6","baa367f8c4aef7abdcb912c61f53ed10","bc4fab3f78291f699922e57650be557f","c065f1d4e77c3678be1ff6aa835dda69","c4ae58fb4e94e08cfff98beddeb615ac","c63681d72227d0813a5cdfccb62be638","c903233a37600953361096a5c28d0d46","c9dc379c327bef6f8db124f5f013fe22","cbcecad0b1eb14fe8186c566f22b0fa1","cd26d43c2fabf764bfc054d06462f64f","cd849e71a1785cc1f046b181e68bbec3","d283507fbbeb97715a321ddbd2442164","d6c8114c17555266c90ad015c2acd8b9","dacd2fb8ace0a4176a74a228539b3d33","e6ede0691f3312bd6fd9f1066153a868","e72abfe847c8792f99bc8b2cbeb65886","ea754dbc9eba7d06ae4b444f722c24df","f0d90ca687e974534dfc12798166c7e6","ffb18190d6e56748b5d6d743ff7421ad","07685baa515ccd7f52defd1043fca4cc"]),p="DoughboyDetector",m="CDNUserPhoto",_="AFDCDNUserPhoto";class h extends c.Component{componentDidMount(){this.state.imageData?requestAnimationFrame(this._completeDetection):this.props.disableDelayDetect?this._resolveImage(this.props.imageUrl).then(this._completeDetection,this._completeDetection):setTimeout(()=>{this._resolveImage(this.props.imageUrl).then(this._completeDetection,this._completeDetection)},7e3)}UNSAFE_componentWillReceiveProps(e){if(this.props.imageUrl!==e.imageUrl){const t=h._imageDataCache.get(e.imageUrl);t?this.setState({imageData:t}):this._resolveImage(e.imageUrl).catch(e=>l._TraceLogger.logError(this._logSource,e,"ResolveImage"))}}componentWillUnmount(){this._unmounted=!0,this._revokeBlobUrl()}render(){return this.props.renderImage(this.state.imageData||"",this.props.imageProps,this._extraProps)}_resolveImage(e){return new Promise((t,n)=>{const a=document.createElement("img");a.onload=()=>{const i=this._getImageBase64(a),o=(0,r.Md5Hash)(i);if(f.has(o))l._EngagementLogger.logEventWithLogEntry(new l._LogEntry("DoughboyDetector","IsDoughboyImage",l._LogType.Event,{fingerprint:o})),n(new r.ExpectedFailure("DoughboyImageDetected"));else if(this._unmounted)n(new r.ExpectedFailure("ElementUnmounted"));else{const n=`data:image/png;base64,${i}`;this.setState({imageData:n}),h._imageDataCache.set(e,n),t()}},a.onerror=e=>{n(new r.ExpectedFailure("DownloadImageFailed",e.error))},this._downloadImageBlob(e).then(e=>{this._revokeBlobUrl(),this._blobUrl=URL.createObjectURL(e),a.src=this._blobUrl}).catch(()=>a.src=e),a.crossOrigin="anonymous"})}_downloadImageBlob(e){return new Promise((t,n)=>{const a=d._SPKillSwitch.isActivated("debde2df-6396-4e00-a52b-9f0e28593f6f");let i;const r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob";let o="";if(!a){const t=e.toLowerCase();o=t.indexOf("/_layouts/15/userphoto.aspx")>-1?"UserPhoto":t.indexOf("_vti_bin/afdcache.ashx/_userprofile/userphoto.jpg")>-1?_:t.indexOf("https://privatecdn")>-1&&t.indexOf("/_userprofile/userphoto.jpg")>-1?m:"Unknown",i=new l._QosMonitor(`UserPhotoRenderService.${o}`)}r.onload=()=>{if(r.status>=200&&r.status<300&&r.response){if(!a){const e=o===m||o===_?r.getResponseHeader("x-cache"):"",t=o===_?r.getResponseHeader("x-ccc"):"",n=r.getResponseHeader("x-cache-origin");i.writeSuccess({service:o,alias:p,statusCode:r.status,CDNCache:e?.split(" ")[0],OriginCache:n,cacheCountryCode:t,size:r.response.size,source:r.response.type})}return t(r.response)}{const s=r.getResponseHeader("location");if(s&&r.status>=300&&r.status<400)return this._downloadImageBlob(s).then(t).catch(n);if(!a){const t=new Error(`<url>${(0,u.scrubUrl)(void 0,e)}</url> <errorCode>${r.status}</errorCode>`);404===r.status?i.writeExpectedFailure(`${o} failed`,t,{alias:p,statusCode:r.status}):i.writeUnexpectedFailure(`${o} failed`,t,{alias:p,statusCode:r.status})}n("")}},r.onerror=()=>{if(!a){const t=new Error(`<url>${(0,u.scrubUrl)(void 0,e)}</url> <errorCode>${r.status}</errorCode>`);i.writeUnexpectedFailure(`${o} failed`,t,{alias:p,headers:r.getAllResponseHeaders()})}n("")},r.send()})}_getImageBase64(e){const t=document.createElement("canvas");let n;t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0);try{n=t.toDataURL("image/png"),this._revokeBlobUrl()}catch(e){return""}return n.replace(/^data:image\/png;base64,/,"")}get _extraProps(){const{imageUrl:e,imageProps:t,renderImage:n,onDetectCompleted:a,...i}=this.props;return i}constructor(e){super(e),this._unmounted=!1,this._completeDetection=()=>{this.props.onDetectCompleted&&this.props.onDetectCompleted()},this._revokeBlobUrl=()=>{this._blobUrl&&(URL.revokeObjectURL(this._blobUrl),this._blobUrl=void 0)},this._logSource=l._LogSource.create("DoughboyDetector");const t=h._imageDataCache.get(e.imageUrl);this.state={imageData:t}}}h._imageDataCache=new Map,(0,s._ts_decorate)([(0,r.monitor)("DoughboyDetector.ResolveImage")],h.prototype,"_resolveImage",null)}
,8956:(e,t,n)=>{"use strict";function a(e){return"CanvasWebPartHost.Amplify.EmailEndpoint"===e}function i(e){return"CanvasWebPartHost.Amplify.TeamsEndpoint"===e}function r(e){return"CanvasWebPartHost.Amplify.EngageEndpoint"===e}function o(e){return i(e)||r(e)}function s(e){return a(e)||i(e)||r(e)}n.d(t,{H0:()=>i,Qo:()=>r,gL:()=>s,sE:()=>a,uy:()=>o})}
,6065:(e,t,n)=>{"use strict";n.d(t,{QJ:()=>i,XA:()=>r});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("1724b95c-398b-4e9a-84af-64b3c22c9cd6")}function r(){return a._SPKillSwitch.isActivated("d0f2a670-9b86-402b-aa91-2bc872f864c7")}}
,9369:(e,t,n)=>{"use strict";n.d(t,{CV:()=>i});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("a3f45048-0db5-4b7c-9a9a-e3183d216c4d")}}
,7422:(e,t,n)=>{"use strict";n.d(t,{v:()=>a});const a="The original author information is no longer available."}
,3724:(e,t,n)=>{"use strict";n.d(t,{C:()=>O,F:()=>g,GC:()=>c,GQ:()=>S,JU:()=>b,Lg:()=>D,N2:()=>A,Nx:()=>x,Rl:()=>E,S0:()=>y,UR:()=>f,Yc:()=>l,gx:()=>u,iV:()=>d,l7:()=>C,nE:()=>h,oF:()=>v,pd:()=>m,pq:()=>w,u0:()=>_,ym:()=>I,zy:()=>p});var a=n(9676),i=n(5519),r=n(1181),o=n(8391),s=n(9369);function c(){return a._SPFlight.isEnabled(60218)||1===i._SPPerfExperiment.getVariantAndTrackExperiment(i._PerformanceExperiment.SOXEventUpdate)}function d(){return a._SPFlight.isEnabled(1057)}function l(){return(0,o.TF)()&&a._SPFlight.isEnabled(60609)}function u(){return!(0,o.rL)()&&(1===a._SPExperiment.getVariantAndLogExposure(90163)||a._SPFlight.isEnabled(1438))}function f(){return a._SPFlight.isEnabled(1601)}function p(){return!(0,s.CV)()}function m(){return!(0,o.q8)()&&(0,r.isODBFilePickerEnabled)()}function _(){return a._SPFlight.isEnabled(61857)}function h(){return a._SPFlight.isEnabled(61763)}function b(){return!(0,o.Hd)()&&!(0,o.OM)()&&a._SPFlight.isEnabled(61245)}function g(){return a._SPFlight.isEnabled(61852)&&!(0,o.xx)()}function v(){return a._SPFlight.isEnabled(61555)}function y(){return!(0,o.vZ)()&&a._SPFlight.isEnabled(62479)}function S(){return!(0,o.Lo)()&&a._SPFlight.isEnabled(1888)}function D(){return a._SPFlight.isEnabled(62405)}function I(){return!(0,o.DX)()&&(a._SPFlight.isEnabled(62395)||1===a._SPExperiment.getVariantAndLogExposure(90359))}function x(){return(a._SPFlight.isEnabled(61880)||[1,4].indexOf(a._SPExperiment.getVariantAndLogExposure(90363))>-1)&&!(0,o.PD)()}function C(){return!(0,o.iU)()&&a._SPFlight.isEnabled(1975)}function O(){return!(0,o.Zu)()&&E()}function w(){return a._SPFlight.isEnabled(2e3)&&a._SPFlight.isEnabled(62566)}function E(){return!(0,o.Gy)()&&a._SPFlight.isEnabled(62700)}function A(){return!(0,o.$D)()&&E()}}
,8391:(e,t,n)=>{"use strict";n.d(t,{$D:()=>Ue,AL:()=>W,Ag:()=>_e,Ao:()=>pe,CN:()=>z,DX:()=>ue,EK:()=>V,EU:()=>Ve,Et:()=>Y,Fd:()=>ee,GI:()=>F,GK:()=>w,Gq:()=>ie,Gy:()=>Oe,HH:()=>ae,Hc:()=>x,Hd:()=>K,IH:()=>M,IL:()=>N,IN:()=>k,IT:()=>le,JS:()=>i,KM:()=>ge,KV:()=>L,Kz:()=>O,LB:()=>de,Lo:()=>f,MD:()=>Te,Mi:()=>l,Nc:()=>T,OM:()=>G,P:()=>D,PD:()=>ve,PE:()=>U,Q9:()=>Be,RV:()=>B,Ru:()=>ke,SR:()=>r,Sq:()=>P,TF:()=>u,Tj:()=>h,Ty:()=>Ce,Up:()=>E,V6:()=>C,Vy:()=>y,WQ:()=>oe,Xb:()=>s,Xr:()=>Fe,Xx:()=>X,Y1:()=>Pe,Y6:()=>$,YJ:()=>H,Zj:()=>Ie,Zu:()=>Ae,_3:()=>we,_X:()=>He,_u:()=>I,aG:()=>se,by:()=>Me,cE:()=>c,eW:()=>Re,f:()=>xe,f1:()=>re,f_:()=>R,fg:()=>he,fp:()=>te,fw:()=>fe,gy:()=>me,hA:()=>be,iU:()=>ye,jM:()=>J,k7:()=>Ne,lc:()=>S,m7:()=>b,mQ:()=>je,mT:()=>o,nt:()=>p,nv:()=>A,o$:()=>_,pr:()=>d,q8:()=>Le,qI:()=>Se,r0:()=>Q,rD:()=>j,rL:()=>m,rT:()=>De,rV:()=>Ee,rp:()=>v,sF:()=>g,t2:()=>Z,tJ:()=>q,vZ:()=>ce,xx:()=>ne});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("54a84d15-714a-4db3-b282-0be5a12aaa0a")}function r(){return a._SPKillSwitch.isActivated("fd97bfb5-b65d-48f6-80b6-440f8cb4a159")}function o(){return a._SPKillSwitch.isActivated("a09961b7-4607-45f3-ab09-143ddd318fbb")}function s(){return a._SPKillSwitch.isActivated("a7736064-4394-4ce0-83fe-ed366d26bb33")}function c(){return a._SPKillSwitch.isActivated("e0c5b1ba-d8d5-4cf9-bddb-e81291629d8d")}function d(){return a._SPKillSwitch.isActivated("97aca5c5-f7f4-4d1a-9e35-c481b6a95cdc")}function l(){return a._SPKillSwitch.isActivated("34e19bc8-cf54-4e16-b149-89ecd4088194")}function u(){return a._SPKillSwitch.isActivated("2b4d868e-0ae4-494b-bd1e-b7d1a179394d")}function f(){return a._SPKillSwitch.isActivated("4d893af7-e388-43d4-a7c4-c35ec085d048")}function p(){return a._SPKillSwitch.isActivated("3ef573b0-4474-49df-ba10-75a8e2d8d2ea")}function m(){return a._SPKillSwitch.isActivated("ead4a1a4-db2d-44db-a06c-636ab2573c3b")}function _(){return a._SPKillSwitch.isActivated("2a6c419f-5b7c-4951-812f-6f1c20a0af24")}function h(){return a._SPKillSwitch.isActivated("7c15fb8d-9c89-4c25-9b7f-99fdc265e525")}function b(){return a._SPKillSwitch.isActivated("0025eb47-9140-49b0-a8ff-d943e2affe02")}function g(){return a._SPKillSwitch.isActivated("cf269e9d-4014-4425-ad91-8d35510a7ad8")}function v(){return a._SPKillSwitch.isActivated("f2f0a4c8-1b5c-4e0d-8e2b-2b8f1e6a6b3f")}function y(){return a._SPKillSwitch.isActivated("b6a9b4e8-6c1f-4a5c-8e8a-4a5c9c6b8f0b")}function S(){return a._SPKillSwitch.isActivated("baaf43f7-7e95-49da-afc5-0452b090092b")}function D(){return a._SPKillSwitch.isActivated("30e39a60-ab3d-4b36-86fe-2236236280a5")}function I(){return a._SPKillSwitch.isActivated("2a455162-7081-4486-be91-f6d634746f07")}function x(){return a._SPKillSwitch.isActivated("f2522c3d-fb91-490a-ad3c-a677fd0e102c")}function C(){return a._SPKillSwitch.isActivated("61b745e8-6991-48c8-a1aa-7c4aa5b5c671")}function O(){return a._SPKillSwitch.isActivated("bce23e08-ff98-499e-8368-d7129562333e")}function w(){return a._SPKillSwitch.isActivated("4aa1fe31-09b5-421f-83c2-cf68f4aa3d4e")}function E(){return a._SPKillSwitch.isActivated("2c13258a-b9a6-4704-9781-6ccbc4a8d830")}function A(){return a._SPKillSwitch.isActivated("19ce8ff1-5759-4446-b9ca-d7520115befb")}function L(){return a._SPKillSwitch.isActivated("16bcf4aa-c041-45df-bf2d-79d8c4a7865b")}function k(){return a._SPKillSwitch.isActivated("68cff8e6-13b8-42a7-bf9a-268f0a84d583")}function M(){return a._SPKillSwitch.isActivated("94103cb6-cf98-428f-a07d-b9cb2b79b7f4")}function P(){return a._SPKillSwitch.isActivated("d5d40a10-05da-44a2-ac92-3b4bfdd21e9a")}function T(){return a._SPKillSwitch.isActivated("8b9c3f4b-0f5e-4f0f-8b9b-8b2d4b3b5b8d")}function U(){return a._SPKillSwitch.isActivated("56e64242-0685-4138-9b85-24eaaea00bf1")}function F(){return a._SPKillSwitch.isActivated("1807af39-03c6-457b-91d7-f4a2091887ae")}function H(){return a._SPKillSwitch.isActivated("d4b2b3a1-9b7f-4b6c-9d5f-7d9d0b7d4b9a")}function R(){return a._SPKillSwitch.isActivated("aed07695-c1a6-471b-9112-a1ce6c72ac83")}function N(){return a._SPKillSwitch.isActivated("f187865d-b06e-4011-9068-7856396343be")}function B(){return a._SPKillSwitch.isActivated("9731f6fc-43ad-45b4-b4ea-15635811e87c")}function j(){return a._SPKillSwitch.isActivated("757e6220-8354-49d2-979a-cd70080da6d9")}function V(){return a._SPKillSwitch.isActivated("37ad5b04-ed33-4af7-bc10-40def9ac492a")}function z(){return a._SPKillSwitch.isActivated("8a9077ea-1c03-4bf8-8b37-a47c9f63969f")}function G(){return a._SPKillSwitch.isActivated("f640fd76-4a11-48b9-ab80-b635844d734d")}function K(){return a._SPKillSwitch.isActivated("9b92e9c7-0692-4d93-9b45-89a205de68d7")}function W(){return a._SPKillSwitch.isActivated("5d484391-1267-4674-afee-62f401455f02")}function q(){return a._SPKillSwitch.isActivated("58adf7cd-e618-403b-8fb1-08b67c8895c9")}function Q(){return a._SPKillSwitch.isActivated("b5f8e3c7-7d5f-4c1d-8c9f-1b0b4e1f1b4b")}function Y(){return a._SPKillSwitch.isActivated("3cb041c8-c22e-437d-b41c-0f1c32f87768")}function J(){return a._SPKillSwitch.isActivated("f43814c7-b481-44cd-a345-79649d65ab89")}function X(){return a._SPKillSwitch.isActivated("e459ecce-a0e9-43a3-a1c6-2bd877544d85")}function Z(){return a._SPKillSwitch.isActivated("b2b0b3d0-0b9d-4e8c-8c5c-5b3e0e4d3b0b")}function $(){return a._SPKillSwitch.isActivated("3a491d32-0ba3-4fcf-b314-840b0c13f27a")}function ee(){return a._SPKillSwitch.isActivated("e4754acb-3c28-4a04-ab58-e62f50dffd52")}function te(){return a._SPKillSwitch.isActivated("96fd395b-ea33-4798-831b-33ce662b386a")}function ne(){return a._SPKillSwitch.isActivated("9732875d-e09a-497b-ba9b-ada8a9f46142")}function ae(){return a._SPKillSwitch.isActivated("d4a4e41c-a964-4f4f-8c5f-945bd3e7ee03")}function ie(){return a._SPKillSwitch.isActivated("1b40e7a4-fc42-4b94-9b3f-fcb27c3cb1c9")}function re(){return a._SPKillSwitch.isActivated("ffbeff84-c058-4293-80be-8d449362378e")}function oe(){return a._SPKillSwitch.isActivated("a525f948-87ff-4b8d-bd97-5502e6ac2327")}function se(){return a._SPKillSwitch.isActivated("71760115-5c0b-4915-9333-30c760d5f322")}function ce(){return a._SPKillSwitch.isActivated("6b3c97ae-c33a-4c1e-9b88-5dc1e87ab20f")}function de(){return a._SPKillSwitch.isActivated("d6a63398-2e24-4ce6-9f1d-6fa227fa9a86")}function le(){return a._SPKillSwitch.isActivated("c56cf367-42a8-4c6d-a354-9fe617d49268")}function ue(){return a._SPKillSwitch.isActivated("7e601a75-79b6-4241-a3f1-1c00be6bace8")}function fe(){return a._SPKillSwitch.isActivated("1b275e52-5fb3-48c9-aff5-7dbf9e50ffe1")}function pe(){return a._SPKillSwitch.isActivated("c98f0d8f-9ae3-4078-9cab-6df50f7d665b")}function me(){return a._SPKillSwitch.isActivated("040c9b96-ecf8-484a-abf4-d5813670b959")}function _e(){return a._SPKillSwitch.isActivated("769d92da-3e29-442b-b444-04bb6f71fe6c")}function he(){return a._SPKillSwitch.isActivated("a0c20c92-2be9-4707-b83b-af49a472e91e")}function be(){return a._SPKillSwitch.isActivated("d99f1b51-bd5a-4abe-91e2-5d617532228e")}function ge(){return a._SPKillSwitch.isActivated("e77acf71-a46f-4db3-b982-5e4c8f207ac4")}function ve(){return a._SPKillSwitch.isActivated("aed8b9b5-945b-40f3-92db-90d949177b79")}function ye(){return a._SPKillSwitch.isActivated("b0f1c2d3-4e5f-4a6b-8c9d-0e1f2a3b4c5d")}function Se(){return a._SPKillSwitch.isActivated("520416ce-d324-4256-b277-0d84f7dae7c4")}function De(){return a._SPKillSwitch.isActivated("2a792a79-0147-4449-ad22-119115cf959c")}function Ie(){return a._SPKillSwitch.isActivated("e0b98fec-337b-4fe1-8583-4086d6e8f241")}function xe(){return a._SPKillSwitch.isActivated("88eac2b2-a28f-44ba-b176-ed72beea98c7")}function Ce(){return a._SPKillSwitch.isActivated("3a53c779-bd5a-466d-9e5f-ccd28da76660")}function Oe(){return a._SPKillSwitch.isActivated("bfdea970-fe4d-4525-bb31-25e0e213fcbd")}function we(){return a._SPKillSwitch.isActivated("854ffee4-a85d-41f2-96bf-3454e716d6d4")}function Ee(){return a._SPKillSwitch.isActivated("32283626-0d70-481a-a8c3-cd062a8e9f25")}function Ae(){return a._SPKillSwitch.isActivated("a24b0003-00ce-49b1-8775-174a53375927")}function Le(){return a._SPKillSwitch.isActivated("bb04c2b1-ee82-43a1-9349-326be7c50708")}function ke(){return a._SPKillSwitch.isActivated("2ad7fb4e-04f2-402b-8176-22bc6ba62521")}function Me(){return a._SPKillSwitch.isActivated("c0fa4ca6-48cd-4bf3-a2c6-56c5e174ce1a")}function Pe(){return a._SPKillSwitch.isActivated("05fb07ee-c6cb-4493-b94f-9b3568753bb3")}function Te(){return a._SPKillSwitch.isActivated("456b2ca0-b100-4b45-97ec-20563d492a7c")}function Ue(){return a._SPKillSwitch.isActivated("c0fa4ca6-48cd-4bf3-a2c6-56c5e174ce1a")}function Fe(){return a._SPKillSwitch.isActivated("5c15a915-b8d7-4b47-9186-7937976803bd")}function He(){return a._SPKillSwitch.isActivated("6d97f671-3843-4285-88e2-0aee3ee9ef1d")}function Re(){return a._SPKillSwitch.isActivated("9a568a00-f2b4-43b2-bec8-fdee6826df94")}function Ne(){return a._SPKillSwitch.isActivated("415bcd40-eaae-4991-89c4-5574ec78c726")}function Be(){return a._SPKillSwitch.isActivated("4d798a38-361b-47d8-a364-e0dd31f433e0")}function je(){return a._SPKillSwitch.isActivated("a19bd14c-2bc6-4b72-892a-2cb0de233f16")}function Ve(){return a._SPKillSwitch.isActivated("93f3d8f1-75cc-4d66-81e4-60ae9efdbdeb")}}
,8976:(e,t,n)=>{"use strict";n.d(t,{k:()=>s});var a=n(9676),i=n(2207),r=n(718),o=n(3724);class s{get instanceId(){return"2eb4b1dc-ced3-4afe-bc87-e4060c7475d4"}get componentId(){return"47eb5490-fd78-4da8-8954-e95e03d64bed"}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0)}subscribe(e,t){this._pageService.then(n=>n.subscribe(this,e,t)).catch(e=>{i._TraceLogger.logError(i._LogSource.create("TitleRegion"),e,"SubscribePageService")})}unsubscribe(e,t){this._pageService.then(n=>n.unsubscribe(this,e,t)).catch(e=>{i._TraceLogger.logError(i._LogSource.create("TitleRegion"),e,"UnsubscribePageService")})}getPagePublishInfo(){return this._pageService.then(e=>e.getPagePublishInfo())}getCurrentItem(){return this._pageService.then(e=>e.getCurrentItem())}getPageHTMLContentInfo(){return this._pageService.then(e=>e.getPageHTMLContentInfo())}getPageMultilingualInfo(){return this._pageService.then(e=>e.getPageMultilingualInfo())}constructor(e){this._isDisposed=!1;const t=(0,o.Lg)()?new Promise(e=>{e()}):new Promise(e=>{setTimeout(()=>{e()},4e3)});this._pageService=t.then(()=>e.consume((0,r.getPageServiceServiceKey)()))}}s.serviceKey=a.ServiceKey.create("TitleRegion",s)}
,647:(e,t,n)=>{"use strict";n.d(t,{f:()=>a,q:()=>i});const a={None:0,SharePointURI:2,Default:4},i={Left:"Left",Center:"Center"}}
,7179:(e,t,n)=>{"use strict";n.d(t,{q8:()=>R,v1:()=>B,eQ:()=>N});var a=n(8810),i=n(2141),r=n(5618),o=n(718),s=n(5959),c=n(3436),d=n(647),l=n(6575),u=n(4314),f=n(3338),p=n(5592),m=n(9676),_=n(2207);n(8424).loadStyles(".l_oIYYJ_Wr9CO{cursor:pointer}.l_oIYYJ_Wr9CO:hover{outline:none}",!0);const h=JSON.parse('{"hT":"Opens Profile Card for {0}","dR":"Opens Profile Card","_Q":"Getting details…"}');class b{static isTenantAdminLightDarkThemeFlightEnabled(){return m._SPFlight.isEnabled(1723)}}var g=n(1491);class v{getLPCLoader(){return Promise.all([n.e(514),n.e(863)]).then(n.bind(n,8368)).then(e=>e.default)}}(0,p._ts_decorate)([(0,o.monitor)("LivePersonaCard.Load")],v.prototype,"getLPCLoader",null);const y=new v,S="Mouse";class D extends s.PureComponent{static _isLivePersonaCardFlightEnabled(){return m._SPFlight.isEnabled(809)}static get livePersonaCardHoverTarget(){return window.LivePersonaCardHoverTargetV2}componentWillUnmount(){this._isUnMounted=!0}render(){if(this.props.disabled)return s.Children.only(this.props.children);if(b.isTenantAdminLightDarkThemeFlightEnabled()&&this._theme&&window.LPC?.loadTheme(this._theme),m._BrowserUtilities.isMobileWebView())return s.cloneElement(s.Children.only(this.props.children),{role:"button","data-sp-action":JSON.stringify({key:"viewUserProfileDetails",args:{upn:this.props.legacyUpn,...m._BrowserUtilities.isTeamsVivaMobile()&&{displayName:this.props.displayName}}}),onClick:()=>{}});const e=this.props.useSpan?"span":"div",t=this.props.disableClick?void 0:e=>this._triggerBootstrap(e,S),n=this.props.disableHover?void 0:e=>this._triggerBootstrap(e,S),a=this.props.disableHover?void 0:()=>{this.setState({shouldOpenLpcAfterBundleLoaded:!1})};return s.createElement(e,{className:(0,i.css)(this.props.className,"l_oIYYJ_Wr9CO"),onClickCapture:t,onKeyDownCapture:this._triggerBootstrapByKeyboard,onMouseOver:n,onMouseLeave:a,ref:this._ref},this._renderContent())}_renderContent(){const e={cardParameters:{personaInfo:{identifiers:{PersonaType:this._personaType,Smtp:this.props.legacyUpn||this.props.email,Upn:this.props.legacyUpn||this.props.upn,TopicId:this.props.topicCardProps?.topicId,...this.props.hostAppPersonaInfo&&{LocationId:this.props.hostAppPersonaInfo.LocationId,OlsPersonaId:this.props.hostAppPersonaInfo.OlsPersonaId,AadObjectId:this.props.hostAppPersonaInfo.PersonaAadObjectId,DisplayName:this.props.hostAppPersonaInfo.PersonaDisplayName}},topicMetadata:this.props.topicCardProps?.topicCardMetadata,displayName:this.props.displayName,personaCoinColor:(0,i.getPersonaInitialsColor)({text:this.props.displayName})},externalAppSessionCorrelationId:this.props.externalAppSessionCorrelationId,behavior:{onCardOpen:this._handleCardOpen,onCardClose:this.props.onCardClose,disableHover:this.props.disableHover,disableClick:this.props.disableClick,cardPlacementMode:this.props.cardPlacementMode,...this.props.locationToOpen&&{locationToOpen:this.props.locationToOpen}},ariaLabel:this.props.ariaLabel,...!(0,g.jF)()&&{disableAccessibilityDefaults:this.props.disableAccessibilityDefaults}},tabIndex:this.props.tabIndex},t=Boolean(this.props.legacyUpn||this.props.topicCardProps?.topicId||this.props.upn||this.props.email);return t&&this._isLPCBundleLoaded()?s.createElement(D.livePersonaCardHoverTarget,{...e,onCardOpen:this._handleCardOpen},s.Children.only(this.props.children)):!t||this._isLPCBundleLoaded()||!(0,g.jF)()&&this.props.disableAccessibilityDefaults?s.Children.only(this.props.children):s.cloneElement(s.Children.only(this.props.children),{tabIndex:0,"data-is-focusable":!0,role:"button","aria-label":this.props.ariaLabel||(this.props.displayName?m.Text.format(h.hT,this.props.displayName):h.dR),"aria-haspopup":"dialog"})}_isLPCBundleLoaded(){return this.state.isBundleLoaded&&!!D.livePersonaCardHoverTarget}get _logScenario(){return this.props.clientScenario||"unset"}_updateBundleMountedState(e){this.setState({isBundleLoaded:!0},()=>this._manuallyDispatchEventToTriggerCallout(e))}get _clientType(){return this.props.clientType||"SPPeopleWebPart"}get _theme(){return this.props.m365Theme}get _personaType(){return this.props.hostAppPersonaInfo&&this.props.hostAppPersonaInfo.PersonaType||"User"}constructor(e){super(e),this._isUnMounted=!1,this.openCard=e=>{this._triggerBootstrap(e,S),this._isLPCBundleLoaded()&&this._manuallyDispatchEventToTriggerCallout((0,f.xT)())},this._bootstrapLivePersonaCard=e=>!D._isLivePersonaCardFlightEnabled()||m._BrowserUtilities.isMobileWebView()?Promise.resolve():D.livePersonaCardHoverTarget?(this._updateBundleMountedState(e?.nativeEvent),Promise.resolve()):(this._loadPromise||(this._loadPromise=this._bootstrapCore(e?.nativeEvent)),this._loadPromise),this._bootstrapCore=e=>(_._TraceLogger.logVerbose(this._logSource,"LivePersonaCard._bootstrapCore"),y.getLPCLoader().then(e=>e.bootstrap(this.props.serviceScope,this._clientType,this._personaType,this.props.clientScenario,this.props.topicCardProps,...b.isTenantAdminLightDarkThemeFlightEnabled()&&this._theme?[this._theme]:[],...!(0,g.Yg)()&&this.props.getLokiAuthToken?[this.props.getLokiAuthToken]:[])).then(()=>{this._isUnMounted||this._updateBundleMountedState(e)}).catch(e=>{_._TraceLogger.logError(this._logSource,e,"BootstrapLivePersonaCard")})),this._manuallyDispatchEventToTriggerCallout=e=>{if(!(0,g.Up)()&&this.props.openCardBySpaceKeyOnly&&this._ref.current)return(0,i.getFirstTabbable)(this._ref.current,this._ref.current,!0)?.focus(),void this._ref.current.firstElementChild?.dispatchEvent((0,f.xT)());"keydown"===e?.type&&this._ref.current&&((0,i.getFirstTabbable)(this._ref.current,this._ref.current,!0)?.focus(),this._ref.current.firstElementChild?.dispatchEvent((0,f.HB)())),"mouseover"===e?.type&&this._ref.current&&this.state.shouldOpenLpcAfterBundleLoaded&&!this.props.disableHover&&this._ref.current.firstElementChild?.dispatchEvent((0,f.xT)()),"click"===e?.type&&this._ref.current&&this.state.shouldOpenLpcAfterBundleLoaded&&!this.props.disableClick&&this._ref.current.firstElementChild?.dispatchEvent((0,f.s_)())},this._triggerBootstrap=(e,t)=>{_._EngagementLogger.logEventWithLogEntry(new _._LogEntry("LivePersonaCard",`${this._logScenario}.Trigger`,_._LogType.Event,{hasUPN:Boolean(this.props.legacyUpn||this.props.upn).toString(),source:t,isBundleLoaded:this.state.isBundleLoaded.toString()})),this._isLPCBundleLoaded()||(this.setState({shouldOpenLpcAfterBundleLoaded:!0}),this._bootstrapLivePersonaCard(e).catch(this._traceBootstrapFailure))},this._triggerBootstrapByKeyboard=e=>{"Enter"===e.key&&(this._triggerBootstrap(e,"Keyboard"),this._isLPCBundleLoaded()||((0,g.XA)()?o.ScreenReaderAlert.read(h._Q):r.QC.read(h._Q)))},this._handleCardOpen=()=>{_._EngagementLogger.logEvent(`LivePersonaCard.${this._logScenario}`,"Open");const{onCardOpen:e}=this.props;e&&e()},this._traceBootstrapFailure=e=>{_._TraceLogger.logError(this._logSource,e,"LivePersonaCard.bootstrap")},this._logSource=_._LogSource.create("LivePersonaCard"),this._ref=s.createRef(),this.state={isBundleLoaded:!1,shouldOpenLpcAfterBundleLoaded:!1}}}var I=n(9930),x=n(8391),C=n(8579),O=n(2330),w=n(9282);const E={className:C.A.personaCoin},A=e=>(0,w.I)()?(0,i.mergeStyleSets)({card:{"&.editMode:hover, &:focus":{backgroundColor:e.palette?.neutralLighterAlt,boderColor:e.palette?.neutralTertiaryAlt,".peopleName":{color:e.palette?.neutralPrimary},".peopleRole":{color:e.palette?.neutralSecondary}}},primaryText:{color:e.palette?.neutralPrimary},secondaryText:{color:e.palette?.neutralSecondary},deleteButton:{color:e.palette?.black}}):{primaryText:void 0,secondaryText:void 0,card:void 0,deleteButton:void 0},L=(0,i.mergeStyleSets)({peopleName:{"&.peopleName":{...I.typographyStyles.custom.body1Strong}},peopleRole:{"&.peopleRole":{...I.typographyStyles.custom.caption1Strong}}});class k extends s.Component{componentDidMount(){this._loadUserPhoto()}componentDidUpdate(e){(0,x.Kz)()||e.imageUrl===this.props.imageUrl||this._loadUserPhoto()}render(){const{text:e,size:t}=this.props,n=this.state.imageUrl?{imageUrl:this.state.imageUrl}:{};return s.createElement(i.PersonaCoin,{coinProps:E,imageShouldStartVisible:!0,size:t,text:e,...n})}_loadUserPhoto(){const e=new Image;e.src=this.props.imageUrl||"",e.onload=()=>{this.setState({imageUrl:e.src})}}constructor(e){super(e),this.state={imageUrl:void 0}}}class M extends s.PureComponent{componentDidMount(){this._removePersonaTabIndex()}componentDidUpdate(){this._removePersonaTabIndex()}render(){const e=a.StringHelper.format(O.kJ,this.props.person.name,this.props.person.role,O.J6,this.props.isEditMode?a.StringHelper.format(O.Uk,this.props.person.name,this.props.person.role):""),t=A(this.props.variantTheme||(0,i.getTheme)()),n=(0,i.css)(C.A.card,!(0,w.I)()&&C.A.cardWithPageColor,this.props.isEditMode&&C.A.editMode,(0,w.I)()&&this.props.isEditMode&&"editMode",this.props.alignment===d.q.Center&&C.A.center,C.A.cardFocusIndicatorImprovedContrastRatio,t.card);return s.createElement("div",{className:n,ref:this._cardRef,tabIndex:0,"aria-label":e,...!(0,x.Hc)()&&{role:"button"},onKeyDown:this._handleKeyDown,"data-sp-a11y-skipkeys":"13","data-alignment":this.props.alignment.toString()},this._renderPeoplePersona(),this.props.isEditMode&&this._renderButtons())}focus(){setTimeout(()=>{this._cardRef.current&&this._cardRef.current.focus()})}_renderButtons(){const e=A(this.props.variantTheme||(0,i.getTheme)());return s.createElement("div",{className:(0,i.css)(C.A.buttons,!(0,w.I)()&&C.A.buttonsWithPageColor)},s.createElement(l.IconButton,{iconProps:{iconName:"Cancel"},className:(0,i.css)(C.A.deleteButton,C.A.holdSpace,e.deleteButton),title:O.ui,onClick:this._handleDeletePerson,"aria-hidden":!0,"data-automation-id":"deleteAuthor",tabIndex:(0,x.mQ)()?void 0:-1}))}_renderPeoplePersona(){const{person:e,serviceScope:t,personaSize:n,alignment:a,showUserPhoto:r,personaDetailsClassName:o}=this.props,{email:c,name:l,role:u}=e,f=this._getImageUrl(e),p=!!r&&a===d.q.Left&&s.createElement(k,{size:n,text:l,imageUrl:f}),m=A(this.props.variantTheme||(0,i.getTheme)()),_=s.createElement("div",{className:C.A.persona,ref:this._personaRef},p,s.createElement("div",{className:(0,i.css)(C.A.personaDetails,o),"data-automation-id":"personaDetails"},s.createElement("div",{className:(0,i.css)(C.A.primaryText,(0,w.I)()?"":C.A.primaryTextStyle,this.props.authorClassNames?.authorName,L.peopleName,"peopleName",m.primaryText),title:l},l),s.createElement("div",{className:(0,i.css)(C.A.secondaryText,(0,w.I)()?"":C.A.secondaryTextStyle,this.props.authorClassNames?.authorJobTitle,L.peopleRole,"peopleRole",m.secondaryText),title:u},u||"​")));return s.createElement(D,{clientScenario:"TitleRegionWebPart",hostAppPersonaInfo:{PersonaType:"User"},displayName:l,serviceScope:t,legacyUpn:c,className:C.A.persona,onCardClose:this._handleCardClose},_)}_getImageUrl(e){const t=e.email||e.id;return t?(0,u.p)(t.toLowerCase(),a.SPAlternativeUrls.UserPhotoSize.Medium):""}_removePersonaTabIndex(){this._personaRef.current&&this._personaRef.current.setAttribute("tabindex","-1")}constructor(e){super(e),this._cardRef=s.createRef(),this._personaRef=s.createRef(),this._handleKeyDown=e=>{e.stopPropagation(),this._personaRef.current&&this._personaRef.current===e.target||(e.which!==i.KeyCodes.enter&&e.which!==i.KeyCodes.space||!this._personaRef.current||this._personaRef.current?.dispatchEvent((0,f.HB)()),e.which===i.KeyCodes.del&&this.props.isEditMode&&this.props.onDeletePerson(1))},this._handleDeletePerson=()=>{this.props.onDeletePerson(0)},this._handleCardClose=()=>{this.focus()}}}var P=n(2363),T=n(2325),U=n(1753),F=n(6065),H=n(8101);function R(e){const t=e.authorByline[0],n=s.useRef(!1),l=e.selectedPersons.find(e=>e.id===t||e.email===t||e.upn===t)?.email,u=(0,U.M)(e.serviceScope,(0,x.Ty)()?t:l||t),{completeComponentRender:f}=s.useContext(H.m),p=u||(e.selectedPersons[0]?{...e.selectedPersons[0],role:""}:e.selectedPersons[0]),m=s.useRef(!1),_=s.useRef(null),h=s.useRef(null);function b(t){e.onChangeSelectedPersons([t]),(0,U.I)(e.serviceScope).then(e=>e.cache(t)),m.current=!0}s.useEffect(()=>{(0,x.rT)()||(u&&f&&!n.current?requestAnimationFrame(()=>{requestAnimationFrame(()=>{f("AuthorByLine"),n.current=!0})}):t||f?.("AuthorByLine"))},[u,f,t]),s.useEffect(()=>{m.current&&(h.current?h.current.focus():_.current&&_.current.focus(),m.current=!1)});const g=(0,i.css)(e.className,P.A.authorByline,e.alignment===d.q.Left&&P.A.leftAlign,e.alignment===d.q.Center&&P.A.centerAlign,!(0,x.V6)()&&e.isEditMode&&P.A.fixedHeight),v=p?s.createElement(M,{isEditMode:e.isEditMode,serviceScope:e.serviceScope,person:p,personaSize:i.PersonaSize.size28,ref:_,alignment:e.alignment,onDeletePerson:function(t){p&&((0,F.XA)()?o.ScreenReaderAlert.read(a.StringHelper.format(T.B,p.name),o.ReadingMode.ReadImmediately):r.QC.read(a.StringHelper.format(T.B,p.name),r.QY.ReadImmediately)),e.onChangeSelectedPersons([]),1===t&&(m.current=!0)},authorClassNames:e.authorClassNames,showUserPhoto:e.showUserPhoto??!0,personaDetailsClassName:e.personaDetailsClassName,variantTheme:e.variantTheme}):t?s.createElement("div",{style:{height:42}}):s.createElement(c.d,{editMode:e.isEditMode,renderEditMode:function(t){return s.createElement(t.PeopleCardPlaceholder,{onAddPerson:b,personaSize:i.PersonaSize.size28,serviceScope:e.serviceScope,ref:e=>h.current=e,hidePersonaCoin:!e.showUserPhoto})}});return s.createElement("div",{className:g,"data-automation-id":"authorByLine","data-alignment":e.alignment.toString()},v)}const N=C.A.whiteText,B=C.A.themedWhiteText}
,8962:(e,t,n)=>{"use strict";n.d(t,{V:()=>a.q8});var a=n(7179)}
,1753:(e,t,n)=>{"use strict";n.d(t,{I:()=>c,M:()=>s});var a=n(5959),i=n.n(a),r=n(2207),o=n(8391);function s(e,t){let n;const[a,s]=function(e){const[t,n]=i().useState(void 0),a=i().useRef(0);return i().useEffect(()=>()=>{a.current++},[]),[t,async function(e){const t=++a.current,i=await e;t===a.current&&n(i)}]}(),d=window._AuthorByline;if(d){const e=d.split(/[;,]#/);window._AuthorByline=void 0,e&&e.length>=9&&((0,o.YJ)()||e[2]&&e[3]&&e[1]&&e[8])&&(n={id:e[2],email:e[3],name:e[1],role:e[8],upn:""})}return i().useEffect(()=>{n?s(Promise.resolve(n)):n||s(t?c(e).then(e=>e.getPeopleInfo(t)):Promise.resolve(void 0)).catch(e=>r._TraceLogger.logError(r._LogSource.create("TitleRegion"),e,"setAuthorByline"))},[t]),a}function c(e){return n.e(410).then(n.bind(n,9165)).then(t=>e.consume(t.AuthorBylineDataProvider.serviceKey))}}
,2566:(e,t,n)=>{"use strict";n.d(t,{o:()=>Oa,y:()=>x.y});var a,i,r,o,s,c=n(5959),d=n(2207),l=n(2141),u=n(718),f=n(9676),p="fill",m="top",_="bottom",h=n(8417),b=n(845),g=n(3525),v=n(1027);!function(e){e.LoopingVideos="32318599-a475-448c-a583-7aadf5e41c8c",e.Icons="f9a6197b-243d-4381-ad7d-43250cb11014",e.Illustrations="5c594da3-1700-4c4e-824b-dbefe528f53b",e.CartoonPeople="71309e27-d6ab-4fa5-865c-60d4e6d863b3",e.Images="f8218404-63dd-4670-b0f5-f8b50674f963",e.AiGeneratedImages="60f8b9be-536b-4a0f-9552-f3321c243f86",e.CutoutPeople="42fea961-805e-4900-a0f5-7288c55d7780",e.Stickers="0678df82-d05e-475d-9c04-5daa1f5c6d55",e.Annotations="0b60f44c-a895-4414-ab8f-6f62b5de973c",e.Shapes="9409ec95-a250-402e-8609-319208802c02",e.Emojis="84e04d41-3574-4764-a2d3-c24ae80c75eb",e.Audios="72b42841-c22c-44fd-9ac3-964371503269",e.SFX="dbddd5cf-9502-42f3-bee8-9ad41a2b6ff8",e.Overlays="c4d5cd5-eaf3-47da-8b3c-0a6bced0fe71",e.Filters="9e3db81f-2412-4606-88a7-18902fae34a6",e.Transitions="0629c8e7-8f4c-4138-bf04-816285391431",e.ClipchampIcons="01234567-89ab-cdef-0123-456789abcdef",e.Backgrounds="12345678-90ab-cdef-1234-567890abcdef",e.ClipchampStickers="f3e2d1c0-b9a8-7654-3210-fedcba987654",e.ClipchampAnnotations="456789ab-cdef-0123-4567-89abcdef0123",e.ClipchampShapes="98765432-10fe-dcba-9876-543210fedcba",e.Frames="0fedcba9-8765-4321-0abc-def123456789"}(a||(a={})),function(e){e.Icon="Icon",e.Logo="Logo",e.Image="Image",e.Video="Video",e.Audio="Audio",e.Collection="Collection",e.PowerpointTemplate="PowerpointTemplate",e.WordTemplate="WordTemplate",e.ClipchampTemplate="ClipchampTemplate",e.PromptTemplate="PromptTemplate",e.Folder="Folder"}(i||(i={})),function(e){e.My="My",e.Stock="Stock",e.Enterprise="Enterprise",e.External="External",e.Clipchamp="Clipchamp",e.Brand="Brand",e.Cit="Cit"}(r||(r={})),(s=o||(o={})).Bing="Bing",s.Getty="Getty",s.GettyVideo="GettyVideo",s.Giphy="Giphy",s.GooglePhotos="GooglePhotos",s.Hubble="Hubble",s.OneDrivePhotos="OneDrivePhotos",s.Shutterstock="Shutterstock",s.StockImages="StockImagesSearch",s.Storyblocks="Storyblocks",s.TAS="TAS",s.TasFirstPartyImageSearch="TasFirstPartyImageSearch",s.Tenor="Tenor",s.Cit="Cit",s.UserContentSearch="UserContentSearch",s.Unknown="Unknown",s.BrandKit="BrandKit",s.OAL="OAL",s.Templafy="Templafy",s.AdobeExpManager="AdobeExpManager",s.OAL_Templafy_AEM="OAL_Templafy_AEM",s.All="All";var y=n(2616),S=n(6277),D=n(2737);d._LogSource.create("SPPagesGettyTrackingEventManager");var I=n(3552),x=n(6625),C=n(8424);function O(){return!f._SPKillSwitch.isActivated("7e601a75-79b6-4241-a3f1-1c00be6bace8")&&(f._SPFlight.isEnabled(62395)||1===f._SPExperiment.getVariantAndLogExposure(90359))}function w(){return!f._SPKillSwitch.isActivated("c0fa4ca6-48cd-4bf3-a2c6-56c5e174ce1a")&&!f._SPKillSwitch.isActivated("bfdea970-fe4d-4525-bb31-25e0e213fcbd")&&f._SPFlight.isEnabled(62700)}C.loadStyles(".p_i6ys__Wr9CO{overflow:hidden}.b_qT3dZ_Wr9CO{background-repeat:no-repeat;background-size:cover}.b_qT3dZ_Wr9CO.p_keO4w_Wr9CO{position:relative}",!0);const E="100%",A="auto";class L extends c.PureComponent{static convertFocalPointToCropMode(e,t,n){if(f._SPKillSwitch.isActivated("bf6b97e7-7da8-4c62-bd34-294c4216c2e9"))return void 0===e?p:0===Math.floor(e.y)?m:100===Math.floor(e.y)?_:50===Math.floor(e.y)?p:void 0;if(void 0===e)return n&&t&&n<t?p:void 0;switch(Math.floor(e.y)){case 0:return m;case 100:return _;case 50:return p;default:return}}UNSAFE_componentWillReceiveProps(e){this.props.focalPoint!==e.focalPoint&&(this.setState({focalPoint:e.focalPoint}),this._setCropMode(e.focalPoint,e.requestedHeight,e.imgHeight))}render(){const e=w(),t=this._imagePosition;let n={},a={...t};if(!e){switch(this._cropMode){case _:a=this._isTallImage?{left:0,top:this._actualHeight}:{left:t.left,top:0};break;case m:a=this._isTallImage?{left:0,top:0}:{left:t.left,top:0};break;case p:a=this._isTallImage?{left:0,top:this._actualHeight/2}:{left:this._actualWidth/2,top:0}}n=this.props.fullSizeImageURL&&(this.props.editMode||this.props.useFullSizeImageURL)?{left:`-${t.left}px`,top:`-${t.top}px`}:{left:`-${a.left}px`,top:`-${a.top}px`}}const i=void 0!==window&&window.innerWidth<640;let r={},o={};e&&(r=this._getBackgroundImageCoverStyling(!this.props.isAdvancedEditScalingEnabled),this.props.isAdvancedEditScalingEnabled&&(o=this._getBackgroundImageContainStyling(),r.filter="blur(8px)",o.boxShadow=I.f.depth64));const s={};e&&this.props.isAdvancedEditScalingEnabled&&i&&(s.height=(this._containerHeight+this._actualHeight||0)+"px",o={left:"0",top:"0",width:E,height:A});let d=!1,u=!1;return e&&(this.props.isAdvancedEditScalingEnabled&&!i&&(d=this._getImageWithPreAllocate(r)),u=this.props.isAdvancedEditScalingEnabled?this._getImageWithPreAllocate(o):this._getImageWithPreAllocate(r)),c.createElement("div",{className:(0,l.css)("p_i6ys__Wr9CO",this.props.className),style:{...this.props.style,...s}},d,c.createElement("div",{className:(0,l.css)(this.props.className),role:"presentation","data-automation-id":this.props.image.type===x.y.LocalImage||this.props.image.type===x.y.ExternalImage?"localFilePreview":"titleRegionBackgroundImage"},e?u:this._getImageWithPreAllocate(n),this.props.renderEditModeElements&&this.props.renderEditModeElements()))}_setCropMode(e,t,n){this._cropMode=L.convertFocalPointToCropMode(e||this.state.focalPoint,t,n)}get _imagePosition(){const{x:e,y:t}=(0,h.c)(this.state.focalPoint);return{left:this._isTallImage?0:e/100*this._actualWidth,top:this._isTallImage?t/100*this._actualHeight:0}}get _isTallImage(){return!(!this.props.width||!this.props.requestedHeight)&&this.state.imageWidth/this.props.width<this.state.imageHeight/this.props.requestedHeight}get _actualWidth(){return this.state.imageHeight?this.state.imageWidth*(this._containerHeight/this.state.imageHeight)-(this.props.width||0):0}get _actualHeight(){return this.state.imageWidth?this.state.imageHeight*((this.props.width||0)/this.state.imageWidth)-this._containerHeight:0}get _containerHeight(){return this.props.requestedHeight||0}get _isCropModeEnabled(){const{imgWidth:e,imgHeight:t}=this.props;return!(e&&t&&(t<600||e<1601||e/t>2.6))&&void 0!==this._cropMode}_calculateImagePosition(e){const t=this._isTallImage;switch(e){case"center":return t?{left:0,top:this._actualHeight/2}:{left:this._actualWidth/2,top:0};case"focalPoint":return this._getFocalPointPosition()}}_getFocalPointPosition(){const e=this._imagePosition,t=this._isTallImage;switch(this._cropMode){case _:return t?{left:0,top:this._actualHeight}:{left:e.left,top:0};case m:return t?{left:0,top:0}:{left:e.left,top:0};case p:return t?{left:0,top:this._actualHeight/2}:{left:this._actualWidth/2,top:0};default:return e}}_calculateImageDimensions(e){if(!this.state.imageWidth||!this.state.imageHeight){if(this.props.imgWidth&&this.props.imgHeight){const e=(this.props.width||0)/this._containerHeight;return this.props.imgWidth/this.props.imgHeight<e?{width:E,height:A}:{width:A,height:E}}return{width:A,height:A}}const t=this._isTallImage;if("contain"===e)return t?{width:E,height:A}:{width:A,height:E};if(t)return{width:E,height:this._actualHeight+this._containerHeight};{const e=this._containerHeight>=228?E:this._containerHeight;return{width:this._actualWidth+(this.props.width||0),height:e}}}_shouldUseFullSizePosition(e){return e&&!!this.props.fullSizeImageURL&&!(!this.props.editMode&&!this.props.useFullSizeImageURL)}_getBackgroundImageContainStyling(){const e=this._actualHeight<0?{left:0,top:Math.abs(this._actualHeight)/2}:{left:Math.abs(this._actualWidth)/2,top:0},t={left:`${e.left}px`,top:`${e.top}px`};return this.state.imageWidth&&this.state.imageHeight&&(t.width=this._actualHeight<0?E:A,t.height=this._actualHeight<0?A:E),t}_getBackgroundImageCoverStyling(e){const t=e?"focalPoint":"center",n=this._calculateImagePosition(t),a=this._calculateImageDimensions("cover"),i=this._shouldUseFullSizePosition(!!e)?this._imagePosition:n;return{left:`-${i.left}px`,top:`-${i.top}px`,...a}}constructor(e){super(e),this._getImageWithPreAllocate=e=>{const t=w();!t&&this.state.imageWidth&&this.state.imageHeight&&(this._isTallImage?(e.width=E,e.height=this._actualHeight+this._containerHeight):(this._containerHeight>=228?e.height=E:e.height=this._containerHeight,e.width=this._actualWidth+(this.props.width||0))),!t||this.state.imageWidth||this.state.imageHeight||(e.visibility="hidden"),e.position="absolute",e.backgroundImage=void 0;const n=this.props.image.type===x.y.ExternalImage&&f._SPKillSwitch.isActivated("1675210f-385b-4e20-9be6-e45cd577c771")?function(e){if(function(e){return!(0,v.Je)()&&(0,y.S0)()&&function(e){return e===o.Getty}(e)}(e))return{pointerEvents:"none"}}(this.props.image.contentProvider):void 0,a=this.props.image,i={...a,imageUrl:a.source,siteId:a.siteId?.toString(),webId:a.webId?.toString(),listId:a.listId?.toString(),uniqueId:a.uniqueId?.toString(),cropMode:this._isCropModeEnabled?this._cropMode:void 0,encodedImage:this.props.encodedImage};if(n&&(e={...e,...n},d._TraceLogger.logVerbose(L._logSource,"Disable image context menu for Getty")),!O()&&this.props.fullSizeImageURL&&(this.props.editMode||this.props.useFullSizeImageURL))return this._renderImageWithPreAllocate(i,this.props.fullSizeImageURL,e);if(this.props.image.type===x.y.DefaultImage)return this._layoutProvidesDefaultImage()?this._renderImageWithPreAllocate(i,this.props.imageURL,{...e,height:this.props.requestedHeight,top:void 0}):this._renderImageWithPreAllocate(i,"Dark"===this.props.image.theme?b:g,e);{const t={...this.props,src:O()&&this.props.fullSizeImageURL&&(this.props.editMode||this.props.useFullSizeImageURL)?this.props.fullSizeImageURL:void 0,serviceScope:this.props.serviceScope,imageData:i,thumbnailWidth:this.props.width,thumbnailHeight:this._isCropModeEnabled?this.props.requestedHeight:void 0,callerId:this.props.callerId??"TitleRegionBackgroundImage",alt:this.props.isDecorative?"":this.props.altText,role:this.props.isDecorative?void 0:"img",style:e,onImageLoad:this._handleImageLoad,onImageLoadFailure:this._handleImageError,getDefaultImage:this.props.getDefaultImage,displayMode:this.props.editMode?f.DisplayMode.Edit:f.DisplayMode.Read};return t["data-sp-originalimgsrc"]=i.imageUrl,this.props.renderImageWithFallback(t)}},this._renderImageWithPreAllocate=(e,t,n)=>{const a={src:t,imageData:e,serviceScope:this.props.serviceScope,alt:this.props.isDecorative?"":this.props.altText,role:this.props.isDecorative?void 0:"img",callerId:this.props.callerId??"TitleRegionBackgroundImage",style:n,onLoad:this._handleImageLoad,onError:this._handleImageError,getDefaultImage:this.props.getDefaultImage,displayMode:this.props.editMode?f.DisplayMode.Edit:f.DisplayMode.Read};return a["data-sp-originalimgsrc"]=e.imageUrl,this.props.renderImageWithoutFallback(a)},this._handleImageLoad=e=>{e?.currentTarget&&(this.setState({imageWidth:e.currentTarget.naturalWidth,imageHeight:e.currentTarget.naturalHeight}),this.props.onImageLoad&&this.props.onImageLoad(e)),this.props.onCompleteFirstRender()},this._handleImageError=()=>{this.props.onCompleteFirstRender()},this._layoutProvidesDefaultImage=()=>("VivaHomeHero"===this.props.layoutType||"TopicPage"===this.props.layoutType)&&!!this.props.imageURL,this.state={focalPoint:e.focalPoint,imageWidth:0,imageHeight:0},this._setCropMode(e.focalPoint,e.requestedHeight,e.imgHeight)}}L.defaultImageLight=g,L.defaultImageDark=b,L._logSource=d._LogSource.create("TitleImage");var k=n(5592),M=n(4949),P=n(7408),T=n(5519);function U(e){return e instanceof Error?e:new Error(e)}class F{get tagNameSuffix(){return this._tagNameSuffix}get innerError(){return this._innerError}get extraData(){return this._extraData}constructor(e,t,n){this._tagNameSuffix=e,this._innerError=U(t),this._extraData=n}}class H{get tagNameSuffix(){return this._tagNameSuffix}get innerError(){return this._innerError}get extraData(){return this._extraData}constructor(e,t,n){this._tagNameSuffix=e,this._innerError=U(t),this._extraData=n}}function R(e,t=!1,n=!1){return(a,i,r)=>{if(r.value){const a=r.value;r.value=function(...i){const r=new T._QosMonitor(e,t,n);return a.apply(this,i).then(e=>(r.writeSuccess(),e),e=>{throw e instanceof H?(r.writeExpectedFailure(e.tagNameSuffix,e.innerError,e.extraData),e.innerError):e instanceof F?(r.writeUnexpectedFailure(e.tagNameSuffix,e.innerError,e.extraData),e.innerError):(r.writeUnexpectedFailure("UnexpectedFailure",e),e)})}}}}const N=n.p+"defaultImage1_b7b388ca450857ddfe48.jpg",B=n.p+"defaultImage2_42d87066961518ad3b67.jpg",j=n.p+"defaultImage3_3b7d507e45e231c8e3a9.jpg",V=n.p+"defaultImage4_3ff7ce14cb2b0da6542a.jpg",z=n.p+"defaultImage5_9dd15aafdbffc7a71ada.jpg",G=n.p+"portfolioDefaultImage1_7a11a3275b7b32c6ebf0.png",K=n.p+"portfolioDefaultImage2_41baeb4210b0ec212d24.png",W=n.p+"portfolioDefaultImage3_d01ceb8afea856c0e536.png",q=n.p+"reportDefaultImage1_f9ac3b081e4592450b83.png",Q=n.p+"reportDefaultImage2_4beda8fb670d1c199caf.png",Y=n.p+"reportDefaultImage3_9b4e2e85e5a9f618d517.png",J=n.p+"reportDefaultImage4_8a56d31bc8944f13453e.png",X=n.p+"reportDefaultImage5_b80b8dda0d21eaf42b23.png",Z=n.p+"odm_newsCarousel1_3bd855d4.png",$=n.p+"odm_newsCarousel2_bc836e21.png",ee=n.p+"odm_newsCarousel3_4769eaf8.png",te=n.p+"portfolioImageGalleryChairs_80c8b2997da260f2f9a0.png",ne=n.p+"portfolioImageGalleryCushions_c73a8051c575597d3b0e.png",ae=n.p+"portfolioImageGalleryHandrail_171a9b3df2fe5f95bee2.png",ie=n.p+"portfolioImageGalleryLamps_09fea03cdde4b96c1f65.png",re=n.p+"portfolioImageGalleryLounge_b91f8f19cb3cc7366f71.png",oe=n.p+"portfolioImageGalleryPendant_7fb5a00427578890d0fb.png",se=n.p+"portfolioImageGalleryWall_eb6fcb7aea6e54178274.png",ce=n.p+"portfolioImageGalleryWood_8f984fa4c9e609ae0415.png",de=n.p+"odm_visualTemplateTitleImage_135eb73f.jpg",le=n.p+"odm_visualTemplateImage1_1eaee901.jpg",ue=n.p+"odm_visualTemplateImage2_acc2003c.jpg",fe=n.p+"odm_visualTemplateImage7_3ce5b23a.jpg",pe=n.p+"odm_visualTemplateImage8_041b6620.jpg",me=n.p+"odm_visualTemplateImage9_2fe16c2e.jpg",_e=n.p+"odm_visualTemplateImage10_9c04fc1c.jpg",he=n.p+"odm_visualTemplateImage11_dac4273e.jpg",be=n.p+"odm_visualTemplateImageTile_221657e3.jpg",ge=n.p+"odm_sleekTemplateImageTile_025d4926.jpg",ve=n.p+"odm_defaultSignature_c988b8b4.png",ye=n.p+"odm_abstract1_0156b33b.jpg",Se=n.p+"odm_abstract2_ef229068.jpg",De=n.p+"odm_abstract3_373bb6a2.jpg",Ie=n.p+"odm_abstract4_e52a03bb.jpg",xe=n.p+"odm_abstract5_22697a52.jpg",Ce=n.p+"odm_calendar_cad05fc4.jpg",Oe=n.p+"odm_chairs_488e0bfe.jpg",we=n.p+"odm_collaboration1_7239a7ea.jpg",Ee=n.p+"odm_colorfulNotes_ef9ed634.jpg",Ae=n.p+"odm_construction_bf352c0b.jpg",Le=n.p+"odm_decorativeBuilding_9955f1fe.jpg",ke=n.p+"odm_meeting1_61d0e83b.jpg",Me=n.p+"odm_office_b8e24426.jpg",Pe=n.p+"odm_pencils_eb893896.jpg",Te=n.p+"odm_tech1_1bbf347b.jpg",Ue=n.p+"odm_tech2_f8d4c8e3.jpg",Fe=n.p+"odm_volunteer1_cf0befb7.jpg",He=n.p+"odm_woman1_9a7da0e2.jpg",Re=n.p+"odm_alternateBlankThumbnail_d5e9fe09.png",Ne=n.p+"odm_videoTrainingThumbnail_572796ea.jpg",Be=n.p+"odm_videoEventTemplateThumbnail_414120cf.jpg",je=n.p+"odm_videoMessageThumbnail_e4909dd8.png",Ve=n.p+"odm_person1_9617625d.jpg",ze=n.p+"odm_person2_aac9e546.jpg",Ge=n.p+"odm_person3_d1f59718.jpg",Ke=n.p+"odm_team1_34d9220d.jpg",We=n.p+"odm_team2_e9e8cf21.jpg",qe=n.p+"odm_person1_7bfa2c68.jpg",Qe=n.p+"odm_person2_7da8fd5c.jpg",Ye=n.p+"odm_person3_c65b65e2.jpg",Je=n.p+"odm_person4_39e7583a.jpg",Xe=n.p+"odm_person5_b6a9d922.jpg",Ze=n.p+"odm_person1_d2d1b0d2.jpg",$e=n.p+"odm_person2_58ab67a9.jpg",et=n.p+"odm_person3_c299b5c1.jpg",tt=n.p+"odm_person4_09619663.jpg",nt=n.p+"odm_thunderbolt_bbe08b0a.png",at=n.p+"odm_icon1_e49c970f.png",it=n.p+"odm_icon2_5e12fb8c.png",rt=n.p+"odm_icon3_62eee3f6.png",ot=n.p+"odm_icon4_a98aa9da.png",st=n.p+"odm_person1_0a6a50fd.jpg",ct=n.p+"odm_person2_3cdc1c18.jpg",dt=n.p+"odm_person3_86b9c211.jpg",lt=n.p+"odm_person4_ea7620e2.jpg",ut=n.p+"odm_person5_56eff96c.jpg",ft=n.p+"odm_person6_002960c3.jpg",pt=n.p+"odm_abstract1_7843f3b3.jpg",mt=n.p+"odm_abstract2_7009112f.jpg",_t=n.p+"odm_abstract3_5d428082.jpg",ht=n.p+"odm_person1_23a9612c.jpg",bt=n.p+"odm_abstract1_e25d80d8.jpg",gt=n.p+"odm_abstract2_445eb8da.jpg",vt=n.p+"odm_person1_de9c089d.jpg",yt=n.p+"odm_person1_513279dc.png",St=n.p+"odm_person1_ca311429.jpg",Dt=n.p+"odm_team1_91c8211a.jpg",It=n.p+"odm_compass_0f132392.jpg",xt=n.p+"odm_white_61c94856.png",Ct=n.p+"odm_white-rect_86afcdce.png",Ot=n.p+"odm_city_1bbd5862.jpg",wt=n.p+"odm_abstract1_9531ad99.jpg",Et=n.p+"odm_abstract2_29b00f32.jpg",At=n.p+"odm_person1_a02865c7.jpg",Lt=n.p+"odm_person2_2965870c.jpg",kt=n.p+"odm_person3_e9083e1d.jpg",Mt=n.p+"odm_person4_2bb123f8.jpg",Pt=n.p+"odm_feather_a1fb671d.jpg",Tt=n.p+"odm_abstract1_6865f8e8.jpg",Ut=n.p+"odm_abstract2_f4be5773.jpg",Ft=n.p+"odm_abstract3_5a1cace1.jpg",Ht=n.p+"odm_person1_44ca441b.jpg",Rt=n.p+"odm_hero-section-bg-1_c7ba82a3.png";class Nt{static getDefaultImage(e){if(e){if(Nt._defaultImageUrlMap.hasOwnProperty(e.path))return Nt._defaultImageUrlMap[e.path];{let t=e.path;if(e.path){t=t.toUpperCase();const e=t.indexOf("/_LAYOUTS/IMAGES/");if(e>-1&&(t=t.substr(e),Nt._defaultImageUrlMap.hasOwnProperty(t)))return Nt._defaultImageUrlMap[t]}if(e.authority){const t=new M._SPResourcePath(Nt._defaultImageUrlMap["/_LAYOUTS/IMAGES/REPORTSITEDEFAULTIMAGE1.PNG"]);if(t.authority&&t.authority===e.authority)return e.value}}}}static getDefaultImageById(e){switch(e){case 0:return N;case 1:return B;case 2:return j;case 3:return V;case 4:return z;case 5:return G;case 6:return K;case 7:return W;default:return}}static getDefaultNewsCarouselImageById(e){switch(e){case 0:return Z;case 1:return $;case 2:return ee;default:return}}static isStockImage(e){return!!e&&(e instanceof M._SPResourcePath?!!Nt.getDefaultImage(e):!!Nt.getDefaultImage(new M._SPResourcePath(e)))}}Nt._defaultImageUrlMap={"/_LAYOUTS/IMAGES/REPORTSITEDEFAULTIMAGE1.PNG":q,"/_LAYOUTS/IMAGES/REPORTSITEDEFAULTIMAGE2.PNG":Q,"/_LAYOUTS/IMAGES/REPORTSITEDEFAULTIMAGE3.PNG":Y,"/_LAYOUTS/IMAGES/REPORTSITEDEFAULTIMAGE4.PNG":J,"/_LAYOUTS/IMAGES/REPORTSITEDEFAULTIMAGE5.PNG":X,"/_LAYOUTS/IMAGES/PORTFOLIOSITEDEFAULTIMAGE1.PNG":G,"/_LAYOUTS/IMAGES/PORTFOLIOSITEDEFAULTIMAGE2.PNG":K,"/_LAYOUTS/IMAGES/PORTFOLIOSITEDEFAULTIMAGE3.PNG":W,"/_LAYOUTS/IMAGES/PORTFOLIOIMAGEGALLERYCHAIRS.PNG":te,"/_LAYOUTS/IMAGES/PORTFOLIOIMAGEGALLERYCUSHIONS.PNG":ne,"/_LAYOUTS/IMAGES/PORTFOLIOIMAGEGALLERYHANDRAIL.PNG":ae,"/_LAYOUTS/IMAGES/PORTFOLIOIMAGEGALLERYLAMPS.PNG":ie,"/_LAYOUTS/IMAGES/PORTFOLIOIMAGEGALLERYLOUNGE.PNG":re,"/_LAYOUTS/IMAGES/PORTFOLIOIMAGEGALLERYPENDANT.PNG":oe,"/_LAYOUTS/IMAGES/PORTFOLIOIMAGEGALLERYWALL.PNG":se,"/_LAYOUTS/IMAGES/PORTFOLIOIMAGEGALLERYWOOD.PNG":ce,"/_LAYOUTS/IMAGES/VISUALTEMPLATETITLEIMAGE.JPG":de,"/_LAYOUTS/IMAGES/VISUALTEMPLATEIMAGE1.JPG":le,"/_LAYOUTS/IMAGES/VISUALTEMPLATEIMAGE2.JPG":ue,"/_LAYOUTS/IMAGES/VISUALTEMPLATEIMAGE7.JPG":fe,"/_LAYOUTS/IMAGES/VISUALTEMPLATEIMAGE8.JPG":pe,"/_LAYOUTS/IMAGES/VISUALTEMPLATEIMAGE9.JPG":me,"/_LAYOUTS/IMAGES/VISUALTEMPLATEIMAGE10.JPG":_e,"/_LAYOUTS/IMAGES/VISUALTEMPLATEIMAGE11.JPG":he,"/_LAYOUTS/IMAGES/VISUALTEMPLATEIMAGETILE.JPG":be,"/_LAYOUTS/IMAGES/SLEEKTEMPLATEIMAGETILE.JPG":ge,"/_LAYOUTS/IMAGES/DEFAULTSIGNATURE.PNG":ve,"/_LAYOUTS/IMAGES/ABSTRACT1.JPG":ye,"/_LAYOUTS/IMAGES/ABSTRACT2.JPG":Se,"/_LAYOUTS/IMAGES/ABSTRACT3.JPG":De,"/_LAYOUTS/IMAGES/ABSTRACT4.JPG":Ie,"/_LAYOUTS/IMAGES/ABSTRACT5.JPG":xe,"/_LAYOUTS/IMAGES/CALENDAR.JPG":Ce,"/_LAYOUTS/IMAGES/CHAIRS.JPG":Oe,"/_LAYOUTS/IMAGES/COLLABORATION1.JPG":we,"/_LAYOUTS/IMAGES/COLORFULNOTES.JPG":Ee,"/_LAYOUTS/IMAGES/CONSTRUCTION.JPG":Ae,"/_LAYOUTS/IMAGES/DECORATIVEBUILDING.JPG":Le,"/_LAYOUTS/IMAGES/MEETING1.JPG":ke,"/_LAYOUTS/IMAGES/OFFICE.JPG":Me,"/_LAYOUTS/IMAGES/PENCILS.JPG":Pe,"/_LAYOUTS/IMAGES/TECH1.JPG":Te,"/_LAYOUTS/IMAGES/TECH2.JPG":Ue,"/_LAYOUTS/IMAGES/VOLUNTEER1.JPG":Fe,"/_LAYOUTS/IMAGES/WOMAN1.JPG":He,"/_LAYOUTS/IMAGES/ALTERNATEBLANK.PNG":Re,"/_LAYOUTS/IMAGES/VIDEOTRAININGTHUMBNAIL.JPG":Ne,"/_LAYOUTS/IMAGES/VIDEOEVENTTHUMBNAIL.JPG":Be,"/_LAYOUTS/IMAGES/VIDEOMESSAGETHUMBNAIL.PNG":je,"/_LAYOUTS/IMAGES/STP_1_PERSON_1.JPG":Ve,"/_LAYOUTS/IMAGES/STP_1_PERSON_2.JPG":ze,"/_LAYOUTS/IMAGES/STP_1_PERSON_3.JPG":Ge,"/_LAYOUTS/IMAGES/STP_1_TEAM_1.JPG":Ke,"/_LAYOUTS/IMAGES/STP_1_TEAM_2.JPG":We,"/_LAYOUTS/IMAGES/STP_2_PERSON_1.JPG":qe,"/_LAYOUTS/IMAGES/STP_2_PERSON_2.JPG":Qe,"/_LAYOUTS/IMAGES/STP_2_PERSON_3.JPG":Ye,"/_LAYOUTS/IMAGES/STP_2_PERSON_4.JPG":Je,"/_LAYOUTS/IMAGES/STP_2_PERSON_5.JPG":Xe,"/_LAYOUTS/IMAGES/STP_3_PERSON_1.JPG":Ze,"/_LAYOUTS/IMAGES/STP_3_PERSON_2.JPG":$e,"/_LAYOUTS/IMAGES/STP_3_PERSON_3.JPG":et,"/_LAYOUTS/IMAGES/STP_3_PERSON_4.JPG":tt,"/_LAYOUTS/IMAGES/STP_THUNDERBOLT.PNG":nt,"/_LAYOUTS/IMAGES/STP_5_ICON_1.PNG":at,"/_LAYOUTS/IMAGES/STP_5_ICON_2.PNG":it,"/_LAYOUTS/IMAGES/STP_5_ICON_3.PNG":rt,"/_LAYOUTS/IMAGES/STP_5_ICON_4.PNG":ot,"/_LAYOUTS/IMAGES/STP_6_PERSON_1.JPG":st,"/_LAYOUTS/IMAGES/STP_6_PERSON_2.JPG":ct,"/_LAYOUTS/IMAGES/STP_6_PERSON_3.JPG":dt,"/_LAYOUTS/IMAGES/STP_6_PERSON_4.JPG":lt,"/_LAYOUTS/IMAGES/STP_6_PERSON_5.JPG":ut,"/_LAYOUTS/IMAGES/STP_6_PERSON_6.JPG":ft,"/_LAYOUTS/IMAGES/STP_7_ABSTRACT_1.JPG":pt,"/_LAYOUTS/IMAGES/STP_7_ABSTRACT_2.JPG":mt,"/_LAYOUTS/IMAGES/STP_7_ABSTRACT_3.JPG":_t,"/_LAYOUTS/IMAGES/STP_7_PERSON_1.JPG":ht,"/_LAYOUTS/IMAGES/STP_9_ABSTRACT_1.JPG":bt,"/_LAYOUTS/IMAGES/STP_9_ABSTRACT_2.JPG":gt,"/_LAYOUTS/IMAGES/STP_9_PERSON_1.JPG":vt,"/_LAYOUTS/IMAGES/STP_10_PERSON_1.PNG":yt,"/_LAYOUTS/IMAGES/STP_11_PERSON_1.JPG":St,"/_LAYOUTS/IMAGES/STP_11_TEAM_1.JPG":Dt,"/_LAYOUTS/IMAGES/STP_12_COMPASS.JPG":It,"/_LAYOUTS/IMAGES/STP_12_WHITE.PNG":xt,"/_LAYOUTS/IMAGES/STP_13_WHITE.PNG":Ct,"/_LAYOUTS/IMAGES/STP_13_CITY.JPG":Ot,"/_LAYOUTS/IMAGES/STP_15_ABSTRACT_1.JPG":wt,"/_LAYOUTS/IMAGES/STP_15_ABSTRACT_2.JPG":Et,"/_LAYOUTS/IMAGES/STP_16_PERSON_1.JPG":At,"/_LAYOUTS/IMAGES/STP_16_PERSON_2.JPG":Lt,"/_LAYOUTS/IMAGES/STP_16_PERSON_3.JPG":kt,"/_LAYOUTS/IMAGES/STP_16_PERSON_4.JPG":Mt,"/_LAYOUTS/IMAGES/STP_20_FEATHER.JPG":Pt,"/_LAYOUTS/IMAGES/STP_THREE_COL_ABSTRACT_1.JPG":Tt,"/_LAYOUTS/IMAGES/STP_THREE_COL_ABSTRACT_2.JPG":Ut,"/_LAYOUTS/IMAGES/STP_THREE_COL_ABSTRACT_3.JPG":Ft,"/_LAYOUTS/IMAGES/STP_THIRD_COL_RIGHT_PERSON_1.JPG":Ht,"/_LAYOUTS/IMAGES/HERO_SECTION_BACKGROUND_1.JPG":Rt};var Bt=n(8398),jt=n(4907),Vt=n(8122);class zt{static loadImage(e){return new Promise((t,n)=>{const a=document.createElement("img");a.onload=e=>{t(a)},a.onerror=e=>{n(e)},a.setAttribute("src",e)})}static async readImageRatio(e){const t=await zt.loadImage(e);return t.naturalWidth/t.naturalHeight}static loadThumbnailImage(e){return new Promise((t,n)=>{const a=document.createElement("div");e.disableBlobRevoke=!0,jt.render(c.createElement(Vt.SPImg,{...e,onImageLoad:e=>{t(e?.target),Bt.unmountComponentAtNode(a)},onImageLoadFailure:(e,t)=>{"stockImage"===e&&(n(e),Bt.unmountComponentAtNode(a))},renderedInDetachedDOM:!0}),a)})}static async readThumbnailImageRatio(e){const t=await zt.loadThumbnailImage(e);return t.naturalWidth/t.naturalHeight}}class Gt{static get defaultImage(){return(0,l.getTheme)().isInverted?Gt._darkThemeImage:Gt._lightThemeImage}static getDefaultImage(e){return e?Gt._darkThemeImage:Gt._lightThemeImage}getImageURL(e){switch(e.image.type){case x.y.DefaultImage:return this._getDefaultImageURL(e.image);case x.y.SharePointImage:return this._getSharePointImageURL(e).catch(()=>this._getDefaultImageURL(Gt.defaultImage));case x.y.LocalImage:return this._getLocalImageURL(e.image);case x.y.ExternalImage:return this._getExternalImageURL(e.image);default:return Promise.reject(new Error("Unexpected image type"))}}_getDefaultImageURL(e){return this._tryImageURL("Dark"===e.theme?L.defaultImageDark:L.defaultImageLight)}_getSharePointImageURL(e){return this._generateThumbnailUrl(e).catch(()=>this._trySharePointURL(e.image)).catch(()=>{throw new F("Failure")})}_getLocalImageURL(e){return new Promise((t,n)=>{this._fileReader.onloadend=()=>t(this._fileReader.result),this._fileReader.onerror=n,this._fileReader.readAsDataURL(e.file)})}_getExternalImageURL(e){return this._tryImageURL(e.source)}_generateThumbnailUrl(e){const t=e.image;if(!t)return Promise.reject(new F("ImageTypeIncorrect"));const n=L.convertFocalPointToCropMode(e.focalPoint);return zt.loadThumbnailImage({imageData:{imageUrl:t.source,siteId:t.siteId?.toString(),webId:t.webId?.toString(),listId:t.listId?.toString(),uniqueId:t.uniqueId?.toString(),cropMode:n},serviceScope:this._serviceScope,thumbnailWidth:window.innerWidth,thumbnailHeight:void 0!==n?e.requestedHeight:void 0,callerId:"TitleRegion",getDefaultImage:Nt.getDefaultImage,displayMode:e.editMode?f.DisplayMode.Edit:f.DisplayMode.Read}).then(e=>e.src).catch(()=>Promise.reject(new H("ServiceNotEnabled")))}_trySharePointURL(e){const t=e.source;return this._tryImageURL(t)}constructor(e){this.getFullSizeUrl=e=>{let t=!1;if(e.image.type===x.y.ExternalImage&&(t=!!e.image.source&&M._ThumbnailUrlGenerator.getThumbnailProvider(e.image.source)===M._ThumbnailProviderType.HubbleStock),e.image.type!==x.y.SharePointImage&&!t)return;const n=e.image,a=new M._SPResourcePath(n.source);return M._ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:this._pageContext.web.absoluteUrl,spResource:n.source,siteId:n.siteId&&n.siteId?.toString(),webId:n.webId&&n.webId?.toString(),listId:n.listId&&n.listId?.toString(),uniqueId:n.uniqueId&&n.uniqueId?.toString(),fileType:M._PreviewUtility.getFileExtension(a),width:window.innerWidth,height:void 0,callerId:"TitleRegion",cropMode:void 0},Nt.getDefaultImage(a))},this._tryImageURL=e=>new Promise((t,n)=>{const a=new Image;a.onload=()=>t(e),a.onerror=t=>{const a=t.error||new Error(`Fail to load image ${e}`);d._TraceLogger.logError(d._LogSource.create("ImageReader"),a),n(a)},a.src=e}),this._pageContext=e.consume(P.PageContext.serviceKey),this._serviceScope=e,this._fileReader=new FileReader}}Gt._darkThemeImage={id:"DefaultImage-Dark",type:x.y.DefaultImage,theme:"Dark"},Gt._lightThemeImage={id:"DefaultImage-Light",type:x.y.DefaultImage,theme:"Light"},(0,k._ts_decorate)([R("TitleRegion.GetImageURL")],Gt.prototype,"getImageURL",null),(0,k._ts_decorate)([R("TitleRegion.GetDefaultImageURL")],Gt.prototype,"_getDefaultImageURL",null),(0,k._ts_decorate)([R("TitleRegion.GetSharePointImageURL")],Gt.prototype,"_getSharePointImageURL",null),(0,k._ts_decorate)([R("TitleRegion.GetLocalImageURL")],Gt.prototype,"_getLocalImageURL",null),(0,k._ts_decorate)([R("TitleRegion.GetExternalImageURL")],Gt.prototype,"_getExternalImageURL",null),(0,k._ts_decorate)([R("TitleRegion.TrySharePointURL")],Gt.prototype,"_trySharePointURL",null);var Kt=n(1657),Wt=n(95);function qt(e){if(function(e){return!f._SPKillSwitch.isActivated("d189d05b-4d13-4ee0-9e7a-4244a0aa489f")&&!f._SPKillSwitch.isActivated("6b3c97ae-c33a-4c1e-9b88-5dc1e87ab20f")&&f._SPFlight.isEnabled(62479)&&function(e){return e===o.Getty}(e)}(e))return{pointerEvents:"none"}}class Qt{observe(e,t){this._observerMap.set(e,t),this._viewportObserver.observe(e)}unobserve(e){this._viewportObserver.unobserve(e),this._observerMap.has(e)&&this._observerMap.delete(e)}constructor(e){this._observerMap=new Map,this._viewportObserver=new IntersectionObserver(e)}}Qt.instance=window.IntersectionObserver&&new Qt(e=>{e.forEach(e=>{try{e.isIntersecting&&Qt.instance?._observerMap.get(e.target)?.()}catch(e){d._TraceLogger.logError(Qt._logSource,e)}})}),Qt._logSource=d._LogSource.create("ImageViewPortObserver");var Yt=n(8810);function Jt(){return f._SPKillSwitch.isActivated("419483ea-4c71-4be9-aa2c-4ddc347bccce")}function Xt(){return f._SPKillSwitch.isActivated("1675210f-385b-4e20-9be6-e45cd577c771")}function Zt(){return f._SPKillSwitch.isActivated("7e601a75-79b6-4241-a3f1-1c00be6bace8")}function $t(){return f._SPKillSwitch.isActivated("1cb23de7-9056-4f3d-8309-285575fa241b")}function en(){return f._SPKillSwitch.isActivated("96d7b1b4-914e-4342-ab64-0e0d10027de7")}function tn(){return f._SPKillSwitch.isActivated("9fb16044-ed91-43f6-b09d-e9d38885d1d7")}function nn(){return f._SPKillSwitch.isActivated("1b98f6f3-1306-4074-bc1f-f6ea3fe17b1a")}var an=n(606);const rn=c.createContext((0,an.makeStyles)({})),on=(0,an.makeStyles)({root:{display:"contents"}});function sn(e){const{children:t}=e,n=c.useContext(rn)().captionText,a=on().root;return c.createElement("div",{className:(0,an.mergeClasses)(n,a),...f._SPKillSwitch.isActivated("30e39a60-ab3d-4b36-86fe-2236236280a5")?{}:{"data-is-visible":!0}},t)}var cn=n(304),dn=n.n(cn);const ln=n.p+"external_5a54c731d2ee911ab26e.png";var un=dn()(ln);function fn(e,t){return{...e,target:t,currentTarget:t,nativeEvent:e,isDefaultPrevented:()=>!1,isPropagationStopped:()=>!1,persist:()=>{}}}C.loadStyles(".l_iJ6L-_Wr9CO{display:block;position:relative}.l_iJ6L-_Wr9CO :hover:before{content:url("+un+');height:20px;margin:unset;position:absolute;right:17px;top:12px;width:20px;z-index:1}.l_iJ6L-_Wr9CO :hover:after{background:linear-gradient(180deg,rgba(0,0,0,.5),transparent 23.9%);content:"";height:100%;left:0;margin:unset;position:absolute;top:0;width:100%}.r_6hqxX_Wr9CO{display:flex}.r_6hqxX_Wr9CO figure{margin:unset}.r_6hqxX_Wr9CO figcaption{text-align:center}.c_Kc3ri_Wr9CO{justify-content:center}.l_s-Gnd_Wr9CO{justify-content:flex-start}.r_I-l6R_Wr9CO{justify-content:flex-end}',!0);const pn={display:"none"};function mn(e){const{imgRefCallback:t,imageFit:n,imageData:a,serviceScope:i,callerId:r,cdnBaseUrls:o,onImageLoad:s,onImageLoadFailure:d,onInViewport:u,onLazyTimeout:p,getDefaultImage:m,thumbnailWidth:_,thumbnailHeight:h,renderedInDetachedDOM:b,disableBlobRevoke:g,...v}=e;let y=v;if(!$t()){const{imgRefCallback:t,imageData:n,serviceScope:a,callerId:i,thumbnailWidth:r,thumbnailHeight:o,imageFit:s,cdnBaseUrls:c,failureIconUrl:d,getDefaultImage:l,onImageLoadFailure:u,onImageLoad:f,renderedInDetachedDOM:p,disableBlobRevoke:m,cacheBuster:_,displayMode:h,skipCustomerPromiseLogging:b,encodedImage:g,onInViewport:v,onLazyTimeout:S,...D}=e;y=D}const S=c.useRef(void 0),D=c.createRef(),I=c.createRef(),x=c.createRef(),C=c.createRef(),O=c.useMemo(()=>e.src?class{static tryConsumePreAllocatedImageTag(e){const t=window._preAllocatedImageTags?.[e];return t&&!t.isConsumed?(t.isConsumed=!0,t):void 0}}.tryConsumePreAllocatedImageTag(e.src):void 0,[e.src]),[w,E]=c.useState(!!O),A=function(e){return("NewsWebPart"===e||"ImageGallery"===e||"EventCard"===e||"RTEInlineImage"===e||"CallToAction"===e||"RTEInlineImageCK5"===e)&&!!window.IntersectionObserver}(e.callerId);if(c.useLayoutEffect(()=>{if(A&&x?.current){const{current:t}=x;return Qt.instance?.observe(t,()=>{Qt.instance?.unobserve(t),e.onInViewport?.(),E(!0)}),S.current=window.setTimeout(()=>{S.current&&(hn(S),e.onLazyTimeout?.())},100),()=>{A&&hn(S),Qt.instance?.unobserve(t)}}}),c.useLayoutEffect(()=>{const t=I.current;if(D.current&&t&&O){const{imageElement:a,loadEvent:i}=O;if(t.getAttributeNames)t.getAttributeNames().forEach(e=>{a.setAttribute(e,t.getAttribute(e))});else if(t.hasAttributes()){const e=t.attributes;for(let t=0;t<e.length;t++)a.setAttribute(e[t].name,e[t].value)}n&&(a.style.objectFit=n);const r=t=>e.onLoad?.(fn(t,a)),o=t=>e.onError?.(fn(t,a));a.parentElement||(A&&e.onInViewport?.(),D.current.appendChild(a),i?r(i):(a.onload=r,a.onerror=o))}}),!e.src)return null;if(!O&&!w&&A)return c.createElement("div",{ref:x,style:{minHeight:e.height||`${e.thumbnailHeight||100}px`,width:e.width||"100%",height:e.height}});let L;if(A&&hn(S),O){const t=(0,l.getNativeElementProps)("img",y,["src","onLoad","onError"]);L=c.createElement("div",{role:"presentation"},c.createElement("div",{ref:D,role:"presentation"}),c.createElement("div",{style:pn,"aria-hidden":"true"},n?c.createElement("img",{ref:I,...t,style:{...t.style,objectFit:n,...Xt()?{}:qt(e.imageData.contentProvider)}}):c.createElement("img",{ref:I,...t,style:{...t.style,...Xt()?{}:qt(e.imageData.contentProvider)}})))}else L=n?c.createElement("img",{...y,ref:Jt()?C:t,style:{...y.style,objectFit:n,...Xt()?{}:qt(e.imageData.contentProvider)}}):c.createElement("img",{...y,ref:Jt()?C:t,className:(0,l.mergeStyles)(e.className,{borderRadius:e.imageData.roundedCorner}),style:{...y.style,...Xt()?{}:qt(e.imageData.contentProvider)}});if(e.imageData.anchor&&(L=c.createElement(Wt.Link,{className:(0,l.mergeStyles)("l_iJ6L-_Wr9CO",{"&::after":{borderRadius:e.imageData.roundedCorner,overflow:e.imageData.roundedCorner?"hidden":"unset"}}),href:e.imageData.anchor,target:f._SPKillSwitch.isActivated("46eb5c9e-8efe-4969-ab8e-9df828f6c540")?"_blank":void 0},c.createElement("div",{role:"presentation",className:(0,l.mergeStyles)({"&::after":{borderRadius:e.imageData.roundedCorner,overflow:e.imageData.roundedCorner?"hidden":"unset"}})},L))),e.imageData.caption){const t="LightBox"===e.callerId.toString();L=c.createElement("figure",{style:{width:e.width}},L,c.createElement("figcaption",{"data-automation-id":"captionElement",style:t?{visibility:"hidden"}:void 0},function(e){const t=e.split("\n");return c.createElement(c.Fragment,null,t.reduce((e,t)=>(e.length&&e.push(c.createElement("br",null)),e.push(c.createElement("span",{id:"CaptionTextView"},t)),e),[]))}(e.imageData.caption))),L=c.createElement(sn,null,L)}return e.imageData.alignment?c.createElement("div",{className:_n(e)},L):L}function _n(e){return(0,l.css)("r_6hqxX_Wr9CO","Left"===e.imageData.alignment?"l_s-Gnd_Wr9CO":"Right"===e.imageData.alignment?"r_I-l6R_Wr9CO":"c_Kc3ri_Wr9CO")}function hn(e){e?.current&&(window.clearTimeout(e?.current),e.current=void 0)}var bn=n(3030);const gn=({encodedImage:e,alt:t="",webPartName:n,...a})=>{const i=c.useMemo(()=>{try{return(0,bn.rW)(e,32,32,1,n)}catch(e){return d._TraceLogger.logError(bn.Jt,e),""}},[e,n]);return c.createElement("img",{src:i,alt:t,style:{position:"absolute",borderRadius:"4px",width:"100%",height:"100%"},...a,"data-automation-id":"lowQualityImagePlaceholder"})};function vn(e){return[400,401,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,429].includes(e)}function yn(){return!f._SPKillSwitch.isActivated("d2ceafeb-2bfc-4ef9-91fa-6da02f8d497b")&&f._SPFlight.isEnabled(61540)}function Sn(e,t){return new Promise((n,a)=>{const i=new XMLHttpRequest;i.open("GET",e);for(const e in t)t.hasOwnProperty(e)&&i.setRequestHeader(e,t[e]);i.responseType="blob",i.onload=()=>{if(i.status>=200&&i.status<300&&i.response)return n(i);{const e=i.getResponseHeader("location");e&&i.status>=300&&i.status<400?Sn(e).then(n).catch(a):a({httpRequest:i,statusCode:i.status,error:"Request Failed"})}},i.onerror=()=>a({httpRequest:i,statusCode:void 0,error:"Network Failed"}),i.send()})}function Dn(e,t){if(e===t.spResource||!t.spResource)return;const n=M._ThumbnailUrlGenerator.getThumbnailProvider(t.spResource);let a=t.spResource;if(n===M._ThumbnailProviderType.PublicCDN||n===M._ThumbnailProviderType.AFDPublicCDN||n===M._ThumbnailProviderType.PrivateCDN||n===M._ThumbnailProviderType.AFDPrivateCDN)a=`https://${new Yt.Uri(t.spResource).getPathSegments().join("/")}`;else if(n===M._ThumbnailProviderType.DocViz&&-1!==t.spResource.indexOf("path=")){const e=new M._SPResourcePath(t.spResource),n=t.spResource.toLowerCase().indexOf("/_layouts/15/getpreview.ashx");a=(n>-1?t.spResource.substring(0,n):e.authority)+e.getQueryParameter("path")}else n!==M._ThumbnailProviderType.SharePointHost&&n!==M._ThumbnailProviderType.MySite||(a=M._ThumbnailUrlGenerator.updateThumbnailWidth(a,t.width||M._PreviewUtility.smallestBreakPointWidth));if(!nn()&&t.cacheBuster&&a){const e=a.indexOf("?")>-1?"&":"?";a=`${a}${e}cb=${encodeURIComponent(t.cacheBuster)}`}return a}function In(e,t,n,a,i,r){if(!e)return;const{serviceName:o,src:s,httpRequest:c,isPreLoaded:d}=e,l={isPreLoaded:d,fallbacks:t.current.length,width:n,service:o,statusCode:a};if(r&&(l.dataProvider=r),c?.response&&(l.size=c.response.size,l.source=c.response.type),i.current)if(t.current.length<=1)i.current.writeSuccess(l);else{const e=`${o} passed`,n=1===t.current.length?new Error("Directly loaded full Url: <url>scrubbed</url>"):new Error(`Fallback order: ${t.current.join("->")}`);r=s&&!r?M._PreviewUtility.getFileExtension(new M._SPResourcePath(s)):r,en()&&"fullImage"===o&&"gif"!==r?i.current.writeUnexpectedFailure(e,n,l):i.current.writeExpectedFailure(e,n,l)}}function xn(e,t,n,a,i,r,o,s,c){const{serviceName:d,src:l,httpRequest:u,duration:f,isPreLoaded:p}=e,m={service:d,alias:i,duration:f,statusCode:r,isPreLoaded:p,viewportWidth:100*Math.floor(window.innerWidth/100)};if(s&&(m.dataProvider=s),void 0!==o&&(m.width=o),a&&(m.fallbacks=a.length),m.dprRaw=window.devicePixelRatio,m.dprClamped=c,u){const e="cdn"===d||"vroom"===d||"docViz"===d||"optimalStaticImage"===d;if(e){const e=u.getResponseHeader("sprequestguid");e&&(m.CorrelationId=e)}if("cdn"===d){let e=u.getResponseHeader("x-cache");if(e){e=e.split(" ")[0];const t="TCP_MISS";e===t&&(e=u.getResponseHeader("x-cache-remote")?.split(" ")[0]||e,e=e===t?e:`${e}_REMOTE`),m.CDNCache=e}l.indexOf("/_vti_bin/afdcache.ashx/")>-1&&(m.cacheCountryCode=u.getResponseHeader("x-ccc"))}if("cdn"===d||"vroom"===d){const e=u.getResponseHeader("x-cache-origin");e&&(m.OriginCache=e)}if(u.response&&(m.size=u.response.size,m.source=u.response.type),e){const e=u.getResponseHeader("date");if(e){const t=2500,a=new Date(e),i=n.getTime()-a.getTime();m.responseStatus=i>=t||i>-500&&f<=10?f<=1?"memoryCacheHit":"coldCacheHit":"cacheMiss"}}}t?.writeSuccess(m)}function Cn(e,t,n,a,i,r){const{serviceName:o,duration:s,loadingError:c}=e,d=c?.statusCode?c?.statusCode:On(i),l=new Error(`<url>scrubbed</url> <statusCode>${d}</statusCode> Error:${c?.error}`),u={alias:r,statusCode:d};if(s>0&&(u.duration=s),c?.httpRequest){const e=c.httpRequest.getResponseHeader("sprequestguid"),t=c.httpRequest.getAllResponseHeaders();e&&(u.CorrelationId=e),t&&(u.headers=t)}en()?(function(e){return void 0===e||!(e<=399)&&(e>=500?503!==e:!vn(e))}(d)&&"external"!==o?t?.writeUnexpectedFailure(`${o} failed`,l,u):t?.writeExpectedFailure(`${o} failed`,l,u),"stockImage"===o&&n?.current?.writeUnexpectedFailure("stock failed",new Error(`services failed: ${a.current.join("->")}`))):d&&vn(d)||"external"===o?(t?.writeExpectedFailure(`${o} failed`,l,u),n?.current?.writeExpectedFailure(`${o} failed`,new Error(`services failed: ${a.current.join("->")}`))):(t?.writeUnexpectedFailure(`${o} failed`,l,u),n?.current?.writeUnexpectedFailure(`${o} failed`,new Error(`services failed: ${a.current.join("->")}`)))}function On(e){if(!e)return;const t=e.currentTarget;return Boolean(t.src&&t.src.indexOf("encodeFailures=1")>=0)&&1===t.naturalWidth&&t.naturalHeight>6e4?t.naturalHeight-6e4:void 0}const wn="AuthVer",En="_eat_",An="_oat_",Ln="P1",kn="P4",Mn=d._LogSource.create("UseImageFallback"),Pn={};let Tn=!1;async function Un(e,t,n){let a,i,r,o,s=-1;try{r=new M._SPResourcePath(t),o=M._ThumbnailUrlGenerator.getThumbnailProvider(t)}catch(a){return d._TraceLogger.logError(Mn,a,"_generateStateFromSrc.parseUri"),{serviceName:e,src:t,httpRequest:i,duration:0,loadingError:{error:"Failed to parse image URL"},lastSourceError:n,isPreLoaded:!1,provider:M._ThumbnailProviderType.External,originalSrc:t}}if(!(r.domain?.indexOf("-my.sharepoint")>-1)&&o!==M._ThumbnailProviderType.External){const c="cdn"===e&&(Rn(r)||Nn(r)),l={};if(s=performance.now(),c)try{t=Hn(t,l)}catch(a){return d._TraceLogger.logError(Mn,a,"_generateStateFromSrc.moveTokensToHeader"),{serviceName:e,src:t,httpRequest:i,duration:performance.now()-s,loadingError:{error:"Failed to move tokens to header"},lastSourceError:n,isPreLoaded:!1,provider:o,originalSrc:t}}try{if(!Pn[t]){const r=Sn(t,l);Pn[t]=r,i=await r;const u={httpRequest:i,duration:performance.now()-s,isPreLoaded:!1};if(Pn[t]=u,c&&i?.response)try{u.blobUrl=URL.createObjectURL(i.response)}catch(e){d._TraceLogger.logError(Mn,e,"_generateStateFromSrc.createObjectURL")}return{serviceName:e,src:u.blobUrl||t,httpRequest:i,duration:u.duration,loadingError:a,lastSourceError:n,isPreLoaded:u.isPreLoaded,provider:o,originalSrc:t}}if(Pn[t]){const i=Pn[t];Promise.resolve(i)===i&&await i;const r=Pn[t];if(r.httpRequest.readyState<4){const e=r.duration;await new Promise((t,n)=>{r.httpRequest.onloadend=()=>{r.duration=performance.now()-e,r.httpRequest.status&&r.httpRequest.status<400?t(r.httpRequest):n({httpRequest:r.httpRequest,statusCode:r.httpRequest.status,error:"Request Failed"})}})}const s=!!Bn(t);if(!s&&c&&!r.blobUrl&&r.httpRequest?.response)try{r.blobUrl=URL.createObjectURL(r.httpRequest?.response)}catch(e){d._TraceLogger.logError(Mn,e,"_generateStateFromSrc.createObjectURL")}return{serviceName:e,src:!s&&r.blobUrl||t,httpRequest:r.httpRequest,duration:r.duration,loadingError:a,lastSourceError:n,isPreLoaded:r.isPreLoaded,provider:o,originalSrc:t}}}catch(e){d._TraceLogger.logError(Mn,e,"_generateStateFromSrc"),e&&"object"==typeof e&&"statusCode"in e?(a=e,a.error&&(a={...a,error:Vn(a.error).message||jn(String(e))})):a={error:Vn(e).message||jn(String(e))}}s=performance.now()-s}return{serviceName:e,src:t,httpRequest:i,duration:s,loadingError:a,lastSourceError:n,isPreLoaded:!1,provider:o,originalSrc:t}}async function Fn(e,t,n){let a,i,r=-1;const o=new M._SPResourcePath(t),s=M._ThumbnailUrlGenerator.getThumbnailProvider(t);if(!(o.domain?.indexOf("-my.sharepoint")>-1)&&s!==M._ThumbnailProviderType.External){const c="cdn"===e&&(Rn(o)||Nn(o)),l={};r=performance.now(),c&&(t=Hn(t,l));try{if(!Pn[t]){const o=Sn(t,l);Pn[t]=o,i=await o;const d={httpRequest:i,duration:performance.now()-r,isPreLoaded:!1};return Pn[t]=d,c&&i?.response&&(d.blobUrl=URL.createObjectURL(i.response)),{serviceName:e,src:d.blobUrl||t,httpRequest:i,duration:d.duration,loadingError:a,lastSourceError:n,isPreLoaded:d.isPreLoaded,provider:s,originalSrc:t}}if(Pn[t]){const i=Pn[t];Promise.resolve(i)===i&&await i;const r=Pn[t];if(r.httpRequest.readyState<4){const e=r.duration;await new Promise((t,n)=>{r.httpRequest.onloadend=()=>{r.duration=performance.now()-e,r.httpRequest.status&&r.httpRequest.status<400?t(r.httpRequest):n({httpRequest:r.httpRequest,statusCode:r.httpRequest.status,error:"Request Failed"})}})}const o=!!Bn(t);return!o&&c&&!r.blobUrl&&r.httpRequest?.response&&(r.blobUrl=URL.createObjectURL(r.httpRequest?.response)),{serviceName:e,src:!o&&r.blobUrl||t,httpRequest:r.httpRequest,duration:r.duration,loadingError:a,lastSourceError:n,isPreLoaded:r.isPreLoaded,provider:s,originalSrc:t}}}catch(e){d._TraceLogger.logError(Mn,e,"_generateStateFromSrc"),a=e}r=performance.now()-r}return{serviceName:e,src:t,httpRequest:i,duration:r,loadingError:a,lastSourceError:n,isPreLoaded:!1,provider:s,originalSrc:t}}function Hn(e,t){const n=[],a=new M._SPResourcePath(e);return Nn(a)&&(n.push(Ln),n.push("P2"),n.push("P3"),n.push(kn)),Rn(a)&&(n.push(En),n.push(An)),n.forEach(e=>{const n=a.getQueryParameter(e);if(n){if(a.removeQueryParameter(e),f._SPFlight.isEnabled(60041))switch(e){case Ln:e="X-MSEdge-TluExpiration";break;case"P2":e="X-MSEdge-TluKeyNumber";break;case"P3":e="X-MSEdge-TluAlgorithmId";break;case kn:e="X-MSEdge-TluSignature"}t[e]=n}}),a.toString()}function Rn(e){return f._SPFlight.isEnabled(1994)&&"2"===e.getQueryParameter(wn)}function Nn(e){return f._SPFlight.isEnabled(60041)&&void 0!==e.getQueryParameter(An)&&void 0!==e.getQueryParameter(Ln)&&void 0!==e.getQueryParameter(kn)}function Bn(e){return window._preAllocatedImageTags?.[e]?.imageElement?.src}function jn(e){return e.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/gi,"[REDACTED_EMAIL]").replace(/https?:\/\/[^\s]+/gi,"[REDACTED_URL]").replace(/\b\d{1,3}(\.\d{1,3}){3}\b/g,"[REDACTED_IP]").replace(/(?:[A-Z]:\\|\/)[\w\-./\\]+/gi,"[REDACTED_PATH]")}function Vn(e){if(!(e instanceof Error))return new Error("Unknown error type");const t=new Error(jn(e.message));return t.name=e.name,t.stack=e.stack?jn(e.stack):void 0,t}const zn="AuthVer",Gn="_eat_",Kn="_oat_",Wn="P1",qn="P4",Qn={[Wn]:"X-MSEdge-TluExpiration",P2:"X-MSEdge-TluKeyNumber",P3:"X-MSEdge-TluAlgorithmId",[qn]:"X-MSEdge-TluSignature"},Yn=d._LogSource.create("UseImageFallback"),Jn={};let Xn=!1;async function Zn(e,t,n){let a,i,r,o,s=-1;try{r=new M._SPResourcePath(t),o=M._ThumbnailUrlGenerator.getThumbnailProvider(t)}catch(a){return d._TraceLogger.logError(Yn,a,"_generateStateFromSrc.parseUri"),{serviceName:e,src:t,httpRequest:i,duration:0,loadingError:{error:"Failed to parse image URL"},lastSourceError:n,isPreLoaded:!1,provider:M._ThumbnailProviderType.External,originalSrc:t}}if(!(r.domain?.indexOf("-my.sharepoint")>-1)&&o!==M._ThumbnailProviderType.External){const c="cdn"===e&&($n(r)||ea(r)),l={};if(s=performance.now(),c)try{t=function(e,t){const n=new M._SPResourcePath(e),a=[];ea(n)&&a.push(Wn,"P2","P3",qn),$n(n)&&a.push(Gn,Kn);for(const e of a){const a=n.getQueryParameter(e);a&&(n.removeQueryParameter(e),t[f._SPFlight.isEnabled(60041)&&Qn[e]?Qn[e]:e]=a)}return n.toString()}(t,l)}catch(a){return d._TraceLogger.logError(Yn,a,"_generateStateFromSrc.moveTokensToHeader"),{serviceName:e,src:t,httpRequest:i,duration:performance.now()-s,loadingError:{error:"Failed to move tokens to header"},lastSourceError:n,isPreLoaded:!1,provider:o,originalSrc:t}}try{const i=Jn[t],r=i?await async function(e,t,n){t instanceof Promise&&await t;const a=Jn[e];if(a.httpRequest.readyState<4){const e=a.duration,t=performance.now();await new Promise((n,i)=>{a.httpRequest.onloadend=()=>{a.duration=e+(performance.now()-t),a.httpRequest.status&&a.httpRequest.status<400?n(a.httpRequest):i({httpRequest:a.httpRequest,statusCode:a.httpRequest.status,error:"Request Failed"})}})}const i=(r=e,!!window._preAllocatedImageTags?.[r]?.imageElement?.src);var r;if(!i&&n&&!a.blobUrl&&a.httpRequest?.response)try{a.blobUrl=URL.createObjectURL(a.httpRequest.response)}catch(e){d._TraceLogger.logError(Yn,e,"_awaitCachedDownload.createObjectURL")}return{httpRequest:a.httpRequest,duration:a.duration,isPreLoaded:a.isPreLoaded,blobUrl:i?void 0:a.blobUrl}}(t,i,c):await async function(e,t,n,a){const i=Sn(e,t);Jn[e]=i;const r=await i,o={httpRequest:r,duration:performance.now()-n,isPreLoaded:!1};if(Jn[e]=o,a&&r?.response)try{o.blobUrl=URL.createObjectURL(r.response)}catch(e){d._TraceLogger.logError(Yn,e,"_initiateNewDownload.createObjectURL")}return{httpRequest:r,duration:o.duration,isPreLoaded:o.isPreLoaded,blobUrl:o.blobUrl}}(t,l,s,c);return{serviceName:e,src:r.blobUrl||t,httpRequest:r.httpRequest,duration:r.duration,loadingError:a,lastSourceError:n,isPreLoaded:r.isPreLoaded,provider:o,originalSrc:t}}catch(e){d._TraceLogger.logError(Yn,e,"_generateStateFromSrc"),e&&"object"==typeof e&&"statusCode"in e?(a=e,a.error&&(a={...a,error:na(a.error).message||ta(String(e))})):a={error:na(e).message||ta(String(e))}}s=performance.now()-s}return{serviceName:e,src:t,httpRequest:i,duration:s,loadingError:a,lastSourceError:n,isPreLoaded:!1,provider:o,originalSrc:t}}function $n(e){return f._SPFlight.isEnabled(1994)&&"2"===e.getQueryParameter(zn)}function ea(e){return f._SPFlight.isEnabled(60041)&&void 0!==e.getQueryParameter(Kn)&&void 0!==e.getQueryParameter(Wn)&&void 0!==e.getQueryParameter(qn)}function ta(e){return e.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/gi,"[REDACTED_EMAIL]").replace(/https?:\/\/[^\s]+/gi,"[REDACTED_URL]").replace(/\b\d{1,3}(\.\d{1,3}){3}\b/g,"[REDACTED_IP]").replace(/(?:[A-Z]:\\|\/)[\w\-./\\]+/gi,"[REDACTED_PATH]")}function na(e){if(!(e instanceof Error))return new Error("Unknown error type");const t=new Error(ta(e.message));return t.name=e.name,t.stack=e.stack?ta(e.stack):void 0,t}function aa(e,t){if(e&&"object"==typeof e&&"statusCode"in e){const n=e;return{error:n.error?na(n.error).message:ta(String(n.error)),statusCode:n.statusCode,serviceName:t}}return{error:e instanceof Error&&na(e).message||ta(String(e)),serviceName:t}}const ia=n.p+"stockImage_875b1d8f40c8c64ac0fe.png";var ra=n(1909);const oa=new Map,sa=d._LogSource.create("ImageFallbackHelper");function ca(e){const t=new Map,n=function(e){const{cropData:t,imageNaturalHeight:n,imageNaturalWidth:a,imageUrl:i,listId:r,siteId:o,uniqueId:s,webId:c,cropMode:d,cacheBuster:l,encodedImage:u}=e.imageData;if(!i)return;const p=M._PreviewUtility.getFileExtension(new M._SPResourcePath(i)),m={absoluteUrl:e.serviceScope&&e.serviceScope.consume(P.PageContext.serviceKey).web.absoluteUrl,callerId:e.callerId,fileType:p,height:e.thumbnailHeight,listId:r,originalHeight:n,originalWidth:a,siteId:o,spResource:i,uniqueId:s,webId:c,width:e.thumbnailWidth,cropMode:d,cacheBuster:yn()?e.cacheBuster:l,encodedLQIPImage:Zt()||f._SPKillSwitch.isActivated("05765def-707c-443f-ad57-864b0179cfba")||!f._SPFlight.isEnabled(62395)&&1!==f._SPExperiment.getVariantAndLogExposure(90359)?void 0:u};return t&&function(e,t,n){return void 0!==e&&e.x>=0&&e.y>=0&&e.width>0&&e.height>0&&!function(e,t,n){return void 0!==e&&0===e.x&&0===e.y&&e.width>0&&e.height>0&&e.width===n&&e.height===t}(e,t,n)}(t,n,a)&&(m.viewportLeft=t.x,m.viewportTop=t.y,m.viewportWidth=t.width,m.viewportHeight=t.height),m}(e);if(!n)return t;const a=e.failureIconUrl||ia,i=n.spResource&&e.getDefaultImage?e.getDefaultImage(new M._SPResourcePath(n.spResource)):void 0,r=M._ThumbnailUrlGenerator.getThumbnailUrl(n,i)||"",o=M._ThumbnailUrlGenerator.getThumbnailProvider(r),s=r===n.spResource?o:void 0,c=!nn()&&!0===e.shouldForceFullImageSrc;return o===M._ThumbnailProviderType.PublicCDN||o===M._ThumbnailProviderType.AFDPublicCDN||o===M._ThumbnailProviderType.PrivateCDN||o===M._ThumbnailProviderType.AFDPrivateCDN?(c||(t.set("cdn",{url:()=>Promise.resolve(r)}),t.set("vroom",{url:()=>da(e.serviceScope,M._ThumbnailUrlGenerator.getVROOMThumbnailUrl(n,s))})),t.set("fullImage",{url:()=>Promise.resolve(Dn(r,n))}),t.set("stockImage",{url:()=>Promise.resolve(a),isFailureIcon:!0})):o===M._ThumbnailProviderType.VROOMMeTACache?(c||t.set("vroom",{url:()=>da(e.serviceScope,r)}),t.set("fullImage",{url:()=>Promise.resolve(Dn(r,n))}),t.set("stockImage",{url:()=>Promise.resolve(a),isFailureIcon:!0})):o===M._ThumbnailProviderType.DocViz?(c||t.set("docViz",{url:()=>Promise.resolve(r)}),t.set("fullImage",{url:()=>Promise.resolve(Dn(r,n))}),t.set("stockImage",{url:()=>Promise.resolve(a),isFailureIcon:!0})):o===M._ThumbnailProviderType.Stock||o===M._ThumbnailProviderType.HubbleStock||o===M._ThumbnailProviderType.HubbleStockThumbnail||o===M._ThumbnailProviderType.SPOLayoutsImage?(t.set("staticImage",{url:()=>Promise.resolve(r)}),t.set("stockImage",{url:()=>Promise.resolve(a),isFailureIcon:!0})):o===M._ThumbnailProviderType.MediaCDNHubble||o===M._ThumbnailProviderType.MediaCDNDefault||o===M._ThumbnailProviderType.MediaCDNLayoutsImage||o===M._ThumbnailProviderType.MediaCDNOptimalLayoutsImage?(t.set("optimalStaticImage",{url:()=>Promise.resolve(r)}),t.set("staticImage",{url:()=>Promise.resolve(i||n.spResource)}),t.set("stockImage",{url:()=>Promise.resolve(a),isFailureIcon:!0})):o===M._ThumbnailProviderType.External?(t.set("external",{url:()=>Promise.resolve(r)}),t.set("stockImage",{url:()=>Promise.resolve(a),isFailureIcon:!0})):(o===M._ThumbnailProviderType.Unknown&&d._TraceLogger.logError(sa,new Error(`_ThumbnailUrlGenerator is providing an unknown type of url for provider: ${o}`)),t.set("fullImage",{url:()=>Promise.resolve(r)}),t.set("stockImage",{url:()=>Promise.resolve(a),isFailureIcon:!0})),t}function da(e,t){return new Promise((n,a)=>function(e,t,n){if(!e)return!1;if((n=n||M._ThumbnailUrlGenerator.getThumbnailProvider(e))===M._ThumbnailProviderType.VROOMMeTACache){const n=t.consume(P.PageContext.serviceKey),a=new Yt.Uri(e),i=new Yt.Uri(n.web.absoluteUrl);if(!oa.has(e)){const t=n.legacyPageContext.multiGeoInfo;let i=!1;for(let e=0;e<t.length;e++){const n=new Yt.Uri(t[e].PortalUrl),r=new Yt.Uri(t[e].MySiteHostUrl);if(a.getHost()===n.getHost()||a.getHost()===r.getHost()){i=!0;break}}oa.set(e,i)}return Boolean(oa.get(e)&&a.getHost()!==i.getHost())}return!1}(t,e,M._ThumbnailProviderType.VROOMMeTACache)?function(e,t){if(!e)return Promise.resolve(void 0);const n=new Yt.Uri(e).getLeftPart(1),a=new ra.AadHttpClient(t,n,{configuration:D._AadTokenProviders.preAuthorizedConfiguration}),i=new Headers;i.append("accept","*/*");const r=new d._QosMonitor("CrossGeoThumbnail.getCrossGeoThumbnailUrl");return a.get(e,ra.AadHttpClient.configurations.v1,{headers:i}).then(e=>{if(e.status>=200&&e.status<300)return e.blob().then(e=>URL.createObjectURL(e)).catch(e=>{throw e});if(e.status<=308){const t=e.headers.get("location");if(t)return t}throw new Error(`Cross geo vroom thumbnail failure: ${e.status}`)}).catch(e=>{throw r.writeUnexpectedFailure("FailedToGet",e),e})}(t,e).then(e=>n(e)).catch(e=>a(e)):n(t))}const la=new Map,ua=e=>{const{callerId:t,cdnBaseUrls:n,onImageLoad:a,onImageLoadFailure:i,thumbnailWidth:r,thumbnailHeight:o,renderedInDetachedDOM:s,imgRef:l,disableBlobRevoke:u,cacheBuster:p,displayMode:m,..._}=e;let h=_;if(!$t()){const{imgRef:t,imageData:n,serviceScope:a,callerId:i,thumbnailWidth:r,thumbnailHeight:o,imageFit:s,cdnBaseUrls:c,failureIconUrl:d,getDefaultImage:l,onImageLoadFailure:u,onImageLoad:f,renderedInDetachedDOM:p,disableBlobRevoke:m,cacheBuster:_,displayMode:b,skipCustomerPromiseLogging:g,encodedImage:v,onInViewport:y,onLazyTimeout:S,...D}=e;h=D}const b=e.encodedImage||e.imageData?.encodedImage,[g,v]=c.useState(Boolean(b)),y=c.useMemo(()=>!(Zt()||!f._SPFlight.isEnabled(62395)&&1!==f._SPExperiment.getVariantAndLogExposure(90359)||!b),[b]),D=c.useCallback((e,t)=>{v(!1),a?.(e,t)},[a]),I=c.useCallback((e,t)=>{v(!1),i?.(e,t)},[i]),x={callerId:t,cdnBaseUrls:n,imageData:{imageUrl:e.imageData.imageUrl,uniqueId:e.imageData.uniqueId,listId:e.imageData.listId,webId:e.imageData.webId,siteId:e.imageData.siteId,cropData:e.imageData.cropData,imageNaturalHeight:e.imageData.imageNaturalHeight,imageNaturalWidth:e.imageData.imageNaturalWidth,cropMode:e.imageData.cropMode,cacheBuster:e.imageData.cacheBuster,encodedImage:b,openLinkInNewTab:e.imageData.openLinkInNewTab,disableLightBox:e.imageData.disableLightBox},serviceScope:e.serviceScope,thumbnailWidth:r,thumbnailHeight:o,failureIconUrl:e.failureIconUrl,getDefaultImage:e.getDefaultImage,cacheBuster:p,shouldForceFullImageSrc:e.shouldForceFullImageSrc},C=c.useMemo(()=>function(e,t){return!("RTEInlineImageCK5Edit"!==e||t&&yn())}(t,p),[t,p]),[O,w]=c.useState(C),E=C?JSON.stringify(e.imageData)+t+r+u:void 0,A=c.useMemo(()=>({src:E&&la.get(E),onLoad:y?D:a,onError:()=>{E&&la.delete(E),w(!1),v(!1)}}),[y?D:void 0]),L=f._SPKillSwitch.isActivated("4d254804-d735-4731-b679-7a31553b7c54")?function(e){const t=e.displayMode===f.DisplayMode.Edit?"SPImgRenderEdit":"SPImgRenderView",[n,a]=c.useState(void 0),i=c.useRef(void 0),r=c.useRef([]),o=c.useRef(void 0),s=c.useRef(null),l=c.useRef(void 0);c.useEffect(()=>{e.skipCustomerPromiseLogging||(s.current=new S.CustomerPromise({scenario:t,pillar:e.displayMode===f.DisplayMode.Edit?"Edit":"View"}))},[e.displayMode,e.skipCustomerPromiseLogging,t]);const u=c.useCallback((t,i)=>{l.current=void 0,void 0!==o.current&&async function(e,t,n){let a=n||t?.serviceName;const i=[];e.forEach((e,t)=>{a?a===t&&(a=void 0):i.push([t,e])});const r=window._preloadMetadata;if(r&&!Tn){Tn=!0;for(const e in r)e&&(r[e].isPreLoaded=!0,Pn[e]=r[e])}let o;for(const[e,n]of i)try{const a=await n.url();if("cdn"===e&&-1!==a?.indexOf(wn)&&-1===a?.indexOf(En))return{serviceName:e,src:a,httpRequest:void 0,duration:0,loadingError:{error:"Unexpected CDN request without auth token"},isPreLoaded:!1,provider:M._ThumbnailProviderType.PrivateCDN,originalSrc:a};if(a&&a!==t?.src){const t=tn()?await Fn(e,a,o):await Un(e,a,o);if(tn())return t;if(t&&!t.loadingError)return t;if(t?.loadingError){o={error:t.loadingError.error,statusCode:t.loadingError.statusCode,serviceName:e};continue}}}catch(t){d._TraceLogger.logError(Mn,t,"getValidNextState"),o=t&&"object"==typeof t&&"statusCode"in t?tn()?{error:t?.error,statusCode:t?.statusCode,serviceName:e}:{error:t?.error?Vn(t.error).message:jn(String(t.error)),statusCode:t?.statusCode,serviceName:e}:tn()?{error:t?.message||String(t),serviceName:e}:{error:t instanceof Error&&Vn(t).message||jn(String(t)),serviceName:e};continue}}(o.current,t,i).then(i=>{if(void 0===i||o?.current?.get(i?.serviceName)?.isFailureIcon){let a=t?.serviceName;const r={error:n?.loadingError?.error,statusCode:n?.loadingError?.statusCode};n?.loadingError?.error||(r.error=i?.lastSourceError?.error,r.statusCode=i?.lastSourceError?.statusCode,a=i?.lastSourceError?.serviceName),e.onImageLoadFailure?.(a,r)}a(i),i&&r.current.push(i.serviceName)}).catch(e=>{d._TraceLogger.logError(Mn,e,"tryNextService"),a(void 0)})},[e,n?.loadingError?.error,n?.loadingError?.statusCode]);c.useEffect(()=>()=>{!e.disableBlobRevoke&&n?.src?.startsWith("blob:")&&(URL.revokeObjectURL(n?.src),n?.originalSrc&&(Pn[n?.originalSrc].blobUrl=void 0))},[n?.src,n?.originalSrc]),c.useEffect(()=>{o.current=e.getServices(),r.current=[],u(void 0),i.current=new d._QosMonitor(`ImageElementRender.${e.callerId}`)},[e.thumbnailWidth&&M._PreviewUtility.normalizeWidth(e.thumbnailWidth),e.imageData.imageUrl,e.imageData.uniqueId,e.imageData.webId,e.imageData.listId,e.imageData.cropData,e.cacheBuster]);const p=c.useCallback(a=>{if(n?.serviceName){const i=e.displayMode===f.DisplayMode.Edit?"WebPart Edit Image Load Failure":"WebPart View Image Load Failure",r={scenario:t,resultType:a||n.loadingError?.statusCode&&vn(n.loadingError?.statusCode)?S.ResultTypeEnum.ExpectedFailure:S.ResultTypeEnum.Failure,veto:i,errorCode:`${e.callerId} thumbnail image failed to load`,extraData:{serviceName:n?.serviceName,error:n.loadingError?.error,statusCode:n.loadingError?.statusCode,Product:f._BrowserUtilities.getASHAProduct()}};s.current?.end(r)}},[e.callerId,e.displayMode,t,n?.serviceName,n?.loadingError?.error,n?.loadingError?.statusCode]),m=c.useCallback(t=>{if(!n)return;const{serviceName:a}=n;(function(e,t){let n,a=!1;for(const[i,r]of t||[]){if(a){n=!!r.isFailureIcon;break}if(e===i){if(r.isFailureIcon){n=!1;break}a=!0}}return!0===n})(a,o.current)&&!e.skipCustomerPromiseLogging&&p("external"===a),Cn(n,l.current,i,r,t,e.callerId),u(n,a)},[e.callerId,e.skipCustomerPromiseLogging,p,n,u]);return n?{src:n.src,onLoad:a=>{var c;if(!n)return;const{serviceName:u,src:p,httpRequest:m,provider:_,originalSrc:h}=n,b=M._ThumbnailUrlGenerator.getThumbnailWidth(h||p,_),g=`ImageElementRenderService.${M._ThumbnailProviderType[_]}`;(c=l).current||(c.current=new d._QosMonitor(g));const v=new Date,y=e.imageData.imageUrl?M._PreviewUtility.getFileExtension(new M._SPResourcePath(e.imageData.imageUrl))||"NA":void 0,D=m?.status||On(a);o?.current?.get(u)?.isFailureIcon||e.onImageLoad?.(a,u),xn(n,l.current,v,r.current,e.callerId,D,b,y,M._PreviewUtility.getClampedDevicePixelRatio()),In(n,r,b,D,i,y);const I=e.callerId;if(!e.skipCustomerPromiseLogging){const e={scenario:t,resultType:S.ResultTypeEnum.Success,extraData:{serviceName:u,Product:f._BrowserUtilities.getASHAProduct(),currentCallerId:I}};s.current?.end(e)}},onError:m}:{}}({onImageLoad:y?D:a,onImageLoadFailure:y?I:i,imageData:{imageUrl:e.imageData.imageUrl,uniqueId:e.imageData.uniqueId,listId:e.imageData.listId,webId:e.imageData.webId,siteId:e.imageData.siteId,cropData:e.imageData.cropData},callerId:t,thumbnailWidth:r,disableBlobRevoke:u,getServices:()=>ca(x),cacheBuster:p,displayMode:m,failureIconUrl:e.failureIconUrl,skipCustomerPromiseLogging:e.skipCustomerPromiseLogging}):function(e){const t=e.displayMode===f.DisplayMode.Edit?"SPImgRenderEdit":"SPImgRenderView",[n,a]=c.useState(void 0),i=c.useRef(void 0),r=c.useRef([]),o=c.useRef(void 0),s=c.useRef(null),l=c.useRef(void 0);c.useEffect(()=>{e.skipCustomerPromiseLogging||(s.current=new S.CustomerPromise({scenario:t,pillar:e.displayMode===f.DisplayMode.Edit?"Edit":"View"}))},[e.displayMode,e.skipCustomerPromiseLogging,t]);const u=c.useCallback((t,n)=>{l.current=void 0,void 0!==o.current&&async function(e,t,n){let a=n||t?.serviceName;const i=[];e.forEach((e,t)=>{a?a===t&&(a=void 0):i.push([t,e])});const r=window._preloadMetadata;if(r&&!Xn){Xn=!0;for(const e in r)e&&(r[e].isPreLoaded=!0,Jn[e]=r[e])}let o;for(const[e,n]of i)try{const a=await n.url();if("cdn"===e&&-1!==a?.indexOf(zn)&&-1===a?.indexOf(Gn))return{nextState:{serviceName:e,src:a,httpRequest:void 0,duration:0,loadingError:{error:"Unexpected CDN request without auth token"},isPreLoaded:!1,provider:M._ThumbnailProviderType.PrivateCDN,originalSrc:a}};if(a&&a!==t?.src){const t=await Zn(e,a,o);if(t&&!t.loadingError)return{nextState:t};if(t?.loadingError){o={error:t.loadingError.error,statusCode:t.loadingError.statusCode,serviceName:e};continue}}}catch(t){d._TraceLogger.logError(Yn,t,"getValidNextState"),o=aa(t,e);continue}return{nextState:void 0,lastSourceError:o}}(o.current,t,n).then(({nextState:n,lastSourceError:i})=>{if(void 0===n||o?.current?.get(n?.serviceName)?.isFailureIcon){const a=i||n?.lastSourceError,r={error:a?.error??t?.loadingError?.error,statusCode:a?.statusCode??t?.loadingError?.statusCode},o=a?.serviceName??t?.serviceName;e.onImageLoadFailure?.(o,r)}a(n),n&&r.current.push(n.serviceName)}).catch(e=>{d._TraceLogger.logError(Yn,e,"tryNextService"),a(void 0)})},[e]);c.useEffect(()=>()=>{!e.disableBlobRevoke&&n?.src?.startsWith("blob:")&&(URL.revokeObjectURL(n?.src),n?.originalSrc&&(Jn[n?.originalSrc].blobUrl=void 0))},[n?.src,n?.originalSrc]),c.useEffect(()=>{o.current=e.getServices(),r.current=[],u(void 0),i.current=new d._QosMonitor(`ImageElementRender.${e.callerId}`)},[e.thumbnailWidth&&M._PreviewUtility.normalizeWidth(e.thumbnailWidth),e.imageData.imageUrl,e.imageData.uniqueId,e.imageData.webId,e.imageData.listId,e.imageData.cropData,e.cacheBuster]);const p=c.useCallback(a=>{if(n?.serviceName){const i=e.displayMode===f.DisplayMode.Edit?"WebPart Edit Image Load Failure":"WebPart View Image Load Failure",r={scenario:t,resultType:a||n.loadingError?.statusCode&&vn(n.loadingError?.statusCode)?S.ResultTypeEnum.ExpectedFailure:S.ResultTypeEnum.Failure,veto:i,errorCode:`${e.callerId} thumbnail image failed to load`,extraData:{serviceName:n?.serviceName,error:n.loadingError?.error,statusCode:n.loadingError?.statusCode,Product:f._BrowserUtilities.getASHAProduct()}};s.current?.end(r)}},[e.callerId,e.displayMode,t,n?.serviceName,n?.loadingError?.error,n?.loadingError?.statusCode]),m=c.useCallback(t=>{if(!n)return;const{serviceName:a}=n;(function(e,t){let n,a=!1;for(const[i,r]of t||[]){if(a){n=!!r.isFailureIcon;break}if(e===i){if(r.isFailureIcon){n=!1;break}a=!0}}return!0===n})(a,o.current)&&!e.skipCustomerPromiseLogging&&p("external"===a),Cn(n,l.current,i,r,t,e.callerId),u(n,a)},[e.callerId,e.skipCustomerPromiseLogging,p,n,u]),_=c.useCallback(a=>{var c;if(!n)return;const{serviceName:u,src:p,httpRequest:m,provider:_,originalSrc:h}=n,b=M._ThumbnailUrlGenerator.getThumbnailWidth(h||p,_),g=`ImageElementRenderService.${M._ThumbnailProviderType[_]}`;(c=l).current||(c.current=new d._QosMonitor(g));const v=new Date,y=e.imageData.imageUrl?M._PreviewUtility.getFileExtension(new M._SPResourcePath(e.imageData.imageUrl))||"NA":void 0,D=m?.status||On(a);o?.current?.get(u)?.isFailureIcon||e.onImageLoad?.(a,u),xn(n,l.current,v,r.current,e.callerId,D,b,y,M._PreviewUtility.getClampedDevicePixelRatio()),In(n,r,b,D,i,y);const I=e.callerId;if(!e.skipCustomerPromiseLogging){const e={scenario:t,resultType:S.ResultTypeEnum.Success,extraData:{serviceName:u,Product:f._BrowserUtilities.getASHAProduct(),currentCallerId:I}};s.current?.end(e)}},[e,t,n]);return n?{src:n.src,onLoad:_,onError:m}:{}}({onImageLoad:y?D:a,onImageLoadFailure:y?I:i,imageData:{imageUrl:e.imageData.imageUrl,uniqueId:e.imageData.uniqueId,listId:e.imageData.listId,webId:e.imageData.webId,siteId:e.imageData.siteId,cropData:e.imageData.cropData},callerId:t,thumbnailWidth:r,disableBlobRevoke:u,getServices:()=>ca(x),cacheBuster:p,displayMode:m,failureIconUrl:e.failureIconUrl,skipCustomerPromiseLogging:e.skipCustomerPromiseLogging}),k=O&&A.src?A:L;E&&k.src&&la.set(E,k.src);const P=c.useCallback(e=>l?.(e),[l]),T=b?c.createElement(gn,{encodedImage:b,alt:h.alt,webPartName:t}):void 0,U=y&&g&&void 0!==T,F=f._BrowserDetection.getBrowserInformation().browser===f._Browser.IE;return!s||e.imageFit&&F?c.createElement(c.Fragment,null,U&&T,c.createElement(mn,{...h,...k,callerId:t,imgRefCallback:P,serviceScope:e.serviceScope,imageData:e.imageData})):e.imageFit?c.createElement(c.Fragment,null,U&&T,c.createElement("img",{...h,...k,ref:P,style:{...h.style,objectFit:e.imageFit,...Xt()?{}:qt(e.imageData.contentProvider)}})):c.createElement(c.Fragment,null,U&&T,c.createElement("img",{...h,...k,ref:P,style:{...h.style,...Xt()?{}:qt(e.imageData.contentProvider)}}))};var fa=n(529);const pa="data-sp-scroll-event-listener",ma="scroll",_a="resize";class ha{static get instance(){return void 0===ha._instance&&(ha._instance=new ha),ha._instance}unregister(e,t){f.Validate.isNotNullOrUndefined(t,"unregister callback function"),this._eventListeners.has(t)&&(this._eventListeners.delete(t),(this._scrollableParents&&this._scrollableParents.length?this._scrollableParents:this._findScrollableParents(e)).forEach((e,t,n)=>{this._updateRegisteredChildren(e,-1)<=0&&this._unlistenEvents(e)}),0===this._eventListeners.size&&this._unlistenEvents(window))}_scrollEventHandler(e){this._cachedClientRect&&!this._cacheExpired||(this._cachedClientRect=this._scrollableParents[this._scrollableParents.length-1].getBoundingClientRect(),this._cachedClientRectAge=Date.now()),this._eventListeners.forEach(t=>{t(e,this._cachedClientRect)})}_listenEvents(e){if(!e)return;const t=e===window;(!t||t&&!this._isListeningWindow)&&(this._addEventListener(e),t&&(this._isListeningWindow=!0))}_addEventListener(e){e.addEventListener(ma,this._lazyHandler,!1),e.addEventListener(_a,this._lazyHandler,!1)}_removeEventListener(e){e.removeEventListener(ma,this._lazyHandler),e.removeEventListener(_a,this._lazyHandler)}get _cacheExpired(){return Date.now()-this._cachedClientRectAge>=100}constructor(){this.register=(e,t,n)=>{this._scrollableParents&&this._scrollableParents.length||(this._scrollableParents=n?[n]:this._findScrollableParents(e)),this._scrollableParents.forEach((e,t,n)=>{1===this._updateRegisteredChildren(e,1)&&this._listenEvents(e)}),this._listenEvents(window),this._eventListeners.add(t)},this._findScrollableParents=e=>{const t=[];let n=e;for(;n;)n=ha._findScrollableParent(n),n&&(t.push(n),n=n.parentElement);return t.length?t:[document.body]},this._unlistenEvents=e=>{if(!e)return;const t=e===window;(!t||t&&this._isListeningWindow)&&(this._removeEventListener(e),t&&(this._isListeningWindow=!1))},this._updateRegisteredChildren=(e,t)=>{const n=t+Number(e.getAttribute(pa));return n>0?e.setAttribute(pa,n.toString()):e.removeAttribute(pa),n},this._eventListeners=new Set,this._isListeningWindow=!1,this._lazyHandler=fa.throttle(this._scrollEventHandler,10).bind(this)}}ha._findScrollableParent=e=>{let t=e;const n=document.body;for(;t&&t!==n;){if("true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}for(t=e;t&&t!==n;){const e=getComputedStyle(t);if(e){const n=e.getPropertyValue("overflow-y");if(n&&(n===ma||"auto"===n))return t}t=t.parentElement}return t&&t!==n||(t=void 0),t};class ba{static get instance(){return void 0===ba._instance&&(ba._instance=new ba),ba._instance}get isParallaxEnabled(){const e=f._BrowserDetection.getBrowserInformation();return e.browser!==f._Browser.Edge&&e.browser!==f._Browser.IE&&!f._BrowserUtilities.isWebViewHosted()}tryAddParallax(e){const t=this.isParallaxEnabled;if(t){f.Validate.isNotNullOrUndefined(e,"targetElement");const t=(0,l.findScrollableParent)(e),n=t===window?document.body:t;ha.instance.register(e,this._onScroll,n),this._parallaxElements.add(e),e.style.setProperty("will-change","transform")}return t}removeParallax(e){f.Validate.isNotNullOrUndefined(e,"targetElement"),this._parallaxElements.has(e)&&(this._parallaxElements.delete(e),ha.instance.unregister(e,this._onScroll),this._setTranslate(e,0),e.style.removeProperty("will-change"))}_setTranslate(e,t){const n="translate3d(0px,"+t+"px, 0px)";e.style.transform=n}constructor(){this._parallaxElements=new Set,this._parallaxFactor=1.81,this._onScroll=(e,t)=>{window.requestAnimationFrame(this._updateParallax.bind(this,t))},this._updateParallax=e=>{const t=e.top;this._parallaxElements.forEach(e=>{if(e.parentElement){const{top:n,bottom:a}=e.parentElement.getBoundingClientRect();if(n<t&&a>t){const a=Math.round((t-n)/this._parallaxFactor);this._setTranslate(e,a)}else n>=t&&this._setTranslate(e,0)}})}}}var ga=n(6065),va=n(3436);C.loadStyles(".p_-vqS3_Wr9CO{overflow:hidden}.b_a3PzL_Wr9CO{background-repeat:no-repeat;background-size:cover;height:100%}.b_a3PzL_Wr9CO.f_dC-sg_Wr9CO{position:relative}",!0);const ya="b_a3PzL_Wr9CO",Sa="f_dC-sg_Wr9CO",Da=(0,l.css)(ya,{[Sa]:!0});class Ia extends c.PureComponent{static applyParallax(e){const t=Ia._findBackgroundImage(e);t&&!t.hasAttribute("data-parallax")&&ba.instance.tryAddParallax(t)&&t.setAttribute("data-parallax","1")}static removeParallax(e){const t=Ia._findBackgroundImage(e);t&&t.hasAttribute("data-parallax")&&(ba.instance.removeParallax(t),t.removeAttribute("data-parallax"))}static _findBackgroundImage(e){if(!e)return;const t=Bt.findDOMNode(e);if(t&&t instanceof Element){const e=t.classList.contains(Da)?t:t.querySelector(`.${Da}`);return e instanceof HTMLElement?e:void 0}}UNSAFE_componentWillReceiveProps(e){this.props.focalPoint!==e.focalPoint&&this.setState({focalPoint:e.focalPoint})}render(){const e=c.createElement(L,{renderEditModeElements:this._renderEditModeElements,...this.props,focalPoint:this.state.focalPoint,style:this.props.style,className:(0,l.css)(ya,this.props.className,Sa),getDefaultImage:u.DefaultImageHelper.getDefaultImage,renderImageWithoutFallback:this.props.renderImageWithoutFallback,renderImageWithFallback:this.props.renderImageWithFallback});return this.props.ImageEffectWrapper?c.createElement(c.Fragment,null,c.createElement(this.props.ImageEffectWrapper,this.props,e),c.createElement(va.d,{editMode:this.props.editMode,renderEditMode:this._renderFocalPoint})):c.createElement(c.Fragment,null,e)}constructor(e){super(e),this._renderEditModeElements=()=>c.createElement(c.Fragment,null,c.createElement(va.d,{editMode:this.props.editMode,renderEditMode:this._renderUploadSpinner}),!this.props.ImageEffectWrapper&&c.createElement(va.d,{editMode:this.props.editMode,renderEditMode:this._renderFocalPoint})),this._renderUploadSpinner=e=>c.createElement(e.UploadSpinner,null),this._renderFocalPoint=e=>(0,ga.QJ)()||this.props.isFocalPointEnabled?c.createElement(e.FocalPoint,{position:this.state.focalPoint,onFocalPointMove:this._handleFocalPointMove,onFocalPointEnd:this._handleFocalPointEnd}):c.createElement(c.Fragment,null),this._handleFocalPointMove=e=>{this.setState({focalPoint:e})},this._handleFocalPointEnd=e=>{this.props.onChangeFocalPoint(this.state.focalPoint,e),u.SPFREUtility.dismissFRECallout("sp-fre-titleregion-5")},this.state={focalPoint:e.focalPoint}}}Ia.RenderImageWithoutFallback=e=>c.createElement(mn,e),Ia.RenderImageWithFallback=e=>c.createElement(ua,e);var xa=n(8391),Ca=n(8101);class Oa extends c.PureComponent{static get defaultImage(){return Gt.defaultImage}static getDefaultImage(e){return Gt.getDefaultImage(e)}componentWillUnmount(){this._asyncCount++}UNSAFE_componentWillReceiveProps(e){if(this.props.image.id!==e.image.id){if(this.setState({imageURL:Oa._cache.get(e.image.id)||"",fullSizeImageURL:Oa._fullsizeUrlCache.get(e.image.id)||""}),Oa._fullsizeUrlCache.has(e.image.id)){if(!Oa._cache.has(e.image.id)){const t=++this._asyncCount;this._reader.getImageURL(e).then(n=>{t===this._asyncCount&&(Oa._cache.set(e.image.id,n),this.setState({imageURL:n})),this._setFullSizeImageURL(e)}).catch(e=>{d._TraceLogger.logError(d._LogSource.create("TitleRegion"),e,"GetImageUrl")})}}else this._setFullSizeImageURL(e);this.props.image!==e.image&&this.setState({previousImage:this.props.image})}}render(){const e=void 0!==this.state.previousImage&&this.state.previousImage.type===x.y.ExternalImage&&this.props.image.type===x.y.SharePointImage&&""===this.state.imageURL,t=!(0,xa.IH)()&&this.state.previousImage?.id!==this.props.image?.id;return c.createElement(Ia,{...this.props,className:(0,l.css)((e||t)&&Kt.l.showClassName,this.props.className,!(0,xa.IH)()&&!e&&Kt.l.noSpinnerMessageClassName),imageURL:this.state.imageURL,fullSizeImageURL:this.state.fullSizeImageURL??this.state.imageURL,getDefaultImage:u.DefaultImageHelper.getDefaultImage,renderImageWithoutFallback:Ia.RenderImageWithoutFallback,renderImageWithFallback:Ia.RenderImageWithFallback,isAdvancedEditEnabled:!1,onCompleteFirstRender:(0,xa.IH)()?this.props.onCompleteFirstRender:this._handleImageLoadFinished})}constructor(e){super(e),this._asyncCount=0,this._handleImageLoadFinished=()=>{(0,xa.IH)()||((0,xa.rT)()||this.context?.completeComponentRender?.("BackgroundImage"),this.props.onCompleteFirstRender(),this.setState({previousImage:this.props.image}))},this._setFullSizeImageURL=e=>{this.setState({fullSizeImageURL:this._getFullSizeImageURL(e)})},this._getFullSizeImageURL=e=>{if(e.image.type===x.y.SharePointImage||e.image.type===x.y.ExternalImage){const t=this._reader.getFullSizeUrl(e);return Oa._fullsizeUrlCache.set(e.image.id,t),t}e.image.type!==x.y.LocalImage&&(e.image.type,x.y.DefaultImage)},this._reader=new Gt(e.serviceScope);let t=Oa._fullsizeUrlCache.get(e.image.id)||void 0,n=!1;if(Oa._fullsizeUrlCache.has(e.image.id))if(Oa._cache.has(e.image.id))this.props.onCompleteFirstRender(),n=!0;else{const t=++this._asyncCount;this._reader.getImageURL(e).then(n=>{this.props.onCompleteFirstRender(),t===this._asyncCount&&(Oa._cache.set(e.image.id,n),this.setState(t=>({imageURL:n,previousImage:(0,xa.Xr)()?t.previousImage:e.image}))),this._setFullSizeImageURL(this.props)}).catch(()=>{this.props.onCompleteFirstRender()})}else t=this._getFullSizeImageURL(e);this.state={imageURL:Oa._cache.get(e.image.id)||"",previousImage:!(0,xa.Xr)()&&n?e.image:void 0,fullSizeImageURL:t}}}Oa.contextType=Ca.m,Oa.applyParallax=Ia.applyParallax,Oa.removeParallax=Ia.removeParallax,Oa._cache=new Map,Oa._fullsizeUrlCache=new Map}
,1073:(e,t,n)=>{"use strict";n.d(t,{b:()=>f,w:()=>p});var a=n(5959),i=n(7408),r=n(3284),o=n(2141),s=n(4948),c=n(7466),d=n(7567);n(8424).loadStyles(".c_0RSS5_Wr9CO{box-sizing:border-box;width:100%}.h_yQubS_Wr9CO .c_0RSS5_Wr9CO{visibility:hidden}.c_paOVO_Wr9CO{box-sizing:border-box;display:flex;flex-direction:column;height:100%}.c_paOVO_Wr9CO.c_A0bnV_Wr9CO{margin-left:auto;margin-right:auto}@media screen and (max-width:639.99999px){[dir=ltr] .c_0RSS5_Wr9CO{padding-left:32px}[dir=ltr] .c_0RSS5_Wr9CO,[dir=rtl] .c_0RSS5_Wr9CO{padding-right:32px}[dir=rtl] .c_0RSS5_Wr9CO{padding-left:32px}.c_0RSS5_Wr9CO>.c_paOVO_Wr9CO{max-width:100%}}@media screen and (max-width:1023.99999px) and (min-width:640px){[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO{padding-left:32px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO,[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO{padding-left:32px}:not(.withVerticalSection) .c_0RSS5_Wr9CO>.c_paOVO_Wr9CO{max-width:1236px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-left:56px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-right:56px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}:not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO>.c_paOVO_Wr9CO{max-width:1180px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO,[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}:not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO>.c_paOVO_Wr9CO{max-width:1236px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-left:32px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO,[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-left:32px}:not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO>.c_paOVO_Wr9CO{max-width:1236px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO{padding-left:32px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO{padding-right:32px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO{padding-right:24px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO{padding-left:24px}.withVerticalSection .c_0RSS5_Wr9CO>.c_paOVO_Wr9CO{max-width:1236px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-left:56px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-right:56px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-right:32px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}.withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO>.c_paOVO_Wr9CO{max-width:1528px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO,[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-right:32px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}.withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO>.c_paOVO_Wr9CO{max-width:1236px}}@media screen and (min-width:1024px){[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO{padding-left:32px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO,[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO{padding-left:32px}:not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO>.c_paOVO_Wr9CO{max-width:1244px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO{padding-left:32px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO,[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO{padding-left:32px}:not(.withVerticalSection) .c_0RSS5_Wr9CO>.c_paOVO_Wr9CO{max-width:1199px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-left:56px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-right:56px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}:not(.withVerticalSection) .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO>.c_paOVO_Wr9CO{max-width:1180px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO,[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}:not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO>.c_paOVO_Wr9CO{max-width:1183px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-left:42px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-right:42px}[dir=ltr] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-left:32px}:not(.withVerticalSection) .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO>.c_paOVO_Wr9CO{max-width:1183px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO{padding-left:32px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO{padding-right:32px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO{padding-right:24px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO{padding-left:24px}.withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO>.c_paOVO_Wr9CO{max-width:1584px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO{padding-left:32px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO,[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO{padding-right:32px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO{padding-left:32px}.withVerticalSection .c_0RSS5_Wr9CO>.c_paOVO_Wr9CO{max-width:1579px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-left:56px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-right:56px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-right:32px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}.withVerticalSection .c_0RSS5_Wr9CO.o_Hxd-P_Wr9CO.e_0XCM3_Wr9CO>.c_paOVO_Wr9CO{max-width:1528px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO,[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-right:32px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO{padding-left:32px}.withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO>.c_paOVO_Wr9CO{max-width:1563px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-left:42px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-right:42px}[dir=ltr] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-right:32px}[dir=rtl] .withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO{padding-left:32px}.withVerticalSection .c_0RSS5_Wr9CO.e_0XCM3_Wr9CO.t_mW6gN_Wr9CO>.c_paOVO_Wr9CO{max-width:1574px}}",!0);var l=n(8391);function u(e){return d.O({ODB:60340},e,{killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"})}function f(e){const t=e.serviceScope.consume(i.PageContext.serviceKey),n=e.containerClassName?e.containerClassName:(0,o.css)("c_0RSS5_Wr9CO",(0,l.sF)()&&"o_Hxd-P_Wr9CO",e.editMode&&"e_0XCM3_Wr9CO",!(0,l.sF)()&&e.editMode&&!(0,c.S)(t)&&"t_mW6gN_Wr9CO");function d(){return s._StoreUtility.getState(e.serviceScope)?.chrome?.chromeOptions?.nav?.placement===r.jD.HORIZONTAL}const[f,p]=a.useState(d());function m(){const e=d();p(e)}a.useEffect(()=>s._StoreUtility.subscribe(e.serviceScope,m),[]);const _=(0,o.css)(e.className,"c_paOVO_Wr9CO",{c_A0bnV_Wr9CO:u(t.legacyPageContext)?f:(0,c.S)(t)});return a.createElement("div",{className:n},a.createElement("div",{className:_},e.children))}const p="h_yQubS_Wr9CO"}
,8140:(e,t,n)=>{"use strict";n.d(t,{b:()=>a.b});var a=n(1073)}
,3436:(e,t,n)=>{"use strict";n.d(t,{d:()=>d});var a=n(5592),i=n(8424),r=n(718),o=n(8414),s=n(5959),c=n(3724);class d extends s.Component{static import(){return d._bundle||(d._bundle=d._loadBundle().then(e=>(i.flush(),e))),d._bundle}static _loadBundle(){return(0,c.Nx)()?o.SPComponentLoader.loadComponentById("e1fb0d70-412c-460f-890c-c15ae40e5c89"):Promise.all([n.e(937),n.e(586),n.e(119),n.e(585)]).then(n.bind(n,1656))}componentWillUnmount(){this._hasUnmount=!0}UNSAFE_componentWillReceiveProps(e){!this.props.editMode&&e.editMode&&!this.state.module&&this._requestModule()}render(){return this.props.editMode&&this.state.module?this.props.renderEditMode(this.state.module,this.props):!!this.props.renderViewMode&&this.props.renderViewMode(this.props)}_requestModule(){d.import().then(e=>{this._hasUnmount||this.setState({module:e})}).catch(()=>{})}constructor(e){super(e),this._hasUnmount=!1,this.state={module:void 0},e.editMode&&this._requestModule()}}(0,a._ts_decorate)([(0,r.monitor)("TitleRegion.LoadEditModeBundle")],d,"_loadBundle",null)}
,9459:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r,B:()=>o});var a=n(2141),i=n(5959);function r(e){const t=(0,a.css)(e.className,"g_j-IZA_Wr9CO",e.useDarkerGradient&&"d_nHN7m_Wr9CO",e.disabled&&"d_2K089_Wr9CO");return i.createElement("div",{className:t,"data-automation-id":"gradientBox"},e.children)}n(8424).loadStyles(".g_j-IZA_Wr9CO{display:flex}.g_j-IZA_Wr9CO:not(.d_2K089_Wr9CO){background-color:transparent;background-image:linear-gradient(180deg,transparent 0,rgba(0,0,0,.6))}.g_j-IZA_Wr9CO:not(.d_2K089_Wr9CO).d_nHN7m_Wr9CO{background-color:transparent;background-image:linear-gradient(180deg,transparent 0,rgba(0,0,0,.8))}.h_JnC9X_Wr9CO .g_j-IZA_Wr9CO{display:none}",!0);const o="h_JnC9X_Wr9CO"}
,1231:(e,t,n)=>{"use strict";n.d(t,{Q:()=>a.Q});var a=n(9459)}
,4656:(e,t,n)=>{"use strict";n.d(t,{U4:()=>o,a5:()=>l,aJ:()=>d,vp:()=>c});var a=n(2141),i=n(8391),r=n(9282);const o=e=>({primaryColor:{color:`${e?.palette?.neutralPrimary} !important`},secondaryColor:{color:`${e?.palette?.neutralSecondary} !important`},titleTextColor:{selectors:{"&#title_text":{color:`${e?.palette?.neutralPrimary} !important`},"&::placeholder":{color:`${e.semanticColors?.bodySubtext} !important`}}},authorByLine:{}}),s=e=>{const t=function(e){return(0,i.hA)()?e?.palette?.white:"#ffffff"}(e),n=(0,i.jM)()?.25:.7;return{primaryColor:{color:`${t} !important`,textShadow:`1px 1px 4px rgba(0, 0, 0, ${n})`},secondaryColor:{color:`${t} !important`,textShadow:`1px 1px 4px rgba(0, 0, 0, ${n})`},authorByLine:{".peopleName,.peopleRole":{color:t,textShadow:`1px 1px 4px rgba(0, 0, 0, ${n})`}},titleTextColor:{selectors:{"&#title_text":{color:`${t} !important`,textShadow:`1px 1px 4px rgba(0, 0, 0, ${n})`},...(0,r.I)()?{"&&::placeholder":{color:t}}:{"&::placeholder":{color:`${t} !important`}}}}}},c=(0,a.classNamesFunction)();function d(e){return e&&c(s,e)}function l(e){return e.variantTheme&&c(o,e.variantTheme)}}
,6768:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var a=n(5959);const i=a.lazy(()=>n.e(650).then(n.bind(n,5514)).then(e=>({default:e.PublishDate})));function r(e){return a.createElement(a.Suspense,{fallback:!1},a.createElement(i,e))}}
,8509:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a.Z});var a=n(6768)}
,3248:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});var a=n(5959);const i=a.lazy(()=>n.e(417).then(n.bind(n,306)).then(e=>({default:e.TimeToRead})));function r(e){return a.createElement(a.Suspense,{fallback:!1},a.createElement(i,e))}}
,795:(e,t,n)=>{"use strict";n.d(t,{AA:()=>i,dS:()=>r});var a=n(2141);function i(e){const t=(0,a.getTheme)();return(0,a.mergeStyles)({cursor:"pointer",textDecoration:"underline",backgroundColor:t.palette.neutralLighter,":hover":{color:t.palette.themeDark,backgroundColor:t.palette.themeLighter}},e??!1)}function r(e=!1){const t=(0,a.getTheme)();return(0,a.mergeStyles)({backgroundColor:o(t.palette.themePrimary,.5),":hover":{color:t.palette.white,backgroundColor:o(t.palette.themePrimary,.75)},...e&&{"@media (max-width: 640px)":{backgroundColor:t.palette.neutralLighter,":hover":{color:t.palette.themeDark,backgroundColor:t.palette.themeLighter}}}})}function o(e,t){return"#"!==e[0]?e:`rgba(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)}, ${t})`}}
,1520:(e,t,n)=>{"use strict";n.d(t,{a:()=>C});var a=n(2141),i=n(718),r=n(7405);class o{}o.topicViewerConfirmedTopicsLogPrefix="CSKIM.TopicViewer.ConfirmedTopics.DP",o.topicViewerUnconfirmedTopicsLogPrefix="CSKIM.TopicViewer.UnconfirmedTopics.DP",o.topicViewerExcludedTopicsLogPrefix="CSKIM.TopicViewer.ExcludedTopics.DP",o.topicPagePreviewStubFileName="TopicPagePreview.aspx",o.createTopicPageStubFileName="CreateTopicPage.aspx",o.newPageStubFileName="newpage.aspx",o.disambiguationPageStubFileName="TopicDisambiguation.aspx",o.topicCacheDuration=864e5,o.kmTopicIdAttribute="data-sp-topic-id",o.kmHashtaggedTopicIdAttribute="data-sp-hashtagged-topic-id",o.kmTopicCardAttribute="data-sp-topic-card",o.kmAnnotateLogPrefix="CSIKM.Annotate",o.kmTopicPickerLogPrefix="CSIKM.TopicPicker",o.kmTopicCenterLogPrefix="CSIKM.TopicCenter",o.kmFeedbackLogPrefix="CSIKM.Feedback",o.kmTopicCardLogPrefix="CSIKM.TopicCard",o.kmTopicPageLogPrefix="CSIKM.TopicPage",o.kmTopicCacheLogPrefix="CSIKM.TopicCache",o.timeZoneStartIndexInDatetime=19,o.pageVersionParam="version",o.pageVersionCompareFromParam="versionCompareFrom",o.pageVersionCompareToParam="versionCompareTo",o.currentTopicLoadedEvent="CurrentTopicLoadedEvent",o.topicMergeStatusUpdateEvent="TopicMergeStatusUpdateEvent",o.gptVersion="gptVersion",o.ascending=1,o.descending=2,o.onAnnotateTitleEventName="onAnnotateTitle_Cortex",o.topicNameChangeEventName="TopicNameChangedEvent_Cortex",o.showTopicPublishTeachingBubbleEventName="ShowTopicPublishTeachingBubble_Cortex",window.innerWidth;var s=n(9676);function c(){return s._SPFlight.isEnabled(1442)}n(1506);var d=n(5959),l=n(3436),u=n(647);n(8424).loadStyles('.t_Tl6QD_Wr9CO{word-wrap:break-word;font-size:24px;line-height:1.35;outline:none;padding:0 0 3px;width:100%;word-break:break-word}.t_Tl6QD_Wr9CO.c_AO9-I_Wr9CO{text-align:center}.t_Tl6QD_Wr9CO:not(.f_fz9gc_Wr9CO){font-weight:300}.t_Tl6QD_Wr9CO.f_fz9gc_Wr9CO{font-size:"[theme:xxLargePlusFontSize, default: 32px]";font-weight:"[theme:xxLargePlusFontWeight, default: 600]"}@media screen and (min-width:480px){.t_Tl6QD_Wr9CO{font-size:28px}}@media screen and (min-width:640px){.t_Tl6QD_Wr9CO{font-size:32px}}.t_bbUi8_Wr9CO{color:"[theme:black, default: #000000]"}.t_bbUi8_Wr9CO:-ms-input-placeholder{color:"[theme:neutralSecondary, default: #605e5c]"}.t_bbUi8_Wr9CO::placeholder{color:"[theme:neutralSecondary, default: #605e5c]"}.r_-D03v_Wr9CO .ck-content *{text-align:center!important}.r_9T4fI_Wr9CO{display:flex;margin-bottom:0!important}.r_9T4fI_Wr9CO .rte--ck5{width:100%}.r_9T4fI_Wr9CO .rte--ck5 .ck-content{-webkit-line-clamp:var(--rte-content-lineclamp);line-clamp:var(--rte-content-lineclamp);-webkit-box-orient:vertical;display:-webkit-box;max-height:var(--rte-content-maxheight)!important;overflow:hidden!important}.r_9T4fI_Wr9CO .rte--ck5 .ck-content .fontSizeXLarge{font-size:var(--rteTitleBannerFontSize)!important}',!0);var f=n(795),p=n(8417),m=n(1001),_=n(606),h=n(9930);const b=(0,_.makeStyles)({header:{"&.captionElement":{"& #CaptionElementView":{...h.typographyStyles.custom.webPartHeader,fontFamily:`var(--fontFamilyCustomFont1300, ${_.typographyStyles.subtitle1.fontFamily})`,fontWeight:`var(--fontWeightCustomFont1300, ${_.typographyStyles.subtitle1.fontWeight})`},"& #CaptionElementEdit":{...h.typographyStyles.custom.webPartHeader,fontFamily:`var(--fontFamilyCustomFont1300, ${_.typographyStyles.subtitle1.fontFamily})`,fontWeight:`var(--fontWeightCustomFont1300, ${_.typographyStyles.subtitle1.fontWeight})`}}},multipleHeader:{"&.captionElement":{"& .headingLevel-2":{...h.typographyStyles.custom.title2},"& .headingLevel-3":{...h.typographyStyles.custom.title3},"& .headingLevel-4":{...h.typographyStyles.custom.subtitle1}}},multipleHeaderUpdated:{"&.captionElement":{"& .headingLevel-2":{...h.typographyStyles.custom.heading2},"& .headingLevel-3":{...h.typographyStyles.custom.heading3},"& .headingLevel-4":{...h.typographyStyles.custom.heading4},"& .headingLevel":{fontFamily:`var(--fontFamilyCustomFont1300, ${_.typographyStyles.subtitle1.fontFamily})`}}}});var g=n(8391),v=n(8101);const y=(0,_.makeStyles)({header:{display:"contents","& #title_text":{...h.typographyStyles.custom.title1,fontFamily:`var(--fontFamilyCustomFont1600, ${_.typographyStyles.title1.fontFamily})`,fontWeight:`var(--fontWeightCustomFont1600, ${_.typographyStyles.title1.fontWeight})`,"&.ms-colorBlockLayout":{...h.typographyStyles.custom.title3,fontFamily:`var(--fontFamilyCustomFont1600, ${_.typographyStyles.title3.fontFamily})`,fontWeight:`var(--fontWeightCustomFont1600, ${_.typographyStyles.title3.fontWeight})`}}},customHeadingLevel:{display:"contents",height:"100%"}});function S(e){const{children:t,headingLevel:n}=e,{isHeadingLevelEnabled:a}=d.useContext(v.m),i=y(),r=b();return d.createElement("div",{className:a&&n?(0,_.mergeClasses)(r.multipleHeaderUpdated,i.customHeadingLevel,"captionElement"):i.header,...(0,g.P)()?{}:{"data-is-visible":!0}},t)}var D=n(8464),I=n(9282),x=n(8919);class C extends d.PureComponent{componentDidMount(){window.addEventListener("resize",this._handleWindowResize),c()&&(0,i.isCortexEnabled)(this.props.pageContext)&&((0,g.r0)()||this.context.positionOnPage&&(0,D.b)(this.context.positionOnPage))&&document.addEventListener(o.onAnnotateTitleEventName,this._handleAnnotateTitle)}componentWillUnmount(){window.removeEventListener("resize",this._handleWindowResize),c()&&(0,i.isCortexEnabled)(this.props.pageContext)&&((0,g.r0)()||this.context.positionOnPage&&(0,D.b)(this.context.positionOnPage))&&document.removeEventListener(o.onAnnotateTitleEventName,this._handleAnnotateTitle)}render(){const e=!(0,g.MD)()&&!s._SPKillSwitch.isActivated("abc5ca03-f7c8-4d79-b7eb-6ba83b43a929")&&s._SPFlight.isEnabled(62620)&&!this.props.forcePlainTextTitle;return d.createElement(l.d,{editMode:this.props.editMode,renderEditMode:e?this._renderNPXTextCoherencyTitle:this._renderEditMode,renderViewMode:e?this._renderNPXTextCoherencyTitle:this._renderViewMode})}_renderTitleWithTruncation(e){const t=(0,a.mergeStyles)(this._textClassName,function(e,t=1.35){let n;if("number"==typeof t)n=e*t+"em";else try{const a=e*Number(t.substr(0,t.length-2));if(isNaN(a))throw new Error("Invalid line height input");n=`${a}px`}catch(e){throw new e("Invalid line-height input format")}return{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":e.toString(),boxSizing:"content-box",maxHeight:n,textOverflow:1===e?"ellipsis":void 0}}(e));return d.createElement(S,{headingLevel:this._ariaLevel},d.createElement("div",{className:t,role:"heading","aria-level":this._ariaLevel,title:this.props.title,"data-automation-id":"TitleTextId",style:this._titleTextStyle,lang:this.props.culture,id:"title_text"},this._renderTitle()))}get _textClassName(){const e=(t=this.props.variantTheme||(0,a.getTheme)(),(0,I.I)()?(0,a.mergeStyleSets)({text:{color:t.palette?.black,"&::placeholder":{color:t.palette?.neutralSecondary}}}):{text:void 0});var t;return(0,a.mergeStyles)(this.props.className,this.props.alignment===u.q.Center&&"c_AO9-I_Wr9CO","t_Tl6QD_Wr9CO",!(0,I.I)()&&"t_bbUi8_Wr9CO","f_fz9gc_Wr9CO",this.context.isHeadingLevelEnabled&&`headingLevel-${this._ariaLevel}`,e.text,{position:"relative",width:"100%"})}get _isInMobileView(){return window.innerWidth<640}get _doesSiteHeaderExist(){return!!document.getElementById("spSiteHeader")}get _ariaLevel(){return this._isTopFullWidthBanner?1:this.context.isHeadingLevelEnabled&&this.context.headingLevel?this.context.headingLevel:r._DEFAULT_HEADING_LEVEL}get _isTopFullWidthBanner(){return(0,D.b)(this.context.positionOnPage)}_renderTitle(){const e=!this.props.title&&this.props.editMode?this._isTopFullWidthBanner?m.z_:m.r9:void 0;return c()&&this.state.annotatedTitle?d.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.annotatedTitle}}):d.createElement(d.Fragment,null,this.props.title||e)}get _titleTextStyle(){let e;return this.state.isInMobileView&&!this.state?.doesSiteHeaderExist&&(e=`${this._titleTextPadding}px`),this.props.largeFontSize&&!this.context.isHeadingLevelEnabled?{fontSize:a.FontSizes.size42,lineHeight:1.35,paddingTop:e}:{paddingTop:e}}get _titleTextPadding(){const{y:e}=(t=this.props.focalPoint,(0,p.c)(t));var t;return this._isTallImage?e/100*this._actualHeight:0}get _isTallImage(){return!!(this.props.imageSize&&this.props.width&&this.props.requestedHeight)&&this.props.imageSize.width/this.props.width<this.props.imageSize.height/this.props.requestedHeight}get _actualHeight(){return this.props.imageSize?this.props.imageSize.height*((this.props.width||0)/this.props.imageSize.width)-(this.props.requestedHeight||0):0}constructor(e){super(e),this._renderNPXTextCoherencyTitle=()=>{const e=this.props.editMode?this._isTopFullWidthBanner?m.z_:m.r9:void 0,t=c()&&this.state.annotatedTitle?this.state.annotatedTitle:this.props.htmlTitle,n={paddingTop:this.state.isInMobileView&&!this.state?.doesSiteHeaderExist?`${this._titleTextPadding}px`:void 0,"--rteTitleBannerFontSize":this.props.largeFontSize&&!this.context.isHeadingLevelEnabled?a.FontSizes.size42:a.FontSizes.size32,lineHeight:this.props.largeFontSize&&!this.context.isHeadingLevelEnabled?1.35:void 0};return d.createElement(S,{headingLevel:this._ariaLevel},d.createElement("div",{className:this._textClassName,tabIndex:-1,role:"heading","aria-level":this._ariaLevel,"data-automation-id":"TitleTextId",style:n,lang:this.props.culture,id:"title_text"},d.createElement(x.WebPartTitle,{edit:this.props.editMode,title:t,placeholder:e,onTitleChange:e=>{this.props.onChangeHTMLTitle?.(e,(0,x.getPlainTextFromHTML)(e)),i.SPFREUtility.dismissFRECallout("sp-fre-titleregion-2")},theme:(0,a.getTheme)(),marginBottomSize:"Large",useRTETitle:!0,dataAutomationId:"pageTitleInput",disableStyleWrapper:!0,maxLength:110,fontSizes:[10,12,14,16,18,20,24,28,32,36,42],serviceScope:this.props.serviceScope,headingLevel:this._ariaLevel,className:(0,a.css)("title-region-rte-hero-title","r_9T4fI_Wr9CO",this.props.alignment===u.q.Center?"r_-D03v_Wr9CO":"")}),d.createElement("div",{"data-sp-fre-id":"sp-fre-titleregion-2","data-offset-left":"296px","data-offset-top":"calc(50% - 12px)"})))},this._renderEditMode=e=>{let t=this._isTopFullWidthBanner?m.z_:m.r9;return this.props.placeholderOverride&&(t=this.props.placeholderOverride),d.createElement(S,{headingLevel:this._ariaLevel},d.createElement(e.TitleInput,{...this.props,className:this._textClassName,titlePlaceholder:t,largeFontSize:this.props.largeFontSize&&!this.context.isHeadingLevelEnabled,headingLevel:(0,g.t2)()?void 0:this._ariaLevel}))},this._renderViewMode=()=>this.props.maxLines?this._renderTitleWithTruncation(this.state.isInMobileView&&this.props.maxLines>=3?3:this.props.maxLines):d.createElement(S,{headingLevel:this._ariaLevel},d.createElement("span",{className:this._textClassName,tabIndex:-1,role:"heading","aria-level":this._ariaLevel,"data-automation-id":"TitleTextId",style:this._titleTextStyle,lang:this.props.culture,id:"title_text"},this._renderTitle())),this._handleAnnotateTitle=e=>{const t=this._addAttributeToAnnotation(e.detail);this.setState({annotatedTitle:t})},this._addAttributeToAnnotation=e=>{const t=document.createElement("div");t.innerHTML=e;const n=t.querySelectorAll(`[${o.kmTopicIdAttribute}]`);return n&&(n.forEach(e=>{-1!==e.tabIndex&&(e.className=(0,f.AA)(this.props.annotationClassName))}),e=t.innerHTML),t.parentElement?.removeChild(t),e},this._handleWindowResize=()=>{this.state.isInMobileView!==this._isInMobileView&&this.setState({isInMobileView:this._isInMobileView,doesSiteHeaderExist:this._doesSiteHeaderExist})},this.state={isInMobileView:this._isInMobileView,annotatedTitle:void 0,doesSiteHeaderExist:this._doesSiteHeaderExist}}}C.contextType=v.m}
,8855:(e,t,n)=>{"use strict";n.d(t,{a:()=>a.a,j:()=>i.dS});var a=n(1520),i=n(795)}
,1600:(e,t,n)=>{"use strict";function a(e){switch(e){case"Author":case"NoImage":case"NoImageEmail":case"NoImageTeams":case"NoImageVivaEngage":case"TeamsCustom":return{enablePropertyPane:!0,enableImageEditing:!1};case"ColorBlock":case"CutInShape":case"Fade":case"FullWidthImage":case"FullWidthImageEmail":case"FullWidthImageVivaEngage":case"ImageTeams":case"ImageEngage":return{enablePropertyPane:!0,enableImageEditing:!0};case"Event":case"EventNoImage":return{enablePropertyPane:!1,enableImageEditing:!0};default:return{enablePropertyPane:!1,enableImageEditing:!1}}}n.d(t,{e:()=>a})}
,2158:(e,t,n)=>{"use strict";n.d(t,{f:()=>u});var a=n(5959),i=n(2141),r=n(606),o=n(9930),s=n(647);n(8424).loadStyles('.c_veh2K_Wr9CO{display:flex;justify-content:flex-start}.c_veh2K_Wr9CO.c_bglaj_Wr9CO{justify-content:space-around}.t_HFlKV_Wr9CO{word-wrap:normal;background-color:"[theme:accent, default: #0078d4]";color:"[theme:white, default: #ffffff]";font-size:11px;font-weight:400;font-weight:600;letter-spacing:1px;max-width:294px;overflow:hidden;padding:4px 12px;text-overflow:ellipsis;text-transform:uppercase;white-space:nowrap}.t_HFlKV_Wr9CO.f_WIRdV_Wr9CO{border-radius:"[theme:roundedCorner2, default: 2px]"}',!0);var c=n(9282),d=n(8391);const l=(0,r.makeStyles)({root:{"&.topicHeaderText":{...o.typographyStyles.custom.caption1Strong}}});function u(e){const t=l(),n=(r=e.variantTheme||(0,i.getTheme)(),(0,i.mergeStyleSets)({text:r.palette&&{"&.topicHeaderText":{color:(0,d.fw)()?r.palette.white:o.tokens.colorNeutralForegroundOnBrand,backgroundColor:(0,d.fw)()?r.palette.accent:o.tokens.colorBrandBackground}}}));var r;const u=(0,i.css)("c_veh2K_Wr9CO",e.alignment===s.q.Center&&"c_bglaj_Wr9CO",e.className);if(e.value.trim()){const r=(0,i.css)("t_HFlKV_Wr9CO","f_WIRdV_Wr9CO",(0,c.I)()&&n.text,t.root,"topicHeaderText");return a.createElement("div",{className:u,"data-alignment":e.alignment.toString(),"data-automation-id":"topicHeader"},a.createElement("span",{className:r,title:e.value,"data-automation-id":"topicHeaderText"},e.value))}return a.createElement(a.Fragment,null)}}
,7379:(e,t,n)=>{"use strict";n.d(t,{f:()=>a.f});var a=n(2158)}
,733:(e,t,n)=>{"use strict";n.d(t,{AN:()=>l,Cv:()=>r,EI:()=>b,GN:()=>m,LE:()=>p,NM:()=>d,Rm:()=>g,SJ:()=>i,Sc:()=>_,Sp:()=>c,Vm:()=>f,Wh:()=>o,em:()=>s,gT:()=>h,p3:()=>u,rx:()=>a});const a=300,i=480,r=640,o=1024,s=1920,c=300,d=320,l=450,u=450,f=280,p=150,m=150,_=228,h=265,b=280,g=300}
,2854:(e,t,n)=>{"use strict";n.d(t,{Y3:()=>d,mR:()=>s,wU:()=>c});var a=n(2207),i=n(8464),r=n(8391);const o={"ja-jp":{charactersPerMinute:550,characterRegex:/[\u3040-\u30FF\u4E00-\u9FFF]/g},"ko-kr":{charactersPerMinute:550,characterRegex:/[\uAC00-\uD7A3]/g},"th-th":{charactersPerMinute:400,characterRegex:/[\u0E00-\u0E7F]/g},"zh-cn":{charactersPerMinute:450,characterRegex:/[\u4e00-\u9fff]/g},"zh-tw":{charactersPerMinute:450,characterRegex:/[\u4e00-\u9fff]/g}},s=e=>"Article"===e,c=(e,t)=>!!e&&s(e.pageLayoutType)&&!!e.promotedState&&e.promotedState>0&&(0,i.b)(t),d=(e,t,n)=>{if(!e)return;let i=t;n&&n.isTranslation&&(i=n.translationLanguage);const s=(e.htmlContentList||[]).reduce((e,t)=>t?e+((e,t)=>{try{const n=(new DOMParser).parseFromString(e,"text/html").body.textContent||"";let a=0;const i=o[(0,r.qI)()?t:t.toLowerCase()];if(i){const e=(n.match(i.characterRegex)||[]).length;a=Math.ceil(e/i.charactersPerMinute*60)}else{const e=n.split(" ").length||0;a=Math.ceil(e/250*60)}return a}catch(e){return a._TraceLogger.logError(a._LogSource.create("TitleRegion"),e,"calculateTimeToReadInSecs"),0}})(t,i):e,0);return Math.ceil(s/60)}}
,8101:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});const a=n(5959).createContext({})}
,1635:(e,t,n)=>{"use strict";n.d(t,{J:()=>r,X:()=>o});var a=n(718),i=n(1600);function r(e){return!!(e?(0,i.e)(e):void 0)?.enableImageEditing}function o(e){return r(e)?a.CustomContentDropSupport.externalLink:a.CustomContentDropSupport.disabled}}
,7466:(e,t,n)=>{"use strict";n.d(t,{S:()=>a.S});var a=n(839);n(1635)}
,839:(e,t,n)=>{"use strict";function a(e){const t=e._featureInfo.get("SitePagePublishing");return!!t&&t.enabled}n.d(t,{S:()=>a})}
,2549:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});var a=n(733);function i(e,t=a.Wh){return void 0!==e&&e<t}}
,8464:(e,t,n)=>{"use strict";function a(e){if(e){const{componentOrder:t,sectionFactor:n}=e;return 0===t&&0===n}return!0}n.d(t,{b:()=>a})}
,9928:(e,t,n)=>{"use strict";n.d(t,{n:()=>s,r:()=>o});var a=n(3724),i=n(733),r=n(2549);function o(e){return(0,a.u0)()&&(0,r.g)(e,i.Cv)}function s(){return"undefined"!=typeof window&&window.innerWidth<i.Cv}}
,9282:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});var a=n(3724),i=n(1717);const r=()=>(0,a.F)()&&(0,i.isCurrentThemeV2)()}
,2363:(e,t,n)=>{"use strict";n.d(t,{A:()=>a}),n(8424).loadStyles(".a_O6lBk_Wr9CO{display:flex}.a_O6lBk_Wr9CO,.a_O6lBk_Wr9CO.l_xbl9s_Wr9CO{justify-content:flex-start}.a_O6lBk_Wr9CO.c_buk-6_Wr9CO{justify-content:center}.a_O6lBk_Wr9CO.f_5WiRh_Wr9CO{min-height:42px}.p_qvTmp_Wr9CO{padding:0!important}",!0);const a={authorByline:"a_O6lBk_Wr9CO",leftAlign:"l_xbl9s_Wr9CO",centerAlign:"c_buk-6_Wr9CO",fixedHeight:"f_5WiRh_Wr9CO",peopleSearcher:"p_qvTmp_Wr9CO"}}
,8579:(e,t,n)=>{"use strict";n.d(t,{A:()=>a}),n(8424).loadStyles('.c_fSh0V_Wr9CO{background:transparent;border:1px solid transparent;display:inline-flex;max-width:100%;outline:none}.c_fSh0V_Wr9CO.c_XIp96_Wr9CO{text-align:center}.c_fSh0V_Wr9CO.l_VfzHh_Wr9CO,[dir=ltr] .c_fSh0V_Wr9CO.c_XIp96_Wr9CO.e_Nsme8_Wr9CO{padding-left:32px}[dir=rtl] .c_fSh0V_Wr9CO.c_XIp96_Wr9CO.e_Nsme8_Wr9CO{padding-right:32px}.c_fSh0V_Wr9CO.e_Nsme8_Wr9CO:hover .d_JBr6Y_Wr9CO.h_fmDya_Wr9CO,.c_fSh0V_Wr9CO:focus .d_JBr6Y_Wr9CO.h_fmDya_Wr9CO{visibility:visible}.c_fSh0V_Wr9CO.e_Nsme8_Wr9CO:hover .d_JBr6Y_Wr9CO:not(.h_fmDya_Wr9CO),.c_fSh0V_Wr9CO:focus .d_JBr6Y_Wr9CO:not(.h_fmDya_Wr9CO){display:block}.c_6ftB3_Wr9CO.e_Nsme8_Wr9CO:hover,.c_6ftB3_Wr9CO:focus{background:"[theme:neutralLighterAlt, default: #faf9f8]";border-color:"[theme:neutralTertiaryAlt, default: #c8c6c4]"}.c_6ftB3_Wr9CO.e_Nsme8_Wr9CO:hover .p_x3vTs_Wr9CO,.c_6ftB3_Wr9CO:focus .p_x3vTs_Wr9CO{color:"[theme:neutralPrimary, default: #323130]"!important}.c_6ftB3_Wr9CO.e_Nsme8_Wr9CO:hover .s_AbEpD_Wr9CO,.c_6ftB3_Wr9CO:focus .s_AbEpD_Wr9CO{color:"[theme:neutralSecondary, default: #605e5c]"!important}.c_zaRWG_Wr9CO.e_Nsme8_Wr9CO:hover,.c_zaRWG_Wr9CO:focus{position:relative}.c_zaRWG_Wr9CO.e_Nsme8_Wr9CO:hover:after,.c_zaRWG_Wr9CO:focus:after{border:2px solid "[theme:neutralsecondaryalt, default: #8a8886]";bottom:-4px;content:"";left:-4px;pointer-events:none;position:absolute;right:-4px;top:-4px}.b_i0ktb_Wr9CO{display:flex;flex-direction:column}.b_i0ktb_Wr9CO .d_JBr6Y_Wr9CO.h_fmDya_Wr9CO{visibility:hidden}.b_i0ktb_Wr9CO .d_JBr6Y_Wr9CO:not(.h_fmDya_Wr9CO){display:none}.b_n9OYX_Wr9CO .d_JBr6Y_Wr9CO{color:"[theme:black, default: #000000]"}.p_f5Q10_Wr9CO{color:"[theme:neutralPrimary, default: #323130]";font-size:14px}.s_1Upbx_Wr9CO{color:"[theme:neutralSecondary, default: #605e5c]";font-size:12px}.p_x3vTs_Wr9CO,.s_AbEpD_Wr9CO{display:block;font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@media screen and (min-width:640px){.w_Vszg2_Wr9CO .p_x3vTs_Wr9CO,.w_Vszg2_Wr9CO .s_AbEpD_Wr9CO{color:#fff}}.t_il03P_Wr9CO .p_x3vTs_Wr9CO,.t_il03P_Wr9CO .s_AbEpD_Wr9CO{color:"[theme:white, default: #ffffff]"}.p_eGjvZ_Wr9CO{align-items:center;cursor:pointer;display:inline-flex;height:40px;min-width:0}.p_eGjvZ_Wr9CO:focus{outline:none}.p_eGjvZ_Wr9CO .p_B1rzv_Wr9CO{flex:0 0 auto}.p_eGjvZ_Wr9CO .p_PH64v_Wr9CO{min-width:0;padding:0 12px;width:100%}',!0);const a={card:"c_fSh0V_Wr9CO",center:"c_XIp96_Wr9CO",leftPlaceholder:"l_VfzHh_Wr9CO",editMode:"e_Nsme8_Wr9CO",deleteButton:"d_JBr6Y_Wr9CO",holdSpace:"h_fmDya_Wr9CO",cardWithPageColor:"c_6ftB3_Wr9CO",primaryText:"p_x3vTs_Wr9CO",secondaryText:"s_AbEpD_Wr9CO",cardFocusIndicatorImprovedContrastRatio:"c_zaRWG_Wr9CO",buttons:"b_i0ktb_Wr9CO",buttonsWithPageColor:"b_n9OYX_Wr9CO",primaryTextStyle:"p_f5Q10_Wr9CO",secondaryTextStyle:"s_1Upbx_Wr9CO",whiteText:"w_Vszg2_Wr9CO",themedWhiteText:"t_il03P_Wr9CO",persona:"p_eGjvZ_Wr9CO",personaCoin:"p_B1rzv_Wr9CO",personaDetails:"p_PH64v_Wr9CO"}}
,4270:(e,t,n)=>{"use strict";n.d(t,{A:()=>a}),n(8424).loadStyles('.t_CQCzd_Wr9CO{display:flex;flex-direction:column}.t_spPaH_Wr9CO{stop-color:"[theme:neutralPrimary, default: #323130]"}',!0);const a={titleRegion:"t_CQCzd_Wr9CO",themeableLinearGradientSvgPath:"t_spPaH_Wr9CO"}}
,3284:(e,t,n)=>{"use strict";var a,i,r,o,s;n.d(t,{jD:()=>i}),n(7224),function(e){e[e.HEADER=0]="HEADER",e[e.NAV=1]="NAV",e[e.FOOTER=2]="FOOTER",e[e.SEARCHBOX=3]="SEARCHBOX"}(a||(a={})),function(e){e[e.LEFT=0]="LEFT",e[e.HORIZONTAL=1]="HORIZONTAL"}(i||(i={})),function(e){e[e.FULLBLEED=0]="FULLBLEED",e[e.WITHLEFTNAV=1]="WITHLEFTNAV"}(r||(r={})),function(e){e[e.SIMPLE=0]="SIMPLE",e[e.EXTENDED=1]="EXTENDED",e[e.STACKED=2]="STACKED"}(o||(o={})),function(e){e[e.Strong=0]="Strong",e[e.Neutral=1]="Neutral",e[e.Soft=2]="Soft",e[e.None=3]="None"}(s||(s={}))}
,9987:(e,t,n)=>{"use strict";var a=n(9825);n.o(a,"getTheme")&&n.d(t,{getTheme:function(){return a.getTheme}}),n.o(a,"mergeStyleSets")&&n.d(t,{mergeStyleSets:function(){return a.mergeStyleSets}})}
,414:(e,t,n)=>{var a=n(9825);e.exports=a._Utilities}
,5136:(e,t,n)=>{var a=n(2141);e.exports=a.workaround_Icon}
,845:(e,t,n)=>{"use strict";e.exports=n.p+"odm_spdefaultbanner_dark_2a7ec099.jpg"}
,3525:(e,t,n)=>{"use strict";e.exports=n.p+"odm_spdefaultbanner_light_8a7ed31b.jpg"}
,8424:e=>{"use strict";e.exports=v},1962:e=>{"use strict";e.exports=a},9676:e=>{"use strict";e.exports=i},2207:e=>{"use strict";e.exports=r},1909:e=>{"use strict";e.exports=x},2737:e=>{"use strict";e.exports=g},4949:e=>{"use strict";e.exports=d},8414:e=>{"use strict";e.exports=O},529:e=>{"use strict";e.exports=C},7408:e=>{"use strict";e.exports=y},4410:e=>{"use strict";e.exports=F},6642:e=>{"use strict";e.exports=o},2141:e=>{"use strict";e.exports=b},6277:e=>{"use strict";e.exports=h},8810:e=>{"use strict";e.exports=l},9930:e=>{"use strict";e.exports=A},949:e=>{"use strict";e.exports=m},718:e=>{"use strict";e.exports=s},1717:e=>{"use strict";e.exports=E},6575:e=>{"use strict";e.exports=L},95:e=>{"use strict";e.exports=I},4907:e=>{"use strict";e.exports=S},606:e=>{"use strict";e.exports=D},7405:e=>{"use strict";e.exports=M},7285:e=>{"use strict";e.exports=p},4948:e=>{"use strict";e.exports=k},2159:e=>{"use strict";e.exports=_},8122:e=>{"use strict";e.exports=u},5519:e=>{"use strict";e.exports=c},1506:e=>{"use strict";e.exports=P},8919:e=>{"use strict";e.exports=T},1181:e=>{"use strict";e.exports=w},5592:e=>{"use strict";e.exports=f},9825:e=>{"use strict";e.exports=U},5959:e=>{"use strict";e.exports=t},8398:e=>{"use strict";e.exports=n},2325:e=>{"use strict";e.exports=JSON.parse('{"B":"The profile for {0} has been removed."}')}
,2330:e=>{"use strict";e.exports=JSON.parse('{"kJ":"Page author byline. {0} {1}. {2} {3}","J6":"Press Enter to open details for this person.","Uk":"Press Delete to remove the profile for {0} {1}.","ui":"Remove profile"}')}
,1001:e=>{"use strict";e.exports=JSON.parse('{"z_":"Add a title","r9":"Add a heading","B1":"Page title: {0}. When finished editing, press Tab to go to the author field to change the author, or press Escape to edit page content.","Zn":"Title region. Page name area. Enter a name for the page. Press Tab to move into the page author area. Press Tab a second time followed by Enter to change settings on the Property Pane."}')}
,109:e=>{"use strict";e.exports=JSON.parse('{"_A":"Browse images","xW":"Reset","aT":"Set image focal point","eI":"Advanced editing","iP":"Toggle display mode","Ab":"Layout options"}')}
},R={};function N(e){var t=R[e];if(void 0!==t)return t.exports;var n=R[e]={exports:{}};return H[e](n,n.exports,N),n.exports}N.m=H;var B,j,V,z={"119":"1kzG1zJr8C6hbaUpsl5vQSpHX+euatZsiT5O+7/zFbc=","126":"McQ2r5jOg8Yq17xKBIQFDdBWSEyu6MlxGt9VyaQj/kg=","154":"ycNNk8wdwlJHuZiRJK8+g3nzlzShJe7cvYNoumPYXOA=","250":"YAL9gB9GT5H/1jELlbMQPRkif2zvMMqqROGS0azZQzg=","286":"5s0Y/l1SwM0zHJ2WGAU/h1zbGhKaBc5jhYVeOjbhujg=","314":"30jk36Q+spMCC12yNWUW+F0fBC1cvyeBHXer2M/blnA=","337":"9ZmCCcO2jNBNin5HOzG0pAFA4HtJFM/ZND421rF+S5E=","375":"+QOta++5gjTE89/8POZ3rAu4m6VYhOE98/vE0mgVSpE=","410":"NFZ8gE2iru6fZUiJvfENE7ZVwIrUgwijabk8JsrMXJ8=","417":"oNqExh+dDxbjUSyT+cPvGdnkYmRARNEI0BXpY/0/8zk=","442":"Mrwfx+Atjrs9h5p7DBBZ19hQuywEupok29lNTrxbgXw=","487":"/GIvemf5MX6IDRvdAFiHKUi8k4/BG8yqGVfgnmUcdo4=","490":"GcWQRERcAVf0+RGWy5jHXCANeyQgP6du+yZcuFPAP2s=","514":"pfVn+cRbSN8TKK+GqFtgoskRj+PCLGEugc8J2c4axXg=","585":"sUkHzYEbhJeqq+dhxQF1VvQkYXwOUy8/YnSr88IsEec=","586":"bCWui0dB8/PG4/CiAhnugB8zm2eTXSjcsrbs6luMJ9o=","620":"pAm/it9U0zt26jzDIPwRviMM2CptTsZbfxpgFjOagMQ=","650":"rrCyIkI6Oomlq0JrYmrncWsmE1vz9fHbuG7mhdEtrgw=","744":"k1v+HtwJ8EUHViLDJLLSQirD0YE6JY8hobaiQshXHsE=","863":"7BHrFwaCFPtjIQ2wpb2H1FaofxVHNjFRvrAMyu7NuqA=","932":"ln9IDWS2ya2IAVdWXEDN0upmoyHHKWWX2zsePPEx23U=","937":"uDbgj4f0kB8dlxngf5hTR1t59vsowNDQINNfbYXGkIg=","945":"dThrMxHtOiI+b1kHtrmKnGE+5U5sDHn94QWVg0trTsE=","965":"NJhu1U43N7WLptukUqfjzUUNfdUt4X8zi8oaMEU0RGQ="};N.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return N.d(t,{a:t}),t},N.d=(e,t)=>{for(var n in t)N.o(t,n)&&!N.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},N.f={},N.e=e=>Promise.all(Object.keys(N.f).reduce((t,n)=>(N.f[n](e,t),t),[])),N.u=e=>"chunk."+({119:"sp-title-region-webpart-default-author-populator",126:"title-region-fade-layout",154:"title-region-teams-custom-layout",250:"title-region-viva-engage-layout",314:"titleRegion-TopBarIcons",337:"title-region-color-block-layout",375:"title-region-author-layout",410:"title-region-authorbylinedataprovider",417:"sp-title-region-timeToRead",442:"title-region-email-layout",490:"title-region-event-layout",585:"sp-title-region-webpart-edit-mode",620:"title-region-event-no-image-layout",650:"sp-title-region-publishdate",744:"title-region-teams-layout",863:"live-persona-card-loader",932:"title-region-news-digest-layout",945:"title-region-topic-page-layout"}[e]||e)+"_"+({154:1,250:1,417:1,490:1,585:1,620:1,650:1,945:1}[e]?"en-us":"none")+"_"+{119:"bafae9254d497cfef9c6",126:"abd0789076e8bf903982",154:"a48b91e8d6d49e8f793e",250:"0433653e56fa078d2799",286:"77ce419be6454b2642be",314:"d585ace6c301efc8be8d",337:"e675deb770f0aaee18e9",375:"3fa23b4c11b4f23c2008",410:"88184c7ca8a4921fb25b",417:"0f457043325948286150",442:"58049207d13fc6107047",487:"e8af61b2e7c1ac99b0be",490:"941612a0a961cd83a536",514:"d1c30a8927c642c06198",585:"89b6ffcf059eb8dfcafb",586:"22aacf80641f37960dd6",620:"5e3054c795ad76dfb099",650:"0b82e9187dc23b3484de",744:"def21fe91cfabb620c8b",863:"ce8cd3d82ddeff3466f5",932:"e644d4579b323d27d5c4",937:"9d83473b83ed092ddcc7",945:"f56c4225a2fd19df2b7a",965:"91a2d37e2e585de0950d"}[e]+".js",N.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),N.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),B={},j="04c03225d738ebd8d3ed753e2b46f479:",N.l=(e,t,n,a)=>{if(B[e])B[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==j+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,N.nc&&i.setAttribute("nonce",N.nc),i.setAttribute("data-webpack",j+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(z[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}B[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(u);var a=B[e];if(delete B[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},N.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},N.j=370,V=e?e.src:"",N.p=V.slice(0,V.lastIndexOf("/")+1),N.f.compat=(e,t)=>{for(var n=function(e){var t={i:"01c4df03-e775-48cb-aa14-171ee5199a15",v:"2.3.1",m:280},n={i:"c83d5509-ccd5-4c67-919f-2440f237927a",v:"0.5.552",m:1787};return{586:[t],585:[{i:"12e94922-76ea-4654-88ff-a149979a3d3e",v:"1.0.0",m:7758},{i:"f9e737b7-f0df-4597-ba8c-3060f82380db",v:"1.23.0",m:9877},{i:"b718651d-dc14-498c-98fc-735f037b5d81",v:"0.1.0",m:9331},{i:"406d73bd-ace7-4de2-b828-29b87d72c79c",v:"0.1.0",m:9139},{i:"6da60671-741f-47c5-b35b-5078edaf312f",v:"0.1.0",m:9318},{i:"fab65e60-a04f-4772-874c-10691e4afa4b",v:"0.1.0",m:6094},{i:"69726a7d-b5d1-4b69-93c8-3dc652bd770e",v:"0.1.0",m:3839},{i:"444abf08-e4b4-4d65-b726-5a576c37e469",v:"0.1.0",m:1456}],487:[t],154:[{i:"42647dee-1f75-4b9f-b521-5c844a6c35cc",v:"0.1.0",m:3863}],490:[n],620:[n],286:[t],945:[{i:"136f93a9-626b-4896-8d28-234a85a01387",v:"0.1.0",m:9882},{i:"49d290fb-a38e-4001-97d3-a2db486db2fa",v:"0.1.0",m:5619},{i:"94f059ca-7d9b-46b4-bb97-ec5867cb121a",v:"0.1.0",m:2183},{i:"a86b8f98-2f15-4506-b455-c1e9fe8da1bd",v:"0.1.0",m:4207}],375:[{i:"c4fe3ba0-6e65-4907-ae47-12976129cb4d",v:"0.1.0",m:4957}],126:[{i:"8cb44049-e10b-4b8e-952e-08ac473ba94a",v:"1.0.0",m:6326}],514:[t]}[e]||[]}(e),a=0;a<n.length;a++)N.m[n[a].m]||(e=>{t.push(G.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{N.m[e.m]=e=>e.exports=t}))})(n[a])};var G=N(8414);(()=>{var e={370:0};N.f.j=(t,n)=>{var a=N.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=N.p+N.u(t),o=new Error;N.l(r,n=>{if(N.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)N.o(o,a)&&(N.m[a]=o[a]);s&&s(N)}for(t&&t(n);c<r.length;c++)i=r[c],N.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackJsonp_04c03225d738ebd8d3ed753e2b46f479=self.webpackJsonp_04c03225d738ebd8d3ed753e2b46f479||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var K={};return(()=>{"use strict";N.r(K),N.d(K,{default:()=>we});var e=N(5592),t=N(5959),n=N(8398),a=N(4907),i=N(606),r=N(1962),o=N(9676),s=N(2207),c=N(6642),d=N(718),l=N(5519),u=N(5038),f=N(8956),p=N(7285),m=N(949),_=N(2159),h=N(6277),b=N(2141),g=N(2566),v=N(3436);class y{static import(e){let t=y._map.get(e);return t||(t=y._createLayout(e),y._map.set(e,t)),t}static _createLayout(e){switch(e){case"NoImageEmail":case"FullWidthImageEmail":return N.e(442).then(N.bind(N,7107)).then(t=>"NoImageEmail"===e?new t.NoImageEmailLayout:new t.FullWidthImageEmailLayout);case"TeamsCustom":return Promise.all([N.e(487),N.e(154)]).then(N.bind(N,5252)).then(e=>new e.TeamsCustomLayout);case"ImageEngage":case"NoImageTeams":case"ImageTeams":return N.e(744).then(N.bind(N,2570)).then(t=>({NoImageTeams:()=>new t.NoImageTeamsLayout,ImageTeams:()=>new t.ImageTeamsLayout,ImageEngage:()=>new t.ImageEngageLayout}[e]()));case"NoImageVivaEngage":case"FullWidthImageVivaEngage":return N.e(250).then(N.bind(N,4175)).then(t=>"NoImageVivaEngage"===e?new t.NoImageVivaEngageLayout:new t.FullWidthImageVivaEngageLayout);case"Event":return N.e(490).then(N.bind(N,6982)).then(e=>new e.EventLayout);case"EventNoImage":return N.e(620).then(N.bind(N,482)).then(e=>new e.EventNoImageLayout);case"NewsDigest":return N.e(932).then(N.bind(N,7662)).then(e=>new e.NewsDigestLayout);case"TopicPage":return Promise.all([N.e(286),N.e(945)]).then(N.bind(N,7815)).then(e=>new e.TopicPageLayout);case"ColorBlock":return N.e(337).then(N.bind(N,867)).then(e=>new e.ColorBlockLayout);case"Author":return N.e(375).then(N.bind(N,2069)).then(e=>new e.AuthorLayout);case"Fade":return N.e(126).then(N.bind(N,357)).then(e=>new e.FadeLayout);default:throw new Error(`Unsupported layout type: ${e}`)}}}y._map=new Map;var S=N(7408),D=N(8962),I=N(8140),x=N(8509),C=N(3248),O=N(8855),w=N(7379),E=N(3724),A=N(647),L=N(8424);L.loadStyles('.b_XeSUZ_Wr9CO{height:300px;position:relative}@media screen and (min-width:640px){.b_XeSUZ_Wr9CO{height:300px}}@media screen and (min-width:1920px){.b_XeSUZ_Wr9CO{height:300px}}.b_XeSUZ_Wr9CO.h_-D96c_Wr9CO,.b_XeSUZ_Wr9CO.h_2nRDj_Wr9CO,.b_XeSUZ_Wr9CO.h_arbkD_Wr9CO,.b_XeSUZ_Wr9CO.h_dkJE3_Wr9CO{height:300px}.b_XeSUZ_Wr9CO>*{bottom:0;left:0;position:absolute;right:0;top:0}.b_n7tKG_Wr9CO{height:150px;position:relative}@media screen and (min-width:640px){.b_n7tKG_Wr9CO{height:228px}}@media screen and (min-width:1920px){.b_n7tKG_Wr9CO{height:280px}}.b_n7tKG_Wr9CO.h_2nRDj_Wr9CO{height:228px}.b_n7tKG_Wr9CO.h_dkJE3_Wr9CO{height:265px}.b_n7tKG_Wr9CO.h_arbkD_Wr9CO{height:280px}.b_n7tKG_Wr9CO.h_-D96c_Wr9CO{height:150px}.b_n7tKG_Wr9CO>*{bottom:0;left:0;position:absolute;right:0;top:0}.b_qerRQ_Wr9CO{height:150px;position:relative}.b_qerRQ_Wr9CO>*{bottom:0;left:0;position:absolute;right:0;top:0}.b_ZOj7D_Wr9CO{height:300px;position:relative}.b_ZOj7D_Wr9CO>*{bottom:0;left:0;position:absolute;right:0;top:0}.c_6esSS_Wr9CO{margin-bottom:-44px;position:relative;top:-44px;width:100%}.c_6esSS_Wr9CO.f_SuH_P_Wr9CO{padding-bottom:1.5px}.c_QQQex_Wr9CO{margin-left:-12px;margin-right:-12px;position:relative;z-index:2}@media screen and (min-width:480px){.c_QQQex_Wr9CO{margin-left:-16px;margin-right:-16px}}@media screen and (min-width:640px){.c_QQQex_Wr9CO{margin-left:-20px;margin-right:-20px}}.c_QQQex_Wr9CO .t_XzhYO_Wr9CO{left:0;position:absolute;right:0;top:-36px}@media screen and (min-width:480px){.c_QQQex_Wr9CO .t_XzhYO_Wr9CO{top:-44px}}.c_SKLLv_Wr9CO{background:"[theme:white, default: #ffffff]";color:"[theme:black, default: #000000]";padding:4px 12px}@media screen and (min-width:480px){.c_SKLLv_Wr9CO{padding:8px 16px}}@media screen and (min-width:640px){.c_SKLLv_Wr9CO{padding:12px 20px}}.c_SKLLv_Wr9CO .p_PksbJ_Wr9CO{display:flex}.c_SKLLv_Wr9CO .p_PksbJ_Wr9CO.c_Ua-b2_Wr9CO{justify-content:center}.a__BbGL_Wr9CO{margin-top:10px}.p_n2hN3_Wr9CO{margin-top:6px}',!0);const k="p_n2hN3_Wr9CO";var M=N(733),P=N(1600),T=N(2549),U=N(8391),F=N(9987),H=N(9282),R=N(414);class B{get type(){return"CutInShape"}get propertyPane(){return{showLayoutChoiceGroup:!0,showAlignmentChoiceGroup:!0,showTopicHeaderInput:!0,showAuthorVisibilityToggle:!0,showPublishDateVisibilityToggle:!0,showTimeToReadVisibilityToggle:(0,E.Lg)(),showAltTextInput:!0}}get toolbar(){return(0,P.e)(this.type)}_renderTopicHeader(e){return e.showTopicHeader&&t.createElement(w.f,{className:"t_XzhYO_Wr9CO",alignment:e.alignment,value:e.topicHeader,variantTheme:e.variantTheme})}_renderTitleInput(e){return t.createElement(O.a,{variantTheme:e.variantTheme,editMode:e.editMode,title:e.title,htmlTitle:e.htmlTitle,titleAriaLabel:e.titleAriaLabel,maxLines:!(0,U.rV)()&&(0,T.g)(e.width)?3:2,alignment:e.alignment,pageContext:e.serviceScope.consume(S.PageContext.serviceKey),onChangeTitle:e.controller.updateTitle,onCommitTitle:e.controller.commitTitle,onChangeHTMLTitle:e.controller.updateHTMLtitle,serviceScope:e.serviceScope})}_renderPublishDate(e){return e.showPublishDate&&t.createElement(x.Z,{className:k,serviceScope:e.serviceScope,alignment:e.alignment,variantTheme:e.variantTheme})}_renderTimeToRead(e){return e.showTimeToRead&&t.createElement(C.q,{className:k,serviceScope:e.serviceScope,alignment:e.alignment,variantTheme:e.variantTheme,hasSeparator:e.showPublishDate,editMode:e.editMode,completeComponentRender:e.completeComponentRender})}_renderAuthorByline(e){return t.createElement(D.V,{isEditMode:e.editMode,serviceScope:e.serviceScope,alignment:e.alignment,className:"a__BbGL_Wr9CO",selectedPersons:e.authors,authorByline:e.authorByline,onChangeSelectedPersons:e.controller.updateAuthors,variantTheme:e.variantTheme})}constructor(){this.canvas=e=>t.createElement("div",{"data-automation-id":(0,U.Zj)()?void 0:"cutInShapeLayout"},this._renderBackground(e),this._renderContent(e)),this._renderBackground=e=>{const n=window.innerWidth>=M.Cv&&(0,T.g)(e.width,M.Cv);let a;return e.width&&!n&&(a=e.width>=M.em?"h_arbkD_Wr9CO":!(0,U.rV)()&&e.width>M.Cv&&e.width<M.Wh?"h_dkJE3_Wr9CO":e.width>=M.Cv?"h_2nRDj_Wr9CO":"h_-D96c_Wr9CO"),t.createElement("div",{className:(0,i.mergeClasses)(n?(0,E.C)()?"b_ZOj7D_Wr9CO":"b_qerRQ_Wr9CO":(0,E.C)()?"b_XeSUZ_Wr9CO":"b_n7tKG_Wr9CO",a)},t.createElement(g.o,{...e,onChangeFocalPoint:e.controller.setFocalPoint,onCompleteFirstRender:e.controller.completeFirstRender,isAdvancedEditEnabled:(0,E.Rl)()}))},this._renderContent=e=>t.createElement(I.b,{className:(0,i.mergeClasses)("c_6esSS_Wr9CO",!(0,U.IN)()&&e.editMode&&"f_SuH_P_Wr9CO"),editMode:e.editMode,serviceScope:e.serviceScope},t.createElement("div",{className:"c_QQQex_Wr9CO"},this._renderTopicHeader(e),this._renderCutInBlock(e))),this._renderCutInBlock=e=>{const n=(a=e.variantTheme||(0,F.getTheme)(),(0,H.I)()?(0,F.mergeStyleSets)({cutInBlock:{"&&":{color:a.palette?.black,backgroundColor:a.palette?.white}}}):{cutInBlock:void 0});var a;return t.createElement("div",{className:(0,R.css)("c_SKLLv_Wr9CO",n.cutInBlock)},this._renderTitleInput(e),this._renderAuthorByline(e),(0,E.Lg)()?t.createElement("div",{className:(0,R.css)("p_PksbJ_Wr9CO",e.alignment===A.q.Center&&"c_Ua-b2_Wr9CO")},this._renderPublishDate(e),this._renderTimeToRead(e)):this._renderPublishDate(e))}}}var j=N(1231);L.loadStyles(".c_CN95m_Wr9CO{position:relative}@media screen and (min-width:640px){.c_CN95m_Wr9CO:not(.s_wQP4Q_Wr9CO)>:not(.b_QLmG6_Wr9CO,.b_VhKHz_Wr9CO,.b_DvyuP_Wr9CO,.b_yPu97_Wr9CO){bottom:0;left:0;position:absolute;right:0;top:0}}.b_VhKHz_Wr9CO{height:150px}@media screen and (min-width:640px){.b_VhKHz_Wr9CO{height:300px}}@media screen and (min-width:1920px){.b_VhKHz_Wr9CO{height:300px}}.b_VhKHz_Wr9CO.h_VwU1Y_Wr9CO,.b_VhKHz_Wr9CO.h_Y_eQO_Wr9CO,.b_VhKHz_Wr9CO.h_hqq3G_Wr9CO,.b_VhKHz_Wr9CO.h_s3eqg_Wr9CO{height:300px}.b_yPu97_Wr9CO{height:150px}@media screen and (min-width:640px){.b_yPu97_Wr9CO{height:228px}}@media screen and (min-width:1920px){.b_yPu97_Wr9CO{height:280px}}.b_yPu97_Wr9CO.h_Y_eQO_Wr9CO{height:228px}.b_yPu97_Wr9CO.h_VwU1Y_Wr9CO{height:265px}.b_yPu97_Wr9CO.h_s3eqg_Wr9CO{height:280px}.b_yPu97_Wr9CO.h_hqq3G_Wr9CO{height:150px}.b_QLmG6_Wr9CO{height:300px}.b_DvyuP_Wr9CO{height:280px}@media screen and (max-width:639.99999px){.g_axDAs_Wr9CO{background-image:none!important}}.g_LILcD_Wr9CO{bottom:0;left:0;position:absolute;right:0;top:0}@media screen and (max-width:639.99999px){.g_LILcD_Wr9CO{background-image:none!important}}.c_S0JH9_Wr9CO{justify-content:flex-end;padding-bottom:12px;padding-top:16px}@media screen and (min-width:640px){.c_S0JH9_Wr9CO{padding-bottom:20px}}.t_2WOqZ_Wr9CO{margin-bottom:6px}.a_xLC0K_Wr9CO{margin-top:10px}.p_r4rGP_Wr9CO{margin-top:6px}.p_QBF2C_Wr9CO{display:inline-flex}.p_QBF2C_Wr9CO.c_VZbuf_Wr9CO{justify-content:center}@media screen and (min-width:640px){.w_Wgkez_Wr9CO{color:#fff!important}.w_Wgkez_Wr9CO:-ms-input-placeholder{color:#eaeaea}.w_Wgkez_Wr9CO::placeholder{color:#eaeaea}}@media screen and (min-width:640px){.t_r-VYu_Wr9CO{text-shadow:1px 1px 4px rgba(0,0,0,.6)}}.w_8qIqi_Wr9CO{color:#fff!important}.w_8qIqi_Wr9CO:-ms-input-placeholder{color:#eaeaea}.w_8qIqi_Wr9CO::placeholder{color:#eaeaea}",!0);const V={container:"c_CN95m_Wr9CO",smallCanvas:"s_wQP4Q_Wr9CO",backgroundImageFixedHeight:"b_QLmG6_Wr9CO",backgroundImage:"b_VhKHz_Wr9CO",backgroundImageFixedHeightLegacy:"b_DvyuP_Wr9CO",backgroundImageLegacy:"b_yPu97_Wr9CO",heightLg:"h_Y_eQO_Wr9CO",heightXl:"h_VwU1Y_Wr9CO",heightXxxl:"h_s3eqg_Wr9CO",heightDefault:"h_hqq3G_Wr9CO",gradientBox:"g_axDAs_Wr9CO",gradientBoxFixedHeight:"g_LILcD_Wr9CO",contentBox:"c_S0JH9_Wr9CO",topicHeader:"t_2WOqZ_Wr9CO",authorByline:"a_xLC0K_Wr9CO",publishDate:"p_r4rGP_Wr9CO",publishDateContainer:"p_QBF2C_Wr9CO",center:"c_VZbuf_Wr9CO",white:"w_Wgkez_Wr9CO",textShadow:"t_r-VYu_Wr9CO",whiteText:"w_8qIqi_Wr9CO"};function z({props:e,styles:n,backgroundImage:a,contentBox:r,dataAutomationId:o}){const[s,c]=t.useState({width:0,height:0});return t.createElement("div",{className:(0,i.mergeClasses)(n.container,!!e.width&&e.width<=M.Cv&&n.smallCanvas),"data-automation-id":o},a({...e,onImageLoad:e=>{c({width:e?.currentTarget.naturalWidth||0,height:e?.currentTarget.naturalHeight||0})}}),r({...e,imageSize:s}))}var G=N(7179),W=N(9928),q=N(4656);function Q(e){return window.innerWidth>=M.Cv&&(0,T.g)(e.width,M.Cv)}class Y{get type(){return"FullWidthImage"}get propertyPane(){return{showLayoutChoiceGroup:!0,showAlignmentChoiceGroup:!0,showTopicHeaderInput:!0,showAuthorVisibilityToggle:!0,showPublishDateVisibilityToggle:!0,showTimeToReadVisibilityToggle:(0,E.Lg)(),showAltTextInput:!0}}get toolbar(){return(0,P.e)(this.type)}_renderBackgroundImage(e){let n;return e.width&&!Q(e)&&(n=e.width>=M.em?V.heightXxxl:!(0,U.rV)()&&e.width>M.Cv&&e.width<M.Wh?V.heightXl:e.width>=M.Cv?V.heightLg:V.heightDefault),t.createElement(g.o,{...e,className:(0,i.mergeClasses)(Q(e)?(0,E.C)()?V.backgroundImageFixedHeight:V.backgroundImageFixedHeightLegacy:(0,E.C)()?V.backgroundImage:V.backgroundImageLegacy,n),onChangeFocalPoint:e.controller.setFocalPoint,onCompleteFirstRender:e.controller.completeFirstRender,onImageLoad:e.onImageLoad,isAdvancedEditEnabled:(0,E.Rl)(),isAdvancedEditScalingEnabled:e.isAdvancedEditScalingEnabled})}_renderTopicHeader(e){return e.showTopicHeader&&t.createElement(w.f,{className:V.topicHeader,alignment:e.alignment,value:e.topicHeader,variantTheme:e.variantTheme})}_renderTitleText(e){const n=this._getTitleTextProps(e);return t.createElement(O.a,n)}_getTitleTextProps(e){const t=e.image.type!==g.y.DefaultImage,n=(0,q.a5)(e);return{className:(0,b.css)((t||this._shouldUseWhiteText(e))&&V.white,!(0,U.jM)()&&(t||this._shouldUseWhiteText(e))&&V.textShadow,(0,W.n)()&&n?.titleTextColor),annotationClassName:t?(0,O.j)(!0):void 0,editMode:e.editMode,title:e.title,titleAriaLabel:e.titleAriaLabel,maxLines:(0,U.PE)()?(0,W.n)()?1:2:!(0,U.rV)()&&(0,T.g)(e.width)?3:2,alignment:e.alignment,pageContext:e.serviceScope.consume(S.PageContext.serviceKey),onChangeTitle:e.controller.updateTitle,onCommitTitle:e.controller.commitTitle,onChangeHTMLTitle:e.controller.updateHTMLtitle,imageSize:e.imageSize,width:e.width,requestedHeight:(0,E.C)()?M.Rm:e.requestedHeight,variantTheme:e.variantTheme,serviceScope:e.serviceScope,htmlTitle:e.htmlTitle}}_renderPublishDate(e){const n=(0,q.a5)(e),a=(0,b.css)(V.publishDate,(e.image.type!==g.y.DefaultImage||this._shouldUseWhiteText(e))&&V.white,(0,W.n)()&&n?.secondaryColor);return e.showPublishDate&&t.createElement(x.Z,{className:a,serviceScope:e.serviceScope,alignment:e.alignment,variantTheme:e.variantTheme})}_renderTimeToRead(e){const n=(0,q.a5)(e),a=(0,b.css)(V.publishDate,(e.image.type!==g.y.DefaultImage||this._shouldUseWhiteText(e))&&V.white,(0,W.n)()&&n?.secondaryColor);return e.showTimeToRead&&t.createElement(C.q,{className:a,serviceScope:e.serviceScope,alignment:e.alignment,variantTheme:e.variantTheme,hasSeparator:e.showPublishDate,editMode:e.editMode,completeComponentRender:e.completeComponentRender})}_renderAuthorByline(e){const n=(0,q.a5)(e),a=(0,b.css)(V.authorByline,e.image.type!==g.y.DefaultImage&&G.eQ,this._shouldUseWhiteText(e)&&G.eQ);return t.createElement(D.V,{isEditMode:e.editMode,serviceScope:e.serviceScope,alignment:e.alignment,className:a,selectedPersons:e.authors,authorByline:e.authorByline,onChangeSelectedPersons:e.controller.updateAuthors,variantTheme:e.variantTheme,authorClassNames:(0,W.n)()?{authorName:n?.primaryColor,authorJobTitle:n?.secondaryColor}:void 0})}_shouldUseWhiteText(e){return(0,b.getTheme)().isInverted}constructor(){this.canvas=e=>t.createElement(z,{props:e,styles:V,backgroundImage:this._renderBackgroundImage,contentBox:this._renderContentBox,dataAutomationId:(0,U.Zj)()?void 0:"fullWidthImageLayout"}),this._renderContentBox=e=>t.createElement(j.Q,{className:Q(e)?V.gradientBoxFixedHeight:V.gradientBox,disabled:e.image.type===g.y.DefaultImage||!1===e.enableGradientEffect},t.createElement(I.b,{className:V.contentBox,editMode:e.editMode,serviceScope:e.serviceScope},this._renderTopicHeader(e),this._renderTitleText(e),this._renderAuthorByline(e),(0,E.Lg)()?t.createElement("div",{className:(0,b.css)(V.publishDateContainer,e.alignment===A.q.Center&&V.center)},this._renderPublishDate(e),this._renderTimeToRead(e)):this._renderPublishDate(e)))}}L.loadStyles(".c_RRX7v_Wr9CO{justify-content:flex-end;min-height:96px;padding-bottom:12px;padding-top:24px}.c_RRX7v_Wr9CO.e_Mc6Zk_Wr9CO{min-height:141px}.c_RRX7v_Wr9CO.e_8wfAQ_Wr9CO{min-height:160px}.t_CaMML_Wr9CO{margin-bottom:6px}.a_LQWz3_Wr9CO{margin-top:10px}.p_qkiuq_Wr9CO{margin-top:6px}.p_bbgvF_Wr9CO{display:inline-flex}.p_bbgvF_Wr9CO.c_NB22P_Wr9CO{justify-content:center}",!0);const J="p_qkiuq_Wr9CO";class X{get type(){return"NoImage"}get propertyPane(){return{showLayoutChoiceGroup:!0,showAlignmentChoiceGroup:!0,showTopicHeaderInput:!0,showAuthorVisibilityToggle:!0,showPublishDateVisibilityToggle:!0,showTimeToReadVisibilityToggle:(0,E.Lg)(),showAltTextInput:!1}}get toolbar(){return(0,P.e)(this.type)}_renderTopicHeader(e){return e.showTopicHeader&&t.createElement(w.f,{className:"t_CaMML_Wr9CO",alignment:e.alignment,value:e.topicHeader,variantTheme:e.variantTheme})}_renderAuthorByline(e){return t.createElement(D.V,{isEditMode:e.editMode,serviceScope:e.serviceScope,alignment:e.alignment,className:"a_LQWz3_Wr9CO",selectedPersons:e.authors,authorByline:e.authorByline,onChangeSelectedPersons:e.controller.updateAuthors,authorClassNames:{authorName:(0,q.a5)(e)?.primaryColor,authorJobTitle:(0,q.a5)(e)?.secondaryColor},variantTheme:e.variantTheme})}_renderTitleText(e){const n=t.createElement(O.a,{editMode:e.editMode,title:e.title,htmlTitle:e.htmlTitle,titleAriaLabel:e.titleAriaLabel,maxLines:2,alignment:e.alignment,pageContext:e.serviceScope.consume(S.PageContext.serviceKey),onChangeTitle:e.controller.updateTitle,onCommitTitle:e.controller.commitTitle,onChangeHTMLTitle:e.controller.updateHTMLtitle,className:(0,q.a5)(e)?.titleTextColor,variantTheme:e.variantTheme,serviceScope:e.serviceScope});return(0,U.V6)()?n:t.createElement("div",{style:{minHeight:53}},n)}_renderPublishDate(e){return e.showPublishDate&&t.createElement(x.Z,{className:(0,b.css)(J,(0,q.a5)(e)?.secondaryColor),serviceScope:e.serviceScope,alignment:e.alignment})}_renderTimeToRead(e){return e.showTimeToRead&&t.createElement(C.q,{className:(0,b.css)(J,(0,q.a5)(e)?.secondaryColor),serviceScope:e.serviceScope,alignment:e.alignment,hasSeparator:e.showPublishDate,editMode:e.editMode})}constructor(){this.canvas=e=>t.createElement(I.b,{className:(0,i.mergeClasses)("c_RRX7v_Wr9CO",!(0,U.V6)()&&e.editMode&&"e_Mc6Zk_Wr9CO"),editMode:e.editMode,serviceScope:e.serviceScope},this._renderTopicHeader(e),this._renderTitleText(e),this._renderAuthorByline(e),(0,E.Lg)()?t.createElement("div",{className:(0,b.css)("p_bbgvF_Wr9CO",e.alignment===A.q.Center&&"c_NB22P_Wr9CO")},this._renderPublishDate(e),this._renderTimeToRead(e)):this._renderPublishDate(e))}}class Z{static getLayout(e){let t=Z._map.get(e);return t||(t=Z._createLayout(e),Z._map.set(e,t)),t}static _createLayout(e){switch(e){case"NoImage":return new X;case"CutInShape":return new B;default:return new Y}}}Z._map=new Map;var $=N(8101),ee=N(4270);class te extends t.PureComponent{render(){const e=!this.props.editMode||this._directEditMode;return t.createElement("div",{ref:this._containerRef},t.createElement(v.d,{editMode:this.props.editMode,renderViewMode:e?this._renderViewMode:void 0,renderEditMode:this._renderEditMode}))}constructor(e){super(e),this._containerRef=t.createRef(),this._renderEditMode=e=>t.createElement(e.TitleRegionEditMode,{...this.props,className:ee.A.titleRegion,topActionsConfig:this.props.topActionsConfig,serviceScope:this.props.serviceScope,instanceId:this.props.instanceId,variantTheme:this.context.variantTheme,focusZoneProps:this.props.focusZoneProps,aspectRatioRef:this._containerRef}),this._renderViewMode=()=>t.createElement(this.props.layout.canvas,{...this.props,variantTheme:this.context.variantTheme}),this._directEditMode=e.editMode}}te.contextType=$.m;var ne=N(8976);const ae={imageSource:{isImageSource:!0,customMetadata:{siteId:"siteId",webId:"webId",listId:"listId",uniqueId:"uniqueId",width:"imgWidth",height:"imgHeight"}}};var ie=N(5136),re=N(4410),oe=N(6625),se=N(8919);const ce="filePicker",de="advancedEditing",le="showFocalPointSetter",ue="reset",fe="toggleScalingMethod";function pe({topActionType:e}){const[n,a]=t.useState(null);return t.useEffect(()=>{Promise.all([N.e(937),N.e(965),N.e(314)]).then(N.bind(N,1414)).then(t=>{switch(e){case ce:a(t.ImageEdit24Regular);break;case de:a(t.WindowEdit16Regular);break;case ue:a(t.ArrowReset24Regular);break;case fe:a(t.Blur20Regular)}})},[e]),n?t.createElement(n,null):t.createElement(t.Fragment,null)}var me=N(109);function _e(e,n,a,i,r,o){const s=[];return(0,P.e)(e).enableImageEditing&&(s.push({targetProperty:ce,properties:{icon:"PictureLibrary",ariaLabel:me._A,imageSize:{width:24,height:24},themableSvg:t.createElement(pe,{topActionType:ce})},type:re.TopActionsFieldType.Button,dataAutomationId:"titleToolbarEditButton"}),n.type!==oe.y.DefaultImage&&((0,E.Rl)()?s.push({targetProperty:de,properties:{icon:"WindowEdit",ariaLabel:me.eI,imageSize:{width:24,height:24},themableSvg:t.createElement(pe,{topActionType:de})},type:re.TopActionsFieldType.Button,dataAutomationId:"titleToolbarAdvancedEditorButton"}):s.push({targetProperty:le,properties:{icon:"FocalPoint",ariaLabel:me.aT,imageSize:{width:24,height:24},themableSvg:t.createElement(ie.Icon,{iconName:"FocalPoint",style:{fontSize:"16px",lineHeight:"24px"}})},type:re.TopActionsFieldType.Button,dataAutomationId:"titleToolbarFocalPointButton"}),s.push({targetProperty:ue,properties:{icon:"Reset",ariaLabel:me.xW,imageSize:{width:24,height:24},themableSvg:t.createElement(pe,{topActionType:ue})},type:re.TopActionsFieldType.Button,dataAutomationId:"titleToolbarResetButton"})),(0,E.N2)()&&s.push({targetProperty:fe,properties:{icon:"Blur",ariaLabel:me.iP,imageSize:{width:24,height:24},themableSvg:t.createElement(pe,{topActionType:fe})},type:re.TopActionsFieldType.Button,dataAutomationId:"titleToolbarToggleScalingMethodButton"})),r&&(!(0,U.nv)()&&(0,E.nE)()||!(0,se.isTeamsHostType)(o?.host.hostType))&&s.push({...r.getTopActionsConfiguration(a,i,me.Ab,o),title:me.Ab}),s}var he=N(8464);function be(e,t,n,a,i){if(!(e&&t&&n&&a&&i))return;const r=t/n,o=a/i>r,s=o?a:i*r,c=o?a/r:i,d=o?0:(e.x*s-.5*a)/(s-a),l=Math.min(Math.max(0,d),1),u=o?(e.y*c-.5*i)/(c-i):0;return{x:100*l,y:100*Math.min(Math.max(0,u),1)}}var ge=N(2854),ve=N(1635),ye=N(1753);function Se(e){return(0,U.aG)()?!!e.uniqueId:!!e.listId&&!!e.siteId&&!!e.webId}var De=N(7422);const Ie=JSON.parse('{"k5":"Title area.","qc":"Banner.","Ab":"Layout options","Yc":"{0} {1} {2}"}'),xe={style:{position:"relative",width:"fit-content",top:-142}},Ce="updateTitle",Oe="updateTitleImage";class we extends c.BaseClientSideWebPart{static _getImageInfo(e,t){switch(e.imageSourceType){case A.f.SharePointURI:const n=!(0,U.aG)()&&!Se(e);return{id:e.imageSource||"",type:n?g.y.ExternalImage:g.y.SharePointImage,source:e.imageSource||"",webId:o.Guid.tryParse(e.webId),siteId:o.Guid.tryParse(e.siteId),listId:o.Guid.tryParse(e.listId),uniqueId:o.Guid.tryParse(e.uniqueId),originalSource:(0,E.Rl)()?e.imageOriginalSource:void 0,contentProvider:n?e.contentProvider:void 0,insertionISOTimestamp:n?e.insertionISOTimestamp:void 0,stockMediaId:n?e.stockMediaId:void 0};case A.f.None:case A.f.Default:default:return(0,H.I)()?g.o.getDefaultImage(t?.isInverted||!1):g.o.defaultImage}}getTopActionsConfiguration(){if(!this.properties.isLockedTitleRegion&&(!this.properties.amplifyTeamsFixedTitle||(0,f.Qo)(this.context.host.hostType)))return{topActions:_e(this._layoutType,this._imageInfo,this.properties,this.context._getPositionOnPage?.(),this._propertyPane,this.context),onExecute:(e,t)=>{s._EngagementLogger.logEvent("TitleRegionWebPart.TopActions.Click",e),e===de?this._controller.openAdvancedImageEditor?.():e===ce?this._controller.editImage?.():e===le?this._controller.showFocalPointSetter?.():e===ue?this._controller.resetToDefaultImage?.():e===fe?this._controller.setScalingMethod?.(!this.properties.isAdvancedEditScalingEnabled):(this._onPropertyPaneFieldChanged(e,t),this.context.propertyPane.refresh())}}}async _checkA11y(){return(0,U.AL)()?v.d.import().then(async e=>{let t;return(0,f.H0)(this.context.host.hostType)||(t=e.checkBannerAltText(this.properties.layoutType,this.properties.imageSource,this.properties.altText,this.properties.isDecorative)),Promise.resolve([t])}):v.d.import().then(async e=>{const t=[];(0,f.H0)(this.context.host.hostType)||t.push(()=>e.checkBannerAltText(this.properties.layoutType,this.properties.imageSource,this.properties.altText,this.properties.isDecorative));const n=await Promise.all(t.map(e=>(0,m.runSafeCheck)(e)));return Promise.resolve(n.filter(e=>void 0!==e))})}get previewImageUrl(){const{imageSourceType:e,imageSource:t,layoutType:n}=this.properties;if("NoImage"===n||"EventNoImage"===n||"Author"===n)return;let a;a=!!t&&(t.indexOf("sitepagethumbnail.png")>=0||t.indexOf("sleektemplateimagetile.jpg")>=0),a=a||e===A.f.SharePointURI&&!!t&&t.indexOf("/_LAYOUTS/IMAGES/")>=0;const i=!a&&t||"";return(0,u.i)({pageContext:this.context.pageContext,url:i,siteId:this.properties.siteId,webId:this.properties.webId,listId:this.properties.listId,uniqueId:this.properties.uniqueId})}render(){(0,E.Yc)()&&!this._hasOnInitFinished?(this._hasOnInitStarted?this._onInitRenderPromise:this.onInit()).then(()=>this._render_internal()):this._render_internal()}_internalSetWebPartData(e,t){if(!(0,U.rD)()){const t=e.properties,n=(0,d.getUpdateResultFromExternalLinkProperties)(this.instanceId,t,()=>!(0,ve.J)(this.properties.layoutType)||!e.properties.shouldForceUpdate&&this.properties.imageSourceType===A.f.SharePointURI);if(n===d.ExternalLinkUpdateResult.reject||!t)return;if(n===d.ExternalLinkUpdateResult.update){if(t.imageBlob)this._imageInfo={id:o.Guid.newGuid().toString(),type:g.y.LocalImage,file:t.imageBlob},this._updateWithExternalImage=!0,this._titleRegionKey=Math.random();else if(t.externalLink?.link){const e=t.externalLink;this._imageInfo=Se(t.externalLink)?{id:o.Guid.newGuid().toString(),type:g.y.SharePointImage,source:e.link,siteId:o.Guid.tryParse(e.siteId),webId:o.Guid.tryParse(e.webId),listId:o.Guid.tryParse(e.listId),uniqueId:o.Guid.tryParse(e.uniqueId)}:{id:o.Guid.newGuid().toString(),type:g.y.ExternalImage,source:e.link,stockMediaId:e.stockMediaId,contentProvider:e.contentProvider,insertionISOTimestamp:(0,d.getTimestampForGettyContent)(e.contentProvider)},this._updateWithExternalImage=!0,this._titleRegionKey=Math.random();const n=(0,d.getTimestampForGettyContent)(e.contentProvider);(0,d.isGettyContent)(e.contentProvider)&&n&&(e.stockMediaId||e.link)&&(0,d.reportGettyInsertions)([{link:e.link,stockMediaId:e.stockMediaId,insertionISOTimestamp:n}],this.instanceId),!(0,U.Ao)()&&(0,E.S0)()&&(0,d.logImageContentProviderUsage)("TitleRegionWebPart",e.contentProvider)}(0,d.deleteExternalLinkProperties)(e.properties)}}super._internalSetWebPartData(e,t)}onTranspile(e){const t=this.properties.title??"",n=this.properties.htmlTitle||(0,se.getHTMLTitleFromPlainText)(t),a=this.properties.authors??[],i=we._getImageInfo(this.properties,this._variantTheme),r=this.properties.layoutType??"",o="NoImage"!==r&&((0,U.fp)()||"Author"!==r);let s="";s=i.type!==g.y.DefaultImage?i.type===g.y.SharePointImage||i.type===g.y.ExternalImage?i.source:"":i.originalSource??"";const c=this.properties.topicHeader??"",d=this.properties.showTopicHeader??!0,l=this.properties.imgHeight??0,u=this.properties.imgWidth??0,f=this._convertLayoutToTranspileLayout(this.properties.layoutType??"FullWidthImage"),p=this.properties.textAlignment??"Left",m=this.properties.translateX,b=this.properties.translateY,v=[];if(a&&a.length>0){const e={name:a[0].name,email:a[0].email,aadObjectId:a[0].aadObjectId??"",role:a[0].role};v.push(e)}const y=[];if(e.isWebPartToImageAllowed&&this.properties.layoutType&&this._isLayoutSupportedForTranspileScreenshot(this.properties.layoutType)){const e={componentName:_.ComponentName.WebPartToImage,altText:h.StringHelper.format(Ie.Yc,d?c:"",t,v.length>0?`${v[0].name} ${v[0].role}`:"")};if((0,U.KM)())return[e];y.push(e)}const S={componentName:_.ComponentName.Banner,title:t,titleHtml:n,authors:v,header:c,showHeader:d,layout:f,textAlignment:p};if(o&&((0,U.gy)()||(S.thumbnail={source:{url:s}}),!(0,U.f1)()&&this.properties.siteId&&this.properties.webId&&this.properties.uniqueId&&(S.thumbnail={source:{sharepointIds:{siteId:this.properties.siteId,listId:this.properties.listId,webId:this.properties.webId,uniqueId:this.properties.uniqueId}}}),(0,U.gy)()&&(S.thumbnail={source:{url:s}}),S.thumbnail={...S.thumbnail,originalDimensions:{height:l,width:u},cropWindow:{type:"focalPoint",focalPoint:{offsetLeft:m??0,offsetTop:b??0}}}),0===e.position){const e={...S,componentName:_.ComponentName.TitleRegion,announcementBanner:{headline:(this.properties.headline??"").substring(0,44),headlineColor:this.properties.headlineColor??0}};return y.push(e),y}return y.push(S),y}onDispose(){super.onDispose(),g.o.removeParallax(this._titleRegion),this._themeProvider?.themeChangedEvent.remove(this,this._handleThemeChangedEvent),n.unmountComponentAtNode(this.domElement),this._hasOnInitFinished=!1,this._hasOnInitStarted=!1,(0,d.isPagesCopilotEnabled)(this.context.serviceScope)&&(o._SPEventManager.instance.unregisterEvent(Oe,this,this._updateTitleImage),o._SPEventManager.instance.unregisterEvent(Ce,this,this._updateTitleExternal)),(0,U.Vy)()||o._SPEventManager.instance.unregisterEvent(d.FOCUS_MODE_EVENT_NAME,this,this._render_internal),(0,he.b)(this.context._getPositionOnPage?.())&&o._SPEventManager.instance.unregisterEvent(d.UPDATE_TITLE_TO_BANNER,this,this._handleTitleSync)}onInit(){this._hasOnInitStarted=!0,this._hasOnInitFinished=!1;const e=()=>{this._hasOnInitFinished=!0,(0,U.tJ)()||(this.properties.customContentDropSupport=(0,ve.X)(this.properties.layoutType)),(0,U.lc)()||this.displayMode!==o.DisplayMode.Edit||this.loadPropertyPaneResources();const e=this.context.serviceScope.consume(d.TemplatesGalleryContext.serviceKey);(0,E.Lg)()&&void 0===this.properties.showTimeToRead&&!e.isInTemplatesGallery&&(this._pageService||this.context.serviceScope.whenFinished(()=>{this._pageService=this.context.serviceScope.consume((0,d.getPageServiceServiceKey)())}),this.properties.showTimeToRead=(0,ge.wU)(this._pageService?.getPageBasicInfo(),this.context._getPositionOnPage?.()))};(0,E.ym)()&&!this.properties.encodedImage&&this.displayMode===o.DisplayMode.Edit&&v.d.import().then(e=>{this.properties.imageSource&&e.generateBlurHash(this.properties.imageSource).then(e=>{const t=this.properties.encodedImage;this.properties.encodedImage=e,this.onPropertyPaneFieldChanged("encodedImage",t||"",e)})}).catch(e=>{s._TraceLogger.logError(s._LogSource.create("TitleRegion"),e,"ImportEditModeChunk")}),(0,U.EU)()||this._tryProcessAIProperties(),this._updateHostTypeProperties(),this._imageInfo=we._getImageInfo(this.properties,this._variantTheme),(0,U.pr)()||this._registerThemeChange(),this._controller={updateTitle:this._updateTitle,updateHTMLtitle:this._updateHtmlTitle,commitTitle:this._commitTitle,updateHeadline:this._updateHeadline,updateColorBlock:this._updateColorBlock,updatePostType:this._updatePostType,updateImage:this._updateImage,updateAltText:this._updateAltText,updateAuthors:this._updateAuthorByline,switchLayout:this._switchLayout,setFocalPoint:(0,U.f_)()?this._setFocalPointUvPosition:this._setFocalPoint,togglePropertyPane:this._togglePropertyPane,completeFirstRender:this.renderCompleted,completeRender:this._completeRender,updateLayoutHeight:this._handleLayoutHeightChange.bind(this),setScalingMethod:this._setScalingMethod,updateCropData:this._updateCropData},(0,E.JU)()&&this.context.serviceScope.whenFinished(()=>{this._pageService=this.context.serviceScope.consume((0,d.getPageServiceServiceKey)())}),(0,d.isPagesCopilotEnabled)(this.context.serviceScope)&&(o._SPEventManager.instance.registerEvent(Oe,this,this._updateTitleImage),o._SPEventManager.instance.registerEvent(Ce,this,this._updateTitleExternal)),(0,U.Vy)()||o._SPEventManager.instance.registerEvent(d.FOCUS_MODE_EVENT_NAME,this,this._render_internal),(0,he.b)(this.context._getPositionOnPage?.())&&o._SPEventManager.instance.registerEvent(d.UPDATE_TITLE_TO_BANNER,this,this._handleTitleSync),l._PerformanceLogger.markComponent(this.context.webPartTag,`${l._PerformanceDataDimensions.Layout}${this.properties.layoutType||"FullWidthImage"}`);const t=this._layoutType;return this._isChunkedLayout(t)?this._onInitRenderPromise=y.import(t).then(e=>{this._layout=e}).then(super.onInit).then(e).catch(e=>{s._TraceLogger.logError(s._LogSource.create("TitleRegion"),e,"ImportLayoutChunk")}):(this._layout=Z.getLayout(t),this._onInitRenderPromise=super.onInit().then(e)),(0,U.Xx)()||(this._initialTitle=this.properties.title),(0,E.l7)()?this._updatePersonaInfo().catch(e=>{e.message===De.v&&(s._TraceLogger.logError(s._LogSource.create("TitleRegionWebPart"),e,"onInit: AuthorBylineNotFound"),this.properties.authors=[],this.properties.authorByline=[])}):(0,U.Gq)()||this._updatePersonaInfo(),this._onInitRenderPromise}get dataVersion(){return o.Version.parse((0,U.f_)()?"1.5":"1.6")}onAfterDeserialize(e,t){if(t.lessThan(o.Version.parse("1.2"))){const t=e.imageSourceType;void 0!==t&&1!==t&&3!==t||!e.imageSource?e.imageSourceType=A.f.Default:e.imageSourceType=A.f.SharePointURI}if(t.lessThan(o.Version.parse("1.4"))&&(e.layoutType=e.imageSourceType===A.f.None?"NoImage":"FullWidthImage",e.textAlignment=A.q.Left,e.showTopicHeader=!1,e.showPublishDate=!1,e.topicHeader="",e.authorByline=e.authorByline||[],e.authors=e.authors||[]),e.layoutType=e.layoutType||"FullWidthImage",e.textAlignment=e.textAlignment||A.q.Left,e.showTopicHeader=e.showTopicHeader||!1,e.showPublishDate=e.showPublishDate||!1,e.topicHeader=e.topicHeader||"",void 0===e.showTopicHeader&&e.topicHeader&&(e.showTopicHeader=!0),(0,U.eW)()||e.imageSourceType||!e.imageSource||(e.imageSourceType=A.f.SharePointURI),(0,U.fp)()&&(0,f.gL)(this.context.host.hostType)&&(-1===["FullWidthImage","NoImage"].indexOf(e.layoutType)&&(e.layoutType="FullWidthImage"),e.layoutType=e.imageSourceType===A.f.None||e.imageSourceType===A.f.Default||"NoImage"===e.layoutType||"Author"===e.layoutType?"NoImage":"FullWidthImage"),void 0===e.enableGradientEffect&&(e.enableGradientEffect=!0),void 0===e.altText&&(e.isDecorative=!0),this._isAuthorUpdatedAfterDeserialize=!1,e.authors||(e.authors=[],this._tryPopulateDefaultAuthor().catch(()=>{})),t.lessThan(o.Version.parse("1.5"))&&(e.isLockedTitleRegion=!0),!(0,U.Nc)()&&this.displayMode===o.DisplayMode.Edit&&!e.title&&(0,he.b)(this.context?._getPositionOnPage?.())&&((0,U.GI)()||!(0,f.gL)(this.context.host.hostType))){const t=document.getElementById("pageCommandBarPageTitleButton")?.innerText;t&&(e.title=t)}if(!(0,U.f_)()&&t.lessThan(o.Version.parse("1.6"))&&e.focalPointUvPosition&&(e.translateX=void 0!==e.focalPointUvPosition.x?e.focalPointUvPosition.x/100:void 0,e.translateY=void 0!==e.focalPointUvPosition.y?e.focalPointUvPosition.y/100:void 0,delete e.focalPointUvPosition,s._EngagementLogger.logEvent("TitleRegionWebPart.onAfterDeserialize","focalPointUvPositionDeprecate")),(0,U.tJ)()||(e.customContentDropSupport=(0,ve.X)(e.layoutType)),!(0,U.MD)()){const t=e.title||"";t!==(0,se.getPlainTextFromHTML)(e.htmlTitle||"")&&(e.htmlTitle=(0,se.getHTMLTitleFromPlainText)(t,e.headingLevel))}return e}onDisplayModeChanged(e){super.onDisplayModeChanged(e),this.displayMode===o.DisplayMode.Edit?(g.o.removeParallax(this._titleRegion),this._useFullSizeImageURL=!0,(0,U.lc)()||this.loadPropertyPaneResources(),this.properties.authorByline?.length&&(0,E.l7)()&&this._updatePersonaInfo().catch(e=>{e.message===De.v&&(s._TraceLogger.logError(s._LogSource.create("TitleRegionWebPart"),e,"onDisplayModeChanged: AuthorBylineNotFound"),this.properties.authors=[],this.properties.authorByline=[])})):(g.o.applyParallax(this._titleRegion),d.SPFREUtility.clearAllFRECallout())}onPropertyPaneConfigurationComplete(){super.onPropertyPaneConfigurationComplete();const e=new s._LogEntry("TitleRegionWebPart","Properties",s._LogType.Event,{alignment:String(this.properties.textAlignment),authorsLen:String((this.properties.authors||[]).length),authorBylineLen:String((this.properties.authorByline||[]).length),backgroundImageSourceType:String(this.properties.imageSourceType),layoutType:String(this.properties.layoutType),showPublishDate:String(this.properties.showPublishDate),showTopicHeader:String(this.properties.showTopicHeader),titleRegionWidth:String(this.width),titleTextLen:String((this.properties.title||"").length),topicHeaderLength:String((this.properties.topicHeader||"").length)});s._EngagementLogger.logEventWithLogEntry(e)}get isRenderAsync(){return"ColorBlock"===this._layoutType||"CutInShape"===this._layoutType||"NoImageEmail"===this._layoutType||"FullWidthImageEmail"===this._layoutType||"NoImageVivaEngage"===this._layoutType||"FullWidthImageVivaEngage"===this._layoutType||"FullWidthImage"===this._layoutType||"TeamsCustom"===this._layoutType}onBeforeSerialize(){delete this.properties.focusOnInput,delete this.properties.textAlignCenter,delete this.properties.kicker,delete this.properties.showKicker,"TopicPage"===this.properties.layoutType?this.properties.authorByline=[]:void 0===this.properties.authorByline?-1===window.location.href.indexOf("_layouts/15/sitepagepreview.aspx")&&this.displayMode!==o.DisplayMode.Edit||(this.properties.authorByline=[this.context.pageContext.user.loginName]):!(0,U.IL)()&&this.properties.authorByline?.length||(this.properties.authorByline=this.properties.authors?.map(e=>e.id).filter(e=>isNaN(Number(e)))),((0,U.Fd)()||(0,f.uy)(this.context.host.hostType))&&this.properties.amplifyTeamsFixedTitle&&(delete this.properties.authorByline,delete this.properties.authors),(0,U.tJ)()||(delete this.properties.externalLink,delete this.properties.imageBlob)}onPropertyPaneFieldChanged(e,t,n){super.onPropertyPaneFieldChanged(e,t,n),"topicHeader"===e&&n!==t&&void 0!==t&&0===t.toString().length&&void 0!==n&&n.toString().length>0&&(this.properties.showTopicHeader=!0),"isDecorative"===e&&this._markAsDecorative(n),"altText"===e&&this._updateAltText(n),"layoutType"===e&&(-1!==["Author","Fade"].indexOf(n)&&(this.properties.textAlignment=A.q.Left),(0,U.tJ)()||(this.properties.customContentDropSupport=(0,ve.X)(n))),(0,U.Ag)()||"showTimeToRead"!==e||s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("TitleRegionWebPart","TimeToReadToggle",s._LogType.Event,{isEnabled:n?"true":"false"}))}get propertiesMetadata(){return ae}loadPropertyPaneResources(){return v.d.import().then(e=>{this._propertyPane=new e.TitleRegionPropertyPane,this.context?.propertyPane?.refresh()})}getPropertyPaneConfiguration(){if(this._propertyPane&&this._layout.propertyPane){const e=this._layout.propertyPane;return this._imageInfo.type===g.y.DefaultImage&&(e.showAltTextInput=!1),this._postType&&(e.postType=this._postType),this._isHeadingLevelEnabled&&(e.isTitleHeadingLevelsEnabled=!0),this._propertyPane.getConfiguration(e,this.properties,this.context._getPositionOnPage?.(),this.context)}return super.getPropertyPaneConfiguration()}get accessibleTitle(){return this.properties.isLockedTitleRegion?Ie.k5:Ie.qc}onAfterResize(){this.render()}onAfterPropertiesUpdatedExternally(e){this._updateHostTypeProperties(),super.onAfterPropertiesUpdatedExternally(e),(0,U.HH)()&&!this.properties.isLockedTitleRegion&&this.displayMode===o.DisplayMode.Edit&&this.context?.propertyPane?.refresh()}_completeRender(e){(0,U.rT)()||this._hasRegisteredRenderCompleted||((0,U._3)()&&this._asyncComponentStatus.delete("TimeToRead"),this._asyncComponentStatus.set(e,"Rendered"),Array.from(this._asyncComponentStatus).every(([,e])=>"Rendered"===e)&&(this._hasRegisteredRenderCompleted=!0,o._SPEventManager.instance.raiseEvent("webPartRenderComplete",{controlId:this.context.instanceId})))}_render_internal(){const e=we._getImageInfo(this.properties,this._variantTheme),t=!(0,U.rD)()&&this._updateWithExternalImage;this._imageInfo.id===e.id||t||(this._imageInfo=e);let n=this._layoutType;!(0,E.pq)()&&(0,f.sE)(this.context.host.hostType)&&(n="NoImage"===n?"NoImageEmail":"FullWidthImageEmail"),(0,f.H0)(this.context.host.hostType)&&(n=this.properties.amplifyTeamsFixedTitle?"TeamsCustom":"NoImage"===n?"NoImageTeams":"ImageTeams"),(0,f.Qo)(this.context.host.hostType)&&(n=this.properties.amplifyTeamsFixedTitle?"NoImage"===n?"NoImageVivaEngage":"FullWidthImageVivaEngage":"NoImage"===n?"NoImageTeams":"ImageEngage"),this._isChunkedLayout(n)?y.import(n).then(e=>{this._layout=e,this.properties.isLockedTitleRegion||this.displayMode!==o.DisplayMode.Edit||this.context?.propertyPane?.refresh()}).then(this._renderTitleRegion).catch(e=>{s._TraceLogger.logError(s._LogSource.create("TitleRegion"),e,"ImportLayoutChunk")}):(this._layout=Z.getLayout(n),this._renderTitleRegion())}_updateHostTypeProperties(){const e=!(0,U.Y6)()&&(0,E.oF)()&&(0,he.b)(this.context._getPositionOnPage?.());if(!(0,U.fp)()&&((0,E.pq)()?(0,f.uy)(this.context.host.hostType):(0,f.gL)(this.context.host.hostType))){const e=["FullWidthImage","NoImage"];this.properties.imageSourceType===A.f.None||this.properties.imageSourceType===A.f.Default||"NoImage"===this.properties.layoutType||"Author"===this.properties.layoutType?this.properties.layoutType="NoImage":this.properties.layoutType=e.find(e=>e===this.properties.layoutType)||"FullWidthImage"}(0,f.Qo)(this.context.host.hostType)&&(this.properties.textAlignment=A.q.Left,this.properties.altText="",(0,U.fp)()&&(this.properties.layoutType="NoImage"===this.properties.layoutType?"NoImage":"FullWidthImage"),e&&(this.properties.amplifyTeamsFixedTitle=!0)),e&&(0,f.H0)(this.context.host.hostType)&&(this.properties.amplifyTeamsFixedTitle=!0,(0,U.fp)()&&(this.properties.layoutType="NoImage"))}get _isInSmallCanvasNotInMobileView(){return!(0,W.n)()&&(0,T.g)(this.width,M.Cv)}_getRteLineClampForLayout(e){return"ColorBlock"===e.type?this.width>=M.Cv?5:this.width>=M.SJ?4:3:3}_getHeightForLayout(e){if(this._isInSmallCanvasNotInMobileView){if("ColorBlock"===e.type)return M.p3;if("FullWidthImage"===e.type)return(0,E.C)()?M.Rm:M.Vm;if("CutInShape"===e.type)return(0,E.C)()?M.Rm:M.LE}return"ColorBlock"===e.type?this.width>=M.Cv?M.AN:this.width>=M.SJ?M.NM:M.Sp:(0,E.C)()?M.Rm:this.width>=M.em?M.EI:!(0,U.rV)()&&this.width>M.Cv&&this.width<M.Wh?M.gT:this.width>=M.Cv?M.Sc:M.GN}_logUpdateImageForEvent(){"Event"===this.properties.layoutType&&s._EngagementLogger.logEvent("TitleRegionWebPart.UpdateImageForEvent")}get _imageOffset(){return(0,U.f_)()&&this.properties.focalPointUvPosition?be(this.properties.focalPointUvPosition,this.properties.imgWidth,this.properties.imgHeight,this.width,(0,W.r)(this.width)&&this._layoutHeight||this._getHeightForLayout(this._layout)):void 0===this.properties.translateX||void 0===this.properties.translateY?(0,U.f_)()&&!(0,U.GK)()&&this.properties.focalPointUvPosition?be(this.properties.focalPointUvPosition,this.properties.imgWidth,this.properties.imgHeight,this.width,this._getHeightForLayout(this._layout)):void 0:{x:this.properties.translateX,y:this.properties.translateY}}get _layoutType(){return this.context.serviceScope.consume(d.TopicDataService.serviceKey).topicPageMultilingualInfo?.isTranslation?"TopicPage":this.properties.isLockedToTitleEditOnly?"NewsDigest":this.properties.layoutType||"FullWidthImage"}_isChunkedLayout(e){return"Event"===e||"EventNoImage"===e||"FullWidthImageEmail"===e||"NoImageEmail"===e||"FullWidthImageVivaEngage"===e||"NoImageVivaEngage"===e||"NewsDigest"===e||"TopicPage"===e||"ColorBlock"===e||"TeamsCustom"===e||"ImageTeams"===e||"NoImageTeams"===e||"ImageEngage"===e||"Author"===e||"Fade"===e}_tryPopulateDefaultAuthor(){return N.e(119).then(N.bind(N,302)).then(e=>new e.DefaultAuthorPopulator(this.context.serviceScope).populateDefaultAuthor()).catch(e=>{throw new d.UnexpectedFailure("FailToGetDefaultAuthor",e)}).then(e=>{if(this._isAuthorUpdatedAfterDeserialize)throw new d.ExpectedFailure("AuthorUpdated");if(this.displayMode===o.DisplayMode.Read)throw new d.ExpectedFailure("PageEnteredReadMode");this.properties.authors=[e],this.render()})}_loadImage(e){return new Promise((t,n)=>{const a=document.createElement("img");a.onload=()=>{t(a)},a.onerror=e=>{n(e)},a.setAttribute("src",e)})}_registerThemeChange(){this.context.serviceScope.whenFinished(()=>{this._themeProvider=this.context.serviceScope.consume(r.ThemeProvider.serviceKey),this.properties.isLockedTitleRegion||(this._variantTheme=this._themeProvider.tryGetTheme(),(0,H.I)()&&(this._variantThemeV2=this._themeProvider.tryGetThemeV2())),this._themeProvider.themeChangedEvent.add(this,this._handleThemeChangedEvent)})}_convertLayoutToTranspileLayout(e){return"ColorBlock"===e?"Tall":"Standard"}_isLayoutSupportedForTranspileScreenshot(e){return"FullWidthImage"===e||"Fade"===e||"ColorBlock"===e||"CutInShape"===e}get _isHeadingLevelEnabled(){return(0,E.JU)()&&!!this._pageService?.getWebPartsPageSettings().isTitleHeadingLevelsEnabled&&!(0,he.b)(this.context._getPositionOnPage?.())}async _updatePersonaInfo(){for(const e of this.properties.authorByline??[]){const t=(0,U.Ty)()?e:this.properties.authors?.find(t=>t.id===e||t.email===e||t.upn===e)?.email||e,n=await(0,ye.I)(this.context.serviceScope).then(e=>e.getPeopleInfo(t));n&&(this.properties.authors=this.properties.authors?.map(t=>t.id===e||t.email===e||t.upn===e?{...t,name:n.name||t.name,role:n.role||t.role}:t))}}_getImageSource(){const e=we._getImageInfo(this.properties,this._variantTheme);let t;return t=e.type!==g.y.DefaultImage?e.type===g.y.SharePointImage||e.type===g.y.ExternalImage?e.source:"":e.originalSource??"",t}async _tryProcessAIProperties(){if("Raw"===this.properties.aiDataStatus?.status&&(0,p.isDataUrl)(this.properties.imageSource))try{const e=(0,p.dataUrlToBlob)(this.properties.imageSource);if(e){this.properties.imageBlob=e;try{const t=await createImageBitmap(e);this.properties.imgWidth=t.width,this.properties.imgHeight=t.height}catch(e){new s._QosMonitor("TitleRegionWebPart.CreateImageBitmapError").writeUnexpectedFailure("Failed to create image bitmap",e)}this._imageInfo={id:o.Guid.newGuid().toString(),type:g.y.LocalImage,file:e},this._updateWithExternalImage=!0,this._titleRegionKey=Math.random(),this.render()}}catch{this.properties.aiDataStatus&&(this.properties.aiDataStatus.status="Baked")}}constructor(...e){super(...e),this._hasRegisteredRenderCompleted=!1,this._isAuthorUpdatedAfterDeserialize=!1,this._useFullSizeImageURL=!1,this._hasOnInitFinished=!1,this._hasOnInitStarted=!1,this._onInitRenderPromise=Promise.resolve(),this._titleRegionKey=void 0,this._updateWithExternalImage=void 0,this._initialTitle=void 0,this._asyncComponentStatus=new Map([["BackgroundImage","NotStarted"],["AuthorByLine","NotStarted"],["TimeToRead","NotStarted"]]),this._renderTitleRegion=()=>{const e=Boolean(!(0,U.Ru)()&&this.properties.isSnapshotMode),n=t.createElement(te,{key:(0,U.rD)()?void 0:this._titleRegionKey,editMode:this.displayMode===o.DisplayMode.Edit,encodedImage:this.properties.encodedImage,topActionsConfig:this._getTopActionsConfiguration,image:this._imageInfo,updateWithExternalImage:this._updateWithExternalImage,layout:this._layout,focalPoint:this._imageOffset,focalPointUvPosition:this.properties.focalPointUvPosition,imgWidth:this.properties.imgWidth,imgHeight:this.properties.imgHeight,altText:this.properties.altText||"",alignment:this.properties.textAlignment||A.q.Left,title:this.properties.title||"",htmlTitle:this.properties.htmlTitle||(0,se.getHTMLTitleFromPlainText)(this.properties.title||""),titleAriaLabel:this.properties.titleAriaLabel||"",headline:this.properties.headline||"",headlineColor:this.properties.headlineColor||0,serviceScope:this.context.serviceScope,controller:this._controller,showTopicHeader:this.properties.showTopicHeader||!1,topicHeader:this.properties.topicHeader||"",instanceId:this.context.instanceId,showPublishDate:!e&&this.properties.showPublishDate||!1,showTimeToRead:this.properties.showTimeToRead||!1,dateBox:this.properties.dateBox,authors:this.properties.authors||[],authorByline:this.properties.authorByline||[],requestedHeight:(0,W.r)(this.width)&&this._layoutHeight||this._getHeightForLayout(this._layout),ref:this._titleRegionDidMount,useFullSizeImageURL:this._useFullSizeImageURL,width:this.width,enableGradientEffect:this.properties.enableGradientEffect,isDecorative:this.properties.isDecorative,isAdvancedEditScalingEnabled:this.properties.isAdvancedEditScalingEnabled,advancedImageEditorData:this.properties.advancedImageEditorData,focusZoneProps:(0,f.sE)(this.context.host.hostType)?xe:void 0,completeComponentRender:(0,U._3)()?void 0:this._completeRender.bind(this)}),r=(0,H.I)()&&this._variantThemeV2?t.createElement(i.FluentProvider,{theme:this._variantThemeV2},n):n,s=Boolean(this._getImageSource());!(0,U.MD)()&&(0,se.isNPSTextCoherencyEnabled)()&&(this.domElement.style.setProperty("--rte-content-maxheight","100%"),this.domElement.style.setProperty("--rte-content-lineclamp",`${this._getRteLineClampForLayout(this._layout)}`)),a.render(t.createElement($.m.Provider,{value:{eventObserver:this,isLockedTitleRegion:this.properties.isLockedTitleRegion,variantTheme:this._variantTheme||(0,b.getTheme)(),canvasWidth:this.width,positionOnPage:this.context._getPositionOnPage?.(),headingLevel:this._isHeadingLevelEnabled?this.properties.headingLevel:void 0,isHeadingLevelEnabled:this._isHeadingLevelEnabled,completeComponentRender:this._completeRender.bind(this)}},r),this.domElement),this._setupFocusOnInput(),(0,U.rT)()||s||this._completeRender("BackgroundImage"),this.properties.showTimeToRead||this._completeRender("TimeToRead")},this._getTopActionsConfiguration=()=>{if((0,E.gx)()){if(!(0,U.rp)()&&this.properties.layoutType&&("EventNoImage"===this.properties.layoutType||"Event"===this.properties.layoutType))return;if(this._propertyPane&&!(0,f.uy)(this.context.host.hostType))return{topActions:[{...this._propertyPane?.getTopActionsConfiguration(this.properties,this.context._getPositionOnPage?.(),Ie.Ab,this.context),title:Ie.Ab}],onExecute:(e,t)=>{s._EngagementLogger.logEvent("TitleRegionWebPart.TopActions.Click",e),this._onPropertyPaneFieldChanged(e,t),this.context.propertyPane.refresh()}}}},this._setupFocusOnInput=()=>{this.properties.focusOnInput&&this.displayMode===o.DisplayMode.Edit&&v.d.import().then(e=>{e.TitleInput.focus(this._titleRegion,!0),this.properties.focusOnInput=!1}).catch(e=>{s._TraceLogger.logError(s._LogSource.create("TitleRegion"),e,"ImportEditModeChunk")})},this._titleRegionDidMount=e=>{this._titleRegion=e,e&&(g.o.applyParallax(e),this.context.serviceScope.consume(ne.k.serviceKey),(0,U._u)()||this.properties.isLockedTitleRegion||s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("TitleRegionWebPart","firstRender",s._LogType.Event,{layoutType:String(this.properties.layoutType),titleRegionWidth:String(this.width),positionOnPage:(0,he.b)(this.context?._getPositionOnPage?.())?"TitleArea":"CanvasZone"})))},this._updateImage=(e,t,n,a)=>{if(e.type===g.y.DefaultImage?(this.properties.imageSourceType=A.f.Default,this.properties.imageSource="",this.properties.webId=void 0,this.properties.siteId=void 0,this.properties.listId=void 0,this.properties.uniqueId=void 0,this.properties.imageOriginalSource=void 0,this.properties.contentProvider=void 0,this.properties.insertionISOTimestamp=void 0):e.type===g.y.SharePointImage?(this.properties.imageSourceType=A.f.SharePointURI,this.properties.imageSource=e.source,this.properties.webId=e.webId&&e.webId.toString(),this.properties.siteId=e.siteId&&e.siteId.toString(),this.properties.listId=e.listId&&e.listId.toString(),this.properties.uniqueId=e.uniqueId&&e.uniqueId.toString(),this.properties.imageOriginalSource=(0,E.Rl)()?e.originalSource:void 0,this.properties.contentProvider=e.contentProvider,this.properties.insertionISOTimestamp=e.insertionISOTimestamp,this.properties.stockMediaId=e.stockMediaId):e.type!==g.y.LocalImage&&e.type!==g.y.ExternalImage||(this.properties.imageSourceType=A.f.SharePointURI,this.properties.webId=void 0,this.properties.siteId=void 0,this.properties.listId=void 0,this.properties.imageOriginalSource=(0,E.Rl)()?e.originalSource:void 0,(0,U.aG)()||e.type!==g.y.ExternalImage?(this.properties.uniqueId=void 0,this.properties.imageSource=e.id):(this.properties.contentProvider=e.contentProvider,this.properties.insertionISOTimestamp=e.insertionISOTimestamp,this.properties.stockMediaId=e.stockMediaId,this.properties.imageSource=e.source)),this._updateWithExternalImage=!1,this._imageInfo.id!==e.id){if(this.properties.translateX=void 0,this.properties.translateY=void 0,this.properties.imgWidth=this.properties.imgHeight=void 0,e.type!==g.y.DefaultImage){const a=e.type===g.y.SharePointImage||e.type===g.y.ExternalImage?e.source:URL.createObjectURL(e.file);this._loadImage(a).then(e=>{this.properties.imgWidth=e.naturalWidth,this.properties.imgHeight=e.naturalHeight,a?.startsWith("blob:")&&URL.revokeObjectURL(a),this.render(),(0,U.Tj)()||t?.()}).catch(e=>{s._TraceLogger.logError(s._LogSource.create("TitleRegion"),e,"GetFullImageDimension"),(0,U.Tj)()||n?.(e)})}}else(0,U.Tj)()||t?.();this._imageInfo=e,(0,E.ym)()&&this._pageService&&this._pageService.getWebPartsPageSettings().isLowQualityImagePlaceholderEnabled&&this.displayMode===o.DisplayMode.Edit&&v.d.import().then(e=>{this.properties.imageSource&&e.generateBlurHash(this.properties.imageSource,void 0,"TitleRegionWebPart").then(e=>{const t=this.properties.encodedImage;this.properties.encodedImage=e,this.onPropertyPaneFieldChanged("encodedImage",t||"",e)})}).catch(e=>{s._TraceLogger.logError(s._LogSource.create("TitleRegion"),e,"ImportEditModeChunk")}),!(0,U.Y1)()&&(0,E.Rl)()&&(this.properties.advancedImageEditorData=a),this.render(),this._logUpdateImageForEvent(),o._SPEventManager.instance.raiseEvent("recordSurveyEvent",{name:"ImageEditUsage"})},this._updateCropData=e=>{this.properties.cropData=e,this._internalSetDirtyBit()},this._updateAltText=e=>{this.properties.altText=e,this.context.propertyPane.refresh(),this.render()},this._markAsDecorative=e=>{this.properties.isDecorative=e,this.context.propertyPane.refresh(),this.render()},this._updateHtmlTitle=(e,t)=>{this.properties.htmlTitle=e,this._updateTitle(t,!1),this._commitTitle(t.length>100?t.substring(0,100):t)},this._updateTitle=(e,t=!0)=>{this.properties.title!==e&&(this.properties.title=e,!(0,U.MD)()&&t&&(this.properties.htmlTitle=(0,se.getHTMLTitleFromPlainText)(e,this.properties.headingLevel),this.domElement.querySelector(".title-region-rte-hero-title")?.dispatchEvent(new CustomEvent(se.EXTERNAL_SOURCE_TEXT_UPDATE_EVENT,{detail:{newTitle:this.properties.htmlTitle}}))),!(0,U.Nc)()&&(0,he.b)(this.context?._getPositionOnPage?.())&&o._SPEventManager.instance.raiseEvent(d.UPDATE_TITLE_TO_PAGE_STORE,{newTitle:e}),this._internalSetDirtyBit(),this.render())},this._handleLayoutHeightChange=e=>{e&&e!==this._layoutHeight&&(this._layoutHeight=e,this.render())},this._updateHeadline=e=>{this.properties.headline!==e&&(this.properties.headline=e,this._internalSetDirtyBit(),this.render())},this._updateColorBlock=e=>{this.properties.headlineColor!==e&&(this.properties.headlineColor=e,this.render())},this._updatePostType=e=>{this._postType=e,this.render()},this._updateTitleExternal=e=>{o._SPEventManager.instance._clearStickyEventQueue(Ce),e.title&&(this._updateTitle(e.title),this._commitTitle(e.title))},this._handleTitleSync=e=>{(0,U.RV)()&&!e.newTitle||e.newTitle===this.properties.title||this._updateTitle(e.newTitle)},this._updateTitleImage=({imageSource:e,altText:t})=>{o._SPEventManager.instance._clearStickyEventQueue(Oe),this._updateImage({type:g.y.SharePointImage,source:e,id:e,siteId:void 0,webId:void 0,listId:void 0,uniqueId:void 0,originalSource:(0,E.Rl)()?e:void 0}),this._updateAltText(t)},this._commitTitle=e=>{e&&((0,U.Xx)()||this.properties.isLockedTitleRegion||e!==this._initialTitle)&&(this.properties.title=e,(0,he.b)(this.context?._getPositionOnPage?.())&&o._SPEventManager.instance.raiseEvent(d.UPDATE_TITLE_TO_PAGE_STORE,{newTitle:e,commitTitle:!0}))},this._updateAuthorByline=e=>{this.properties.authorByline=e.map(e=>e.id),this._isAuthorUpdatedAfterDeserialize=!0,this.properties.authors=e,this.render()},this._togglePropertyPane=()=>{this.context.propertyPane.isPropertyPaneOpen((0,E.zy)()?this.context.instanceId:void 0)?this.context.propertyPane.refresh():this.context.propertyPane.open()},this._switchLayout=e=>{this.properties.layoutType=e,this.properties.customContentDropSupport=(0,ve.X)(this.properties.layoutType),this.render()},this._setFocalPoint=(e,t)=>{e?(s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("TitleRegionWebPart","FocalPointMove",s._LogType.Event,{focalPointSource:t})),this.properties.translateX=e.x,this.properties.translateY=e.y):(this.properties.translateX=void 0,this.properties.translateY=void 0),this.render()},this._setFocalPointUvPosition=(e,t)=>{if(e?(s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("TitleRegionWebPart","FocalPointMove",s._LogType.Event,{focalPointSource:t})),this.properties.focalPointUvPosition={...e}):this.properties.focalPointUvPosition=void 0,(0,U.GK)()||this.properties.imgWidth||this.properties.imgHeight||this._imageInfo.type===g.y.DefaultImage)this.render();else{const e=this._imageInfo.type===g.y.SharePointImage||this._imageInfo.type===g.y.ExternalImage?this._imageInfo.source:URL.createObjectURL(this._imageInfo.file);this._loadImage(e).then(e=>{this.properties.imgWidth=e.naturalWidth,this.properties.imgHeight=e.naturalHeight,this.render()})}},this._setScalingMethod=e=>{this.properties.isAdvancedEditScalingEnabled=e,this.render()},this._handleThemeChangedEvent=e=>{if(!this.properties.isLockedTitleRegion)return this._variantTheme=e.theme,(0,U.fw)()||(this._variantThemeV2=e.themeV2),void this.render();e.theme?.isInverted!==this._isInverted&&(this._isInverted=e.theme?.isInverted,this.render())}}}(0,e._ts_decorate)([(0,d.monitor)("TitleRegion.TryPopulateDefaultAuthor")],we.prototype,"_tryPopulateDefaultAuthor",null)})(),K})())})();